---
title: 文档片段
seo-title: 文档片段
description: 文档片段(如文本、列表、条件和布局片段)可让您形成客户通信的静态、动态和可重复组件。
seo-description: 文档片段(如文本、列表、条件和布局片段)可让您形成客户通信的静态、动态和可重复组件。
uuid: 4273323d-14f5-4b3b-8fed-80beef641efe
topic-tags: correspondence-management
products: SG_EXPERIENCEMANAGER/6.5/FORMS
discoiquuid: 0d5436c6-1976-496c-b9a7-7dc6e830bb5d
docset: aem65
feature: Correspondence Management
translation-type: tm+mt
source-git-commit: 48726639e93696f32fa368fad2630e6fca50640e
workflow-type: tm+mt
source-wordcount: '6935'
ht-degree: 0%

---


# 文档片段{#document-fragments}

## 文档片段 {#document-fragments-1}

文档片段是通信的可重用部分/组件，您可以使用它来编写字母/通信。 文档片段有以下类型：

* **文本**:文本资源是由一个或多个文本段落组成的内容。段落可以是静态的或动态的。
* **列表**:列表是一组文档片段，包括文本、列表、条件和图像。列表元素的顺序可以是固定的或可编辑的。 在创建字母时，您可以使用部分或全部列表元素来复制元素的可重用模式。
* **条件**:条件允许您根据提供的数据定义在通信创建时包含的内容。该条件用控制变量描述。 控件变量可以是数据字典元素或占位符。
* **布局片段**:布局片段是可在一个或多个字母中使用的布局。布局片段用于创建可重复的模式，特别是动态表。 布局可包含“地址”和“引用编号”等典型表单字段。 它还包含表示目标区域的空子表单。 布局(XDP)在Designer中创建，然后上传到AEM Forms。

## 文本 {#text}

文本资源是由一个或多个文本段落组成的内容。 段落可以是静态的或动态的。 动态段落包含对数据元素的引用，其值在运行时提供。 例如，字母问候语中的客户名称可以是动态数据元素，其值在运行时可用。 通过更改这些值，可以使用相同的字母模板为不同的客户生成字母。

Correspondence Management Solution支持两种动态数据项（可变数据）：

* **数据字典元素**:这些元素绑定到数据字典并从提供的数据源获取其值。数据字典变量可以受到保护或不受保护。 在创建对应时，用户可以修改不受保护的数据字典变量的默认值，但不能修改受保护的数据字典变量。
* **占位符**:这些变量不绑定到后端数据源。它们要求用户在创建通信时填写值。 默认情况下，占位符不受保护。

>[!NOTE]
>
>在创建占位符时，“对应管理”模板不会强制您创建唯一名称。 如果创建两个名称相同的占位符（如文本和条件），并在字母模板中同时使用它们，则最后插入的占位符的值将用于这两个占位符。 如果两个占位符具有相同的名称，则会比较其类型。 如果类型不同，则其类型将变为“字符串”。 但是，在模块中，不能创建多个同名占位符。

### 创建文本{#create-text}

1. 选择&#x200B;**Forms** > **文档片段**。
1. 点按&#x200B;**创建** > **文本**&#x200B;或选择文本资产，然后点按&#x200B;**编辑**。
1. 为文本指定以下信息：

   * **标题：（可选）** 输入文本资产的标题。标题不需要唯一，并且可以包含特殊字符和非英语字符。 文本由其标题（如果可用）引用，例如在缩略图和资产属性中。
   * **名称：** 文本资产的唯一名称。任何状态中不能存在两个具有相同名称的资产(文本、条件或列表)。 在“名称”字段中，您只能输入英语字符、数字和连字符。 系统会根据标题字段自动填充名称字段。 在“标题”字段中输入的特殊字符、空格、数字和非英文字符将替换为“名称”字段中的连字符。 尽管“标题”字段中的值会自动复制到“名称”中，但您可以编辑该值。
   * **描述**:键入资产的描述。
   * **数据字典**:（可选）选择要在其中映射的数据字典。此属性允许您在文本资产中添加对数据字典元素的引用。
   * **标记**:（可选）要创建自定义标记，请在文本字段中输入值，然后按Enter。您可以在标记文本字段下方看到标记。 保存此文本时，还会创建新添加的标记。

1. 点按&#x200B;**下一步**。 Oracle Commenting会显示“编辑器”页，您可以在该页中向文本添加文本段落和数据元素。

   浏览器中的默认拼写检查器在文本编辑器中检查拼写。 要管理拼写检查和语法检查，您可以编辑浏览器的拼写检查设置或安装浏览器插件/加载项来检查拼写和语法。

   您还可以使用文本编辑器中的各种键盘快捷键管理、编辑文本和设置文本格式。 有关“Correspondence Management Keyboard Shortcuts”中[“Text Editor](/help/forms/using/keyboard-shortcuts.md#p-formatting-p)”键盘快捷键的详细信息。

1. 将打开文本编辑器，输入文本。 使用页面顶部的工具栏设置文本格式、插入条件、链接和分页符。

   ![工具栏](assets/advancedediting.png)

   * **链接**:在文 [](#insert-hyperlink) 本中插入超文本链接。
   * **重复**:重复使用分隔符打印数据字典中的收集元素。
   * **条件**:点按以插入条件。根据条件插入文本。 如果条件为true，则文本以字母显示，否则不显示。
   * **添加描述**:向文本添加注释。这是作者可见的元数据，但不是创建的字母的一部分。
   * **分页符**:如果将文本模块的分页属性设置为false，则文本模块不会跨页面分页。

   将打开文本编辑器。 输入文本。 工具栏会根据您选择进行的编辑类型而发生更改：段落、对齐方式或列表：

   ![选择工具栏类型](assets/toolbarselection.png)

   选择工具栏类型：段落、对齐方式或列表

   ![段落工具栏](assets/fonteditingtoolbar.png)

   段落工具栏
   [ ![对齐工](assets/paragrapheditingtoolbar.png)](assets/paragrapheditingtoolbar-1.png)具栏对齐工具栏

   ![列表工具栏](assets/bulleteditingtoolbar.png)

   列表工具栏（单击可打开全尺寸图像）

1. 要重复使用其他应用程序中存在的多个文本段落之一（如来自MS Word或HTML页面），请将文本复制并粘贴到文本编辑器中。 复制的文本的格式将保留在文本编辑器中。

   您可以在可编辑的文本模块中复制和粘贴一个或多个文本段落。 例如，您可能有一个MS Word文档，其项目符号列表为可接受的居住验证，如下所示：

   ![pastetextmsword-1](assets/pastetextmsword-1.png)

   您可以直接将MS Word文档中的文本复制并粘贴到可编辑的文本模块。 项目符号列表、字体和文本颜色等格式将保留在文本模块中。

   ![pastetextmodule](assets/pastetexttextmodule.png)

   >[!NOTE]
   >
   >但是，粘贴文本的格式设置有一些[限制](https://helpx.adobe.com/aem-forms/kb/cm-copy-paste-text-limitations.html)。

1. 如果需要，请在文档片段中插入特殊字符。 例如，可以使用“特殊字符”调板插入：

   * 货币符号，如€、¥和英镑
   * 数学符号，如∑、√、∂和^
   * 标点符号，如&quot;和&quot;

   ![specialcharacters-1](assets/specialcharacters-1.png)

   Corresponce Management内置了210个特殊字符。 管理员可以通过自定义](/help/forms/using/custom-special-characters.md)添加对更多/自定义特殊字符的支持。[

1. 要在可编辑的内嵌模块中突出显示\突出部分文本，请选择文本并点按高亮颜色。

   ![textbackgroundcolorappled](assets/textbackgroundcolorapplied.png)

   您可以直接点按“基本颜色”调板中显示的基本颜色`**[A]**`，或使用滑块`**[B]**`选择&#x200B;**后点按**&#x200B;以选择相应的颜色阴影。

   或者，您也可以转到“高级”选项卡，选择适当的“色相”、“亮度”和“饱和度”`**[C]**`以创建精确的颜色，然后点按“选择”`**[D]**`以应用颜色以高亮显示文本。

   ![textbackgroundcolor-1](assets/textbackgroundcolor-1.png)

1. 在“数据”面板中，将数据字典元素和占位符元素拖放到文本中。

   收件人:

   * 在文本中添加数据字典元素，从列表中选择数据元素，然后点按插入(![insert](assets/insert.png))。 如果选择“受保护”，则数据字典元素为只读并显示在字母编辑器中，但不显示在“创建对应”用户界面或“通信创建器”中。
   * 在文本中添加占位符元素，在“数据元素”面板中，点按新建，输入新数据元素的详细信息，然后点按创建，将新元素添加到列表。 新占位符可以以与数据字典元素相同的方式插入到文本中。 要编辑占位符，请选择一个占位符，然后点按编辑。

   ![占位符元素](assets/placeholder_elements_in_xmldata.png)

   在数据字典的示例数据文件中指定的占位符元素

   ![字母中的占位符元素](assets/placeholder_elements_in_text.png)

   CCR视图中占位符元素值从示例数据文件中指定的数据字典变量填充

   您还可以使用@符号搜索数据字典和占位符元素并将其添加到文本编辑器。 将光标放在要插入元素的位置。 键入@，后跟搜索字符串。 文本编辑器对文本文档片段中可用的所有数据字典和占位符元素执行搜索操作。 搜索操作将检索包含搜索字符串的元素并将其显示为下拉列表。 在搜索结果中导航，然后单击要在光标位置插入的元素。 按Esc可隐藏搜索结果。

1. 您可以使用内联条件并重复，使您的字母具有高度的情境性和良好的结构性。 有关内联条件和重复的详细信息，请参阅[内联条件和以字母](/help/forms/using/cm-inline-condition.md)重复。
1. 点按&#x200B;**保存**。

#### 在文本{#insert-hyperlink}中插入超链接

执行以下步骤以在文本资产中创建超链接：

1. 在文本编辑器中选择文本或数据模型对象。

2. 点按&#x200B;**[!UICONTROL 链接]**。 点按&#x200B;**[!UICONTROL 替代文本]**&#x200B;字段可删除现有数据模型对象名称或文本。

3. 指定URL并点按![保存](assets/save_icon.svg)。

![在文本资源中创建超链接](assets/text-create-hyperlink.png)

#### 搜索并替换文本{#searching-and-replacing-text}

处理包含大量文本的文本元素时，需要搜索特定文本字符串。 您可能还需要将特定文本字符串替换为替代字符串。

“查找并替换”功能允许您搜索（和替换）文本元素中的任何文本字符串。 该功能还包括强大的常规表达式搜索。

#### 在文本模块{#to-search-text-in-a-text-module}中搜索文本

1. 在文本编辑器中打开文本模块。

1. 点按查找并替换。
1. 在“查找”文本框中输入要搜索的文本，然后按“查找”。 搜索文本在文本模块中高亮显示。
1. 要搜索文本的下一个实例，请再次按“查找”。

   如果继续按“查找”按钮，搜索将继续到页面下方。 在找到文本的最后一个实例后，消息&#x200B;**模块**&#x200B;的“已到达端”指示未找到更多搜索结果。

   但是，如果在文本模块中找不到搜索文本的实例，则显示的消息为：**找不到匹配**。

1. 如果再次按“查找”，则搜索将在页面顶部继续。

#### 搜索选项{#search-options}

**匹配大小写：** 搜索返回的结果仅包含相同大小写。

**全字：搜** 索仅返回全字。

>[!NOTE]
>
>如果在“查找”文本框中输入任何特殊字符，则“全字”选项将处于禁用状态。

**Reg ex：使** 用常规表达式搜索。例如，以下常规表达式在文本模块中搜索电子邮件地址：

`[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}`

#### 在文本模块{#to-search-and-replace-text-in-a-text-module}中搜索并替换文本

1. 在文本编辑器中打开文本模块。
1. 点按查找并替换。
1. 在“查找”文本框中输入要搜索的文本，并输入要将查找文本替换为的文本，然后按“替换”。
1. 如果找到搜索文本，则文本将替换为替换文本。

   * 如果找到搜索文本的另一个实例，则该实例将在文本模块中突出显示。 如果再次按Replace键，则替换高亮显示的实例，并且光标向前移动（如果找到第三个实例）。
   * 如果找不到另一个实例，游标将在最后一个被替换的实例处停止。

1. 如果再次按“查找”，则搜索将在页面顶部继续。

   使用“全部替换”选项替换文本模块中文本的所有实例。 执行“”操作时，替换项的数量将在“查找并替换”对话框中显示为消息。

#### 文本模块{#best-practices-tips-and-tricks-for-text-modules}的最佳实践/提示与技巧

* 使用一致的命名约定来避免重复。
* 在文本模块中使用适当的数据字典绑定。
* 更改文本资产时，使用文本编辑器时适用以下规则：

   * **添加变量：允** 许
   * **删除变量：允** 许
   * **属性更新：允** 许
   * **更改数据字典：** 在不使用数据字典元素之前允许。更新时无法更改数据字典。

## 列表 {#list}

列表是一组文档片段，包括文本、（其他）列表、条件和图像。 列表元素的顺序可以是固定的或可编辑的。 在创建字母时，您可以使用部分或全部列表元素来复制元素的可重用模式。 列表基本上就像可嵌套在其他目标中的目标。

### 实施列表{#implementing-lists}

实施列表包括两个步骤：

1. 定义核心属性，如名称、说明、数据字典。
1. 属于列表的部分内容，然后设置列表的锁定顺序和库访问等属性。

### 创建列表{#create-a-list}

列表是一组相关内容，可以在字母模板中以单个单位使用。 任何类型的内容都可以添加到列表。 列表也可以嵌套。 列表模块可指定为：

* **订购**:不能在“创建对应”运行时中更改顺序。
* **库访问**:用户可以向列表添加模块。此标志指定是否启用库访问。 如果启用（打开），则用户可以在预览信函时向列表添加模块。
* 创建列表时，可以指定类型，如：
* **简单**:不会对列表应用其他样式格式。
* **项目符号**:使用简单项目符号设置格式的列表。
* **编号**:选择标准(1,2,...)、高罗马字(I，II，...)和低罗马字(i，ii，...)数字的数字列表。
* **信件**:字母列表，可选择小写(a，b，...)和大写(A，B，...)字母。
* **自定义**:您可以创建任何已编号/已字母类型以及所选前缀和后缀值。

1. 选择&#x200B;**Forms** > **文档片段**。

1. 选择&#x200B;**创建** > **列表**。

1. 为列表指定以下信息：

   * **标题（可选）：输** 入列表的标题。标题不需要唯一，可以有特殊字符和非英文字符。 列表通过其标题（如果可用）引用，例如在缩略图和资产属性中。
   * **名称：** 列表的唯一名称。任何状态中不能存在两个具有相同名称的资产(文本、条件或列表)。 在“名称”字段中，您只能输入英语字符、数字和连字符。 “名称”字段会自动填充“标题”字段中的值。 在“标题”字段中输入的特殊字符、空格、数字和非英文字符将替换为“名称”字段中的连字符。 尽管“标题”字段中的值会自动复制到“名称”中，但您可以编辑该值。
   * **说明（可选）**:键入资产的描述。
   * **数据字典（可选）**:（可选）选择要连接的数据字典。只能向列表添加与列表使用相同数据字典的资产，或未分配数据字典的资产。 为列表分配数据字典使创建字母模板的人员能够更轻松地找到适当的列表。
   * **标记（可选）**:选择要应用的标记。您也可以键入新标记的名称并创建它。 （点按&#x200B;**保存**&#x200B;时将创建新标记。）

1. 点按&#x200B;**下一步**。
1. 点按&#x200B;**添加资产**。
1. 要向列表添加资产，请在选择资产页面中选择资产，然后点按&#x200B;**完成**。

   ![选择要添加到列表的资产](assets/selectassets.png)

1. 资产会添加到“列表项目”页面。
要更改列表中资产的顺序，请点按并按住箭头图标(![dragndrop](assets/dragndrop.png))，然后拖放。 当用户在“创建对应”用户界面中打开字母模板时，内容将按您在此处定义的顺序组合。

   ![在列表中重新排序和配置资产](assets/listitems.png)

1. 您可以选择以下选项以指定列表在CCR用户界面中的行为：

   * **库访问**:要启用用于添加资源的库访问，请点按库访问。启用“库访问”后，声明调整器可向列表添加更多内容。 否则，索赔调整程序仅限于您为列表定义的内容。
   * **锁定顺序**:要锁定列表中资产的顺序，以便报销申请调整器无法更改订单，请点按锁定顺序。如果您不选择此选项，“报销申请调整器”可以更改列表物料的顺序。

   * **添加项目符号**:使用此选项可将项目符号或编号样式应用于模块。您可以使用预先设计的列表样式或自定义样式。 您还可以指定在每个列表项之前和之后显示的文本。
   * **分页符**:选择此选项 ![(break](assets/break.png))可在列表内容之间添加分页符。如果未选择此选项(![nobreak](assets/nobreak.png))，则如果列表的内容溢出到下一页，则整个列表将移到下一页，而不是在列表之间的页中断。

   * **分配配置**:使用此选项可指定可添加到列表的资产的最小和最大数量。

1. 您可以选择以下选项以指定列表中每个资产在运行时的行为：

   * **可编辑：** 选择此选项后，可以在“创建对应”用户界面中编辑内容。(此选项不适用于列表和图像模块。)
   * **必需：** 选择此选项后，“创建对应”用户界面中将需要内容。
   * **选择：选** 择此选项后，将在“创建对应”用户界面中预先选择内容。
   * **跳过样式：** 选择此选项后，内容将跳过“创建对应”用户界面中的项目符号和编号。(此选项不适用于图像模块。 此外，在“跳过样式”、“复合”和“忽略列表样式”之间，只能将其中一个选项应用于模块。 当您为模块选择“添加项目符号”时，这些选项之一可用于模块。)
   * **缩进：** 您可以更改作为列表的一部分选择的每个模块/内容的缩进级别。缩进是按“色阶”（从零开始）指定的，因此每个缩进级别对应于36点的填充。
   * **复合：** 选择此选项后，复合编号将作为外部（父）列表的样式及其自己的样式的组合应用。此嵌套列表上的复合编号基于此嵌套列表在外部列表中的显示顺序。
   * **忽略列表样** 式：如果取消选择“复合编号”选项，则启用“忽略列表样式”选项。此选择将忽略嵌套列表自己的样式，并且编号从外部列表继续。 因此，嵌套列表的模块被视为外部列表本身的一部分，而忽略在嵌套列表上指定的任何样式。 如果对嵌套列表取消选择“忽略列表样式”选项，则作为该嵌套列表一部分的模块有其自己的编号样式。
   * **与下一步保持** 一致：设置列表中包含的资产的分页符。如果将某个列表的一个资产的“与下一个资产保持在一起”属性设置为&#x200B;**On**，则该资产和下一个资产将保持在同一页面上。 这意味着所选资产和下一个资产的内容不会跨页面中断。

1. 点按&#x200B;**保存**。

### 最佳实践/技巧{#best-practices-tips-and-tricks}

* 使用一致的命名约定来避免重复。
* 使用适当的数据字典绑定
* 使用列表编辑器更改列表时，适用以下规则：

   * 属性更新：允许
   * **更改数据字典：** 在没有使用数据字典的项与它关联之前允许。更新时无法更改数据字典。

## 条件 {#conditions}

条件允许您根据提供的数据定义在通信/信件创建时包含的内容。 该条件用控制变量描述。 添加条件时，您可以根据控制变量的值选择包含资产。

根据您选择的选项，将仅计算基于当前条件变量的发现为true的第一个表达式或所有条件。 在“创建通信(CCR)”中填写信时，条件的行为方式为“白框”。 如果条件导致列表，则输出所有列表的必选和预选项目。 如果其中任何项目本身是条件或列表，则生成的内容也会以自上而下的、深度优先的顺序输出为文本和图像内容的平面列表。 条件结果可以是任何类型(文本、列表、条件或图像)。

### 实施条件{#implementing-conditions}

条件编辑器附带有[表达式 Builder](/help/forms/using/expression-builder.md)用户界面，该界面支持使用多个占位符和表达式字典元素创建数据。 您可以在此类表达式中使用通用操作数和本地/全局函数。 每个表达式都可以与某些内容关联，并且（可选）如果没有任何表达式的计算结果为true，则可能会有一个默认部分。 所有表达式将按定义它们的顺序进行评估，并选择返回true的第一个表达式，其关联内容由该条件模块返回。

例如，如果字母中的条款和条件文本因客户所处的状态而有所不同，且数据字典包含名为“state”的元素，则可以按如下方式添加条件：
· state = NY，选择T&amp;C_NY文本段落
·状态= NC，选择T&amp;C_NC文本段落

条件编辑器允许您指定默认条件。 如果控件变量的值与任何条件都不匹配，则使用与默认条件关联的内容。 在上一个示例中，您可以添加此条件行：
·默认，选择T&amp;C_Rest

### 创建条件{#create-a-condition}

1. 选择&#x200B;**Forms** > **文档片段**。
1. 选择&#x200B;**创建>条件**。
1. 为列表指定以下信息：

   * **标题（可选）：** 输入条件的标题。标题不需要唯一，可以有特殊字符和非英文字符。 条件由其标题（如果可用）引用，例如在缩略图和资产属性中。
   * **名称：** 条件的唯一名称。任何状态中不能存在两个具有相同名称的资产(文本、条件或列表)。 在“名称”字段中，您只能输入英语字符、数字和连字符。 系统会根据标题字段自动填充名称字段。 在“标题”字段中输入的特殊字符、空格、数字和非英文字符将替换为“名称”字段中的连字符。 尽管“标题”字段中的值会自动复制到“名称”中，但您可以编辑该值。
   * **说明（可选）** 键入条件的说明。
   * **数据字典（可选）**:（可选）选择要连接的数据字典。只能将与条件使用相同数据字典的资产或未分配数据字典的资产添加到列表。 为列表分配数据字典使创建字母模板的人员更容易找到合适的条件。
   * **标记（可选）**:（可选）选择要应用的标记。您也可以键入新标记的名称并创建它。 （点按&#x200B;**保存**&#x200B;时将创建新标记。）

1. 点按&#x200B;**下一步**。
1. 点按&#x200B;**添加资产**。
1. 要将资产添加到条件，请在选择资产页面中选择该资产，然后点按&#x200B;**完成**。 资产会添加到表达式窗格。
1. 您可以选择以下选项来指定条件在运行时的行为方式：

   * **禁用多个结果评估\启用多个结果评估**:启用此选项（显示为“启用多个……”）后，将评估所有条件，结果是所有真实条件的总和。如果禁用此选项（显示为“禁用多个……”），则仅计算发现为true的第一个条件，并成为该条件的输出。
   * **分页符**:选择此选项 ![(break](assets/break.png))可在条件的模块之间添加分页符。如果未选择此选项(![nobreak](assets/nobreak.png))，则如果条件溢出到下一页，则整个条件将转移到下一页，而不是在条件之间的页中断开。

1. 要更改条件中资产的顺序，请点按并按住箭头图标(![dragndrop](assets/dragndrop.png))，然后拖放。 当用户在“创建对应”用户界面中打开字母模板时，内容将按您在此处定义的顺序组合。
1. 点按&#x200B;**删除**&#x200B;以删除行。 如果为默认行点按删除，则仅清除资产信息。
1. 点按&#x200B;**复制**&#x200B;以重复行。
1. 点按&#x200B;**编辑**&#x200B;以更改资产或编辑表达式。

   进一步：

   * 要更新资产，请点按资产列下的文件夹图标。
   * 要打开表达式 Builder以插入表达式，请点按“表达式”列下的文件夹图标。 有关表达式 Builder的详细信息，请参阅[表达式 Builder](/help/forms/using/expression-builder.md)。

### 最佳实践/技巧{#best-practices-tips-and-tricks-1}

* 使用一致的命名约定，轻松搜索并避免重复。
* 条件的行为与case语句类似，因此条件的顺序很重要。 返回第一个匹配。
* 使用适当的数据字典绑定
* 使用条件编辑器编辑条件时，适用以下规则：

   * **添加变量：允** 许
   * **删除变量：允** 许
   * **属性更新：允** 许
   * **更改数据字典：** 在不使用数据字典元素之前允许。

## 布局片段 {#layoutfragments}

布局片段基于在Designer中创建的XDP。 要创建布局片段，您需要创建XDP并将XDP[上传到AEM Forms](/help/forms/using/import-export-forms-templates.md)。

一个或多个布局片段可以组成字母的一部分并定义这些部分的图形布局。 布局片段可以包含典型的表单字段（如“地址”和“引用编号”）以及表示目标区域的空子表单。 此外，布局片段允许您创建表并将其插入字母中。

一个常见用例是在Letters中找到可重用的布局模式并为它们创建布局片段。 例如，字母的问候、地址和主题部分，它以同一顺序显示多个字母。 另一个示例可以是一个表，该表使用多个字母时的行数和列数相似。

您可以基于现有XDP创建布局片段。 布局片段可以由字段和目标区域或一个或多个表组成。 布局中的表可以是静态的或动态的。 XDP在Designer中创建，并且[上传到AEM Forms](/help/forms/using/import-export-forms-templates.md)。 XDP可以形成布局片段或字母的结构。 有关[布局设计](/help/forms/using/layout-design-details.md)的详细信息。

使用绑定到目标区域的片段可在创作时更改字母。 可以创建具有不同维度的布局片段，并可以将相应的片段绑定到目标区域。 布局片段还允许您自定义一些表属性：

1. 您可以增加行和列数。
1. 可以为更多行和列指定页眉和页脚文本。
1. 您可以定义表列宽的比率。 在运行时，根据定义的比率和可用空间调整表列的大小。 宽度比之和必须为100。 否则不适用。
1. 如果表是占位符（仅包含单个空白单元格），则可以定义新列的类型(目标区域/字段)。
1. 可以隐藏页眉和页脚行。

在执行此过程之前，请使用Designer创建XFA片段。 片段可包含用于组织字段和目标区域的表。 设计器允许创建两种类型的表：静态和动态。 静态表包含固定数量的行。 静态表可以包含目标区域和字段。 这些目标区域和字段不能绑定到重复的DDE。 动态表也可以有单行。 绑定到表单元格的数据确定动态表的行数。 动态表只能包含字段。 DDE可以是重复的或非重复的。

设计表时请考虑以下几点：

1. 可在创建布局片段时自定义表。 但是，仅当表的父子表单被流动时，才启用“自定义”选项。
1. 对于动态表，所有字段、可重复行和表使用“use name”绑定将数据正确合并。
1. 对于动态表，绑定到表字段的所有重复DDE都是同一层次的一部分。 对于非重复DDE，没有此类限制。
1. 在将布局片段合并到父目标区域表时，会根据可用空间调整大小，但只有当布局片段不直接包含顶级子表单中的任何目标区域或字段时，才会调整大小。 允许使用目标区域和表内的字段。
1. 可创建占位符表。 占位符表只有一个空白单元格。

* 对于占位符表，您可以在创建片段时自定义以下属性。

   * 行计数
   * 列计数
   * 每列的页眉和页脚
   * 每列的类型(目标区域/字段)
   * 每列宽比

* 对于非占位符表，可以自定义以下属性：

   * 行计数
   * 列计数
   * 附加列的页眉和页脚
   * 每列宽比

您可以将片段嵌套在字母中。 这意味着您可以在片段中添加片段。 Correspondence Management解决方案在一个字母中支持多达四个嵌套级别：**字母**->**片段**->**片段**->**片段**->**片段。**

有关在布局片段中使用静态和动态表的详细示例，请参阅[示例文件：在字母](#examplewithsamplefiles)中使用静态表和动态表。

### 创建布局片段{#creating-a-layout-fragment}

1. 选择&#x200B;**创建** > **布局片段**。
1. Correspondence Management显示可用的XDP。 选择要作为布局片段基础的XDP，然后点按&#x200B;**下一步**。
1. 为布局指定以下信息：

   * **标题（可选）：** 输入布局片段的标题。标题不需要唯一，可以有特殊字符和非英文字符。 布局片段由其标题（如果可用）引用，例如在缩略图和资产属性中。
   * **名称：** 布局片段的唯一名称。任何状态中不能存在两个具有相同名称的资产(文本、条件或列表)。 在“名称”字段中，您只能输入英语字符、数字和连字符。 系统会根据标题字段自动填充名称字段。 在“标题”字段中输入的特殊字符、空格、数字和非英文字符将替换为“名称”字段中的连字符。 尽管“标题”字段中的值会自动复制到“名称”中，但您可以编辑该值。 此名称显示在“管理资产”用户界面的列表中。
   * **说明（可选）**:在“管理资产”用户界面的列表中显示的说明。
   * **标记（可选）**:（可选）选择要应用于条件的标记。您也可以键入新标记的名称并创建它。

1. 点按&#x200B;**表**&#x200B;选项卡，并为布局指定以下信息：

   * **配置**:选择要配置的表。如果表是静态表，则作为下拉列表中表名的后缀为（静态）；如果表是动态表，则作为后缀为（动态）。静态表包含固定数量的行。 静态表可以包含目标区域和字段。 这些目标区域和字段不能绑定到重复的DDE。 绑定到表单元格的数据确定动态表的行数。

   * **行**:为布局选择行数。配置的行计数必须大于或等于原始行计数。
   * **列**:选择布局的列数。配置的列计数必须大于或等于原始列计数。

   对于每列，都需要以下详细信息：

   * **标题**:要为标题显示的文本
   * **页脚**:要为页脚显示的文本
   * **类型**:附加列的类型。字段或目标区域。 为静态占位符表启用了类型。 类型可以在列级别定义，而不能在单元格级别定义。 扩展列中的所有单元格类型都相同。 对于动态表，所有列都为字段类型。 对于非占位符表，不能定义附加列的类型。 在这种情况下，扩展列中附加单元格的类型与该行中最后一列的类型相同；并且附加行中单元格的类型与该列中最后一个单元格的类型相同。
   * **宽度比：** 表列宽的比率。

   有关在布局片段中使用静态和动态表的详细示例，请参阅[示例文件：在字母](#examplewithsamplefiles)中使用静态表和动态表。

1. 点按&#x200B;**保存**。

### 将XDP上传到通信管理{#upload-an-xdp-to-correspondence-management}

有关将XDP上传/导入到Correspondence Management的说明，请参阅[将资源导入和导出到AEM Forms](/help/forms/using/import-export-forms-templates.md)。

### 最佳实践/技巧{#best-practices-tips-and-tricks-2}

#### 设置默认子表单绑定{#set-the-default-subform-binding}

在Designer中创建目标区域时，将所有新子表单的默认绑定设置为“无”会有所帮助。

设置默认绑定：

1. 在“设计器”中，点按&#x200B;**工具** > **选项** > **数据绑定** > **子表单绑定**。

1. 在“新子表单的默认绑定”列表中，选择&#x200B;**无数据绑定**。

这可确保默认情况下，使用“插入”>“子表单”命令或通过从“对象调色板”拖放插入的子表单具有“无”绑定。 这意味着，默认情况下，除非您向任何新子表单添加内容、更改其绑定设置或使用“_int”后缀命名子表单，否则任何新子表单都是目标区域。

#### 第508条 — 符合{#section-compliance}

如果使用在“创建对应”用户界面中创建的已完成字母来填写以后的工作流。 在创建布局时，请遵循与第508条相关的建议。 否则，字母PDF将用于显示，您可以忽略这些建议：

* 所有目标区域子表单和布局中的所有字段都有跳位顺序。
* 默认情况下，带有字幕的字段符合508规范。 默认情况下，字段的/field/assist/speak@priority属性设置为“custom”，这意味着除非提供自定义的屏幕阅读器文本，否则屏幕阅读器将读取字段的题注。
* 没有字幕的字段指定工具提示，并通过设置

`/field/assist/speak@priority="toolTip"` 和指定工具提示文 `/field/assist/toolTip`本

#### Designer和Asset Configuration Manager {#date-formats-in-designer-and-asset-configuration-manager}中的日期格式

在Designer中设计布局时，请确保日期字段的格式与[Corresponce Management Configuration Properties](/help/forms/using/cm-configuration-properties.md)中“数据显示格式”中指定的日期格式相匹配。 有关详细信息，请参阅设计器帮助中的“设置字段值格式和使用模式”。

#### 捕获日期范围{#capturing-date-ranges}

处理日期组合（如startDate - endDate）时，使用单个子表单以确保在完成的字母中正确对齐，并将字段数降至最低。

#### 设置表单级绑定{#setting-form-level-binding}

当布局包含映射到单个XML元素的许多字段和目标区域时，请使用表单级绑定并为每个元素创建一个单独的节点。 在Corresponce Management中映射数据时，在表单级别绑定的字段将被忽略。

#### 不要在主控页面{#do-not-use-subform-target-areas-in-a-master-page}中使用子表单目标区域

在主控页面中，子表单目标区域在“管理资产”用户界面中不可见，数据无法映射到这些区域。

#### 为目标区域{#choosing-appropriate-positions-and-types-for-target-areas}选择适当的位置和类型

设计布局时，在选择子表单时要小心。 如果布局包含单个子表单，则它可以是流类型。 在子表单中放置字段后，可以将其绕排到另一个子表单中，以便绕排的子表单也会流动，布局不会受到干扰。

#### 将字段放置到主控页面{#placing-fields-on-master-pages}

将字段放置到主控页面时，请注意以下事项：

* 将主控页面字段的绑定设置为使用全局数据
* 请勿将字段直接放在主控页面的根PageArea下。
* 将字段包含在指定的子表单中，并确保将指定子表单的绑定设置为“使用名称”。

## 使用布局片段{#creating-tables-using-layout-fragments}创建表

许多字母模板都包含表。 表可以是静态的，如术语和条件表，其中每行表示一个条件，每个部分显示在单独的列中。 表也可以是动态的，如帐户信息，其中包含诸如客户名称、帐户ID、事务处理编号和事务处理金额等信息。

* **静态表**:有时使用具有不同列数的行创建表，如术语和条件表。其中，每行表示一个条件，每个条件可以具有不同的子部分。 每个部分都显示在单独的列中。
* **动态表**:布局片段提供将动态表的字段绑定到集合DDE的功能。在字母生成表行时，根据集合DDE的大小生成表行。

DD具有一个集合元素Ondieme_details，它有一个包含三个基元元素的复合元素：Openiee_name、Openiee_address和Openiee_geder。
动态XDP也具有相同的标头。 因此，您可以将动态XDP字段与上述DD字段进行映射。

### 示例文件：在字母{#examplewithsamplefiles}中使用静态和动态表

此示例说明如何创建动态和静态表，将动态表绑定到DDE，然后创建包含这两个表的字母。 处理此示例时，您可以从头开始创建文件，也可以使用步骤中给定的输入文件。

1. 创建要在示例中使用的数据字典(DD)，如图形中所示。

   然后选择DD并导出示例数据。 您获得的XML文件包含Employee数据和Notifee_details的三个实例(默认情况下，下载3个实例。 您可以根据您的要求添加或删除。) 更新值，然后导入DD中的测试数据。 CMP文件是包，其中包含DD。 因此，将DD导入Corresponce Management。

   有关使用数据字典和测试数据的详细信息，请参阅[数据字典](/help/forms/using/data-dictionary.md#p-working-with-test-data-p)。

   ![数据字典结构](assets/dd.jpeg)

   [获取文件](assets/exportpackage_1431709897770.cmp.zip)

1. 在设计器中，创建两个XDP（布局片段）：动态表和静态表。 对于这两种布局：

   * 向表列添加子表单。 请确保将表的父子表单的布局更改为流并删除表中子表单的绑定。
   * 向表单元格添加子表单。 请确保将表的父子表单的布局更改为流并删除表中子表单的绑定。

   或者，使用随此步骤附加的静态和动态XDP。

   有关使用布局片段的详细信息，请参阅[布局片段](#layoutfragments)。
有关设计布局的详细信息，请参阅[设计器帮助](https://help.adobe.com/en_US/AEMForms/6.1/DesignerHelp/)。

   [获取文件](assets/static.xdp.zip)

   [获取文件](assets/dynamic.xdp.zip)

1. 将XDP上传到AEM Forms。
1. 根据动态XDP创建布局片段。 属性的“表”(Table)选项卡显示表是动态的(“配置”(Configuration For)字段)。 行数(1)和列数(3)是从XDP/布局片段派生的。

   此布局的字段稍后将绑定到导入的DD，在字母中，根据测试数据文件（随DD附加的XML数据文件）中的记录数动态创建行数。

   ![创建布局片段屏幕](assets/dynamictableproperties.png)

   单击以打开全尺寸图像

1. 根据静态XDP创建布局片段。 属性的“表”选项卡显示表是静态的（“配置”字段）。 行数(1)和列数(3)是从XDP/布局片段派生的。

   您可以在此处更改列和行数。 根据您在此屏幕中选择的内容，静态表格的行数和列数在使用此布局创建的字母中保持不变。
   [ ![创建布局片段屏幕](assets/statictableproperties.png)](assets/statictableproperties-1.png)

1. 使用其中的布局片段创建字母。 在字母中插入动态XDP时，将其字段的绑定设置为Data Dictionary的收集元素。

   有关创建字母和字母模板的详细信息，请参阅[创建字母](/help/forms/using/create-letter.md)。

1. 保存信函并预览它。 预览字母时，“数据字典”中的值显示在字母中。 对于动态表，有三行。 这是因为测试数据包含这些行的三个记录。

   对于静态表，在创建布局片段时指定的行和列数相同。

   ![字母中的静态表](assets/statictableletter.png)

   对于动态表，根据测试数据文件中的记录数显示这三行。 这是因为在将布局添加到字母时，您在动态表的字段和数据字典的收集元素之间创建了一个绑定。 “Name（名称）”、“Address（地址）”和“Geder（性别）”值会从您使用的测试数据文件中填充。

   ![字母中的动态表](assets/dynamictableletter.png)

## 创建文档片段{#create-a-copy-of-a-document-fragment}的副本

要快速创建具有类似于现有文档片段的属性和内容的文档片段，您可以复制并粘贴该片段。

1. 从文档片段的列表中，选择一个或多个文档片段。 UI会显示复制图标。
1. 点按复制。UI会显示粘贴图标。 您还可以在粘贴之前选择进入文件夹。 不同的文件夹可以包含名称相同的资产。 有关文件夹的详细信息，请参阅[文件夹和组织资产](/help/forms/using/import-export-forms-templates.md#folders-and-organizing-assets)。
1. 点按粘贴。 此时将显示“粘贴”对话框。 如果您在同一位置复制和粘贴文档片段，系统将自动为新的字母副本分配名称和标题，但您可以编辑字母的标题和名称。
1. 如果需要，请编辑要用其保存文档片段副本的标题和名称。
1. 点按粘贴。 将创建文档片段的副本。

