---
title: AEM中的文档片段
description: 通信管理中的文档片段（如文本、列表、条件和布局片段）允许您形成客户通信的静态、动态和可重复的组件。
topic-tags: correspondence-management
products: SG_EXPERIENCEMANAGER/6.5/FORMS
docset: aem65
feature: Correspondence Management
exl-id: 71754e41-45d7-4cc5-ba49-0748bd51c0cf
source-git-commit: f349c8fd9c370ba589d217cd3b1d0521ae5c5597
workflow-type: tm+mt
source-wordcount: '6905'
ht-degree: 0%

---

# 文档片段{#document-fragments}

## 文档片段 {#document-fragments-1}

文档片段是通信的可重用部件/组件，您可以使用它们来撰写信件/通信。 文档片段具有以下类型：

* **文本**：文本资产是由一个或多个文本段落组成的一段内容。 段落可以是静态的或动态的。
* **列表**：列表是一组文档片段，包括文本、列表、条件和图像。 列表元素的顺序可以固定或可编辑。 创建信件时，您可以使用部分或所有列表元素来复制可重用元素模式。
* **条件**：利用条件，可根据提供的数据定义在创建通信时应包含的内容。 该条件用控制变量描述。 控制变量可以是数据字典元素或占位符。
* **布局片段**：布局片段是可以在一或多个字母中使用的布局。 布局片段用于创建可重复的模式，尤其是动态表。 布局可包含典型的表单字段，如“Address”和“Reference Number”。 它还包含表示目标区域的空子表单。 在Designer中创建布局(XDP)，然后将其上传到AEM Forms。

## 文本 {#text}

文本资产是由一个或多个文本段落组成的一段内容。 段落可以是静态的或动态的。 动态段落包含对运行时提供其值的数据元素的引用。 例如，信件称呼中的客户名称可以是动态数据元素，其值在运行时可用。 通过更改这些值，可以使用相同的信件模板为不同的客户生成信件。

通信管理解决方案支持两种动态数据项（变量数据）：

* **数据字典元素**：这些元素绑定到数据字典，并从提供的数据源获取其值。 数据字典变量可以受保护，也可以不受保护。 在创建通信内容时，用户可以修改未保护数据字典变量的默认值，但无法修改受保护的数据字典变量。
* **占位符**：这些变量未绑定到后端数据源。 它们要求用户在通信创建期间填写值。 默认情况下，占位符不受保护。

>[!NOTE]
>
>创建占位符时，通信管理模板不会强制创建唯一的名称。 如果创建两个同名的占位符（如文本和条件），并在信件模板中同时使用它们，则最后插入的占位符值将用于这两个占位符。 如果两个占位符具有相同的名称，则会比较其类型。 如果类型不同，则其类型将变为String。 但是，在模块中，不能创建多个同名占位符。

### 创建文本 {#create-text}

1. 选择 **Forms** > **文档片段**.
1. 选择 **创建** > **文本** 或选择文本资源并选择 **编辑**.
1. 为文本指定以下信息：

   * **标题： （可选）** 输入文本资源的标题。 标题不需要是唯一的，并且可以包含特殊字符和非英语字符。 文本通过其标题（如果可用）进行引用，例如在缩略图和资产属性中。
   * **名称：** 文本资源的唯一名称。 任何状态下都不能存在具有相同名称的两个资源（文本、条件或列表）。 在“名称”字段中，只能输入英语字符、数字和连字符。 根据“标题”字段自动填充“名称”字段。 在“标题”字段中输入的特殊字符、空格、数字和非英语字符将在“名称”字段中替换为连字符。 虽然“标题”字段中的值会自动复制到“名称”，但您可以编辑该值。
   * **描述**：键入资源的描述。
   * **数据字典**：（可选）选择要映射的数据字典。 利用此属性，可在文本资产中添加对数据字典元素的引用。
   * **标记**：（可选）要创建自定义标记，请在文本字段中输入值，然后按Enter。 您可以在标记的文本字段下方看到您的标记。 保存此文本时，也会创建新添加的标记。

1. 选择 **下一个**. 通信管理显示“编辑器”页面，您可以在其中向文本添加文本段落和数据元素。

   浏览器中的默认拼写检查器会检查文本编辑器中的拼写。 要管理拼写和语法检查，您可以编辑浏览器的拼写检查器设置或安装浏览器插件/加载项以检查拼写和语法。

   您还可以使用文本编辑器中的各种键盘快捷键来管理、编辑文本和设置文本格式。 有关的详细信息 [文本编辑器](/help/forms/using/keyboard-shortcuts.md#p-formatting-p) 通信管理键盘快捷键中的键盘快捷键。

1. 将打开一个文本编辑器，输入文本。 使用页面顶部的工具栏设置文本、插入条件、链接和分页符的格式。

   ![工具栏](assets/advancedediting.png)

   * **链接**：插入 [超文本](#insert-hyperlink) 文本中的链接。
   * **重复**：使用分隔符重复打印数据字典中的收集元素。
   * **条件**：选择以插入条件。 根据条件插入文本。 如果条件为true，则文本在信件中可见，否则不可见。
   * **添加说明**：向一段文本添加注释。 这是对作者可见的元数据，但不是所创建信件的一部分。
   * **分页符**：如果将文本模块的分页符属性设置为false，则文本模块不会跨页面分页。

   此时将打开一个文本编辑器。 输入文本。 根据您选择的编辑类型，工具栏会发生相应的更改：“段落”、“对齐”或“列表”：

   ![选择工具栏类型](assets/toolbarselection.png)

   选择工具栏类型：“段落”、“对齐方式”或“列表”

   ![段落工具栏](assets/fonteditingtoolbar.png)

   段落工具栏
   [![对齐工具栏](assets/paragrapheditingtoolbar.png)](assets/paragrapheditingtoolbar-1.png)对齐工具栏

   ![列表工具栏](assets/bulleteditingtoolbar.png)

   列表工具栏（单击可打开全尺寸图像）

1. 要重用存在于其他应用程序中的文本的一个或多个段落(例如，从MS Word或HTML页中)，请复制该文本并将其粘贴到文本编辑器中。 复制的文本的格式将保留在文本编辑器中。

   您可以在可编辑文本模块中复制并粘贴文本的一个或多个段落。 例如，您可能有一个包含可接受居住证明项目符号列表的MS Word文档，如下所示：

   ![pastetextmsword-1](assets/pastetextmsword-1.png)

   您可以将MS Word文档中的文本直接复制并粘贴到可编辑的文本模块中。 项目符号列表、字体和文本颜色等格式将保留在文本模块中。

   ![pastexttextmodule](assets/pastetexttextmodule.png)

   >[!NOTE]
   >
   >但是，粘贴文本的格式有一些 [限制](https://helpx.adobe.com/aem-forms/kb/cm-copy-paste-text-limitations.html).

1. 如有必要，请在文档片段中插入特殊字符。 例如，可以使用“特殊字符”面板插入：

   * 货币符号，如€、@和£
   * 数学符号，例如∑、√、∂和^
   * 标点符号，如&quot;和&quot;

   ![specialcharacter-1](assets/specialcharacters-1.png)

   通信管理已内置对210个特殊字符的支持。 管理员可以 [通过自定义添加对更多/自定义特殊字符的支持](/help/forms/using/custom-special-characters.md).

1. 要高亮显示\强调可编辑内联模块中的文本部分，请选择该文本，然后选择“高亮显示颜色”。

   ![已应用textbackgroundcolors](assets/textbackgroundcolorapplied.png)

   您可以直接选择基本颜色 `**[A]**` 显示在基本颜色调色板中或选择 **选择** 使用滑块之后 `**[B]**` 以选择相应的颜色阴影。

   或者，您也可以转至“高级”选项卡以选择相应的“色相”、“明亮度”和“饱和度” `**[C]**` 以创建精确颜色，然后选择“选择” `**[D]**` 以应用颜色突出显示文本。

   ![textbackgroundcolor-1](assets/textbackgroundcolor-1.png)

1. 从数据面板中，将数据字典元素和占位符元素拖放到文本中。

   收件人：

   * 在文本中添加数据字典元素，从列表中选择数据元素，然后选择插入( ![插入](assets/insert.png))。 如果选择Protected，则数据字典元素为只读并显示在信件编辑器中，但不显示在“创建通信”用户界面或“通信创建者”中。
   * 在文本中添加占位符元素，在数据元素面板中选择新建，输入新数据元素的详细信息，然后选择创建将新元素添加到列表中。 可以使用与数据字典元素相同的方式将新占位符插入到文本中。 要编辑占位符，请选择占位符，然后选择编辑。

   ![占位符元素](assets/placeholder_elements_in_xmldata.png)

   数据字典的示例数据文件中指定的占位符元素

   ![信件中的占位符元素](assets/placeholder_elements_in_text.png)

   CCR视图中的占位符元素值通过数据字典变量填充，如示例数据文件中所指定

   还可使用@符号搜索数据字典和占位符元素并将其添加到文本编辑器。 将光标置于要插入元素的位置。 键入@，后跟搜索字符串。 文本编辑器对文本文档片段中可用的所有数据字典和占位符元素执行搜索操作。 搜索操作将检索包含搜索字符串的元素并将其显示为下拉列表。 浏览搜索结果，然后单击要在光标位置插入的元素。 按Esc隐藏搜索结果。

1. 您可以使用内联条件和重复来使您的信件具有高度情境性和结构化。 有关内联条件和重复的详细信息，请参阅 [内联条件和字母重复](/help/forms/using/cm-inline-condition.md).
1. 选择&#x200B;**保存**。

#### 在文本中插入超链接 {#insert-hyperlink}

执行以下步骤以在文本资产中创建超链接：

1. 在文本编辑器中选择文本或数据模型对象。

2. 选择 **[!UICONTROL 链接]**. 选择 **[!UICONTROL 替换文本]** 用于删除现有数据模型对象名称或文本的字段。

3. 指定URL并选择 ![保存](assets/save_icon.svg).

![在文本资产中创建超链接](assets/text-create-hyperlink.png)

#### 搜索和替换文本 {#searching-and-replacing-text}

使用包含大量文本的文本元素时，需要搜索特定的文本字符串。 您可能还需要将特定文本字符串替换为替换字符串。

“查找和替换”功能允许您搜索（和替换）文本元素中的任何文本字符串。 该功能还包括强大的正则表达式搜索。

#### 在文本模块中搜索文本 {#to-search-text-in-a-text-module}

1. 在文本编辑器中打开文本模块。

1. 选择“查找并替换”。
1. 在“查找”文本框中输入要搜索的文本，然后按“查找”。 搜索文本将在文本模块中突出显示。
1. 要搜索文本的下一个实例，请再次按“查找”。

   如果继续按“Find（查找）”按钮，则搜索将沿页面继续进行。 在找到文本的最后一个实例后，发送消息 **到达模块末尾** 表示找不到其他搜索结果。

   但是，如果在文本模块中未找到搜索文本的实例，则显示的消息为： **未找到匹配项**.

1. 如果再次按“查找”，则搜索将继续在页面顶部进行。

#### 搜索选项 {#search-options}

**大小写匹配：** 搜索仅返回大小写相同的结果。

**全字：** 搜索仅返回全字。

>[!NOTE]
>
>如果在“查找”文本框中输入任何特殊字符，则“全字”选项将被禁用。

**正则表达式：** 使用正则表达式进行搜索。 例如，以下正则表达式在文本模块中搜索电子邮件地址：

`[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}`

#### 在文本模块中搜索和替换文本 {#to-search-and-replace-text-in-a-text-module}

1. 在文本编辑器中打开文本模块。
1. 选择“查找并替换”。
1. 在“查找”文本框中输入要搜索的文本和要替换查找文本的文本，然后按“替换”。
1. 如果找到搜索文本，则替换文本为替换文本。

   * 如果找到搜索文本的其他实例，则该实例将在文本模块中突出显示。 如果再次按“替换”，则高亮显示的实例将被替换，并且如果找到第三个实例，则光标向前移动。
   * 如果找不到另一个实例，则光标将在最后一个替换的实例处停止。

1. 如果再次按“查找”，则搜索将继续在页面顶部进行。

   使用全部替换选项可替换文本模块中文本的所有实例。 当您执行“时，替换件数量会在“查找和替换”对话框中显示为消息。

#### 文本模块的最佳实践/提示和技巧 {#best-practices-tips-and-tricks-for-text-modules}

* 使用一致的命名惯例以避免重复。
* 在文本模块中使用适当的数据字典绑定。
* 在更改文本资产时使用文本编辑器时，以下规则适用：

   * **添加变量：** 允许
   * **删除变量：** 允许
   * **属性更新：** 允许
   * **更改数据字典：** 在未使用数据字典元素之前允许。 更新时无法更改数据字典。

## 列表 {#list}

列表是一组文档片段，包括文本或（其他）列表、条件和图像。 列表元素的顺序可以固定或可编辑。 创建信件时，您可以使用部分或全部列表元素来复制可重用元素模式。 列表基本上可以作为嵌套在其他目标中的目标使用。

### 实施列表 {#implementing-lists}

实施列表包括两个步骤：

1. 定义名称、描述、数据字典等核心属性。
1. 属于列表一部分的内容，然后为列表设置锁定顺序和库访问权限等属性。

### 创建列表 {#create-a-list}

列表是一组相关内容，可在信件模板中作为单个单元使用。 可以将任何类型的内容添加到列表中。 列表也可以嵌套。 列表模块可指定为：

* **已排序**：无法在“创建通信”运行时更改顺序。
* **库访问权限**：用户可将模块添加到列表。 此标志指定是否启用库访问。 如果启用（打开），用户可以在预览信件时将模块添加到列表。
* 创建列表时，可以指定类型，例如：
* **Plain**：列表未应用其他样式格式。
* **项目符号**：使用简单项目符号格式化的列表。
* **编号**：数字列表，可选择标准(1,2，...)、大罗马字(I，II， ...)和小罗马字(i，ii，...)数字。
* **带字母**：字母列表，具有小写(a，b，...)和大写(A，B，...)字母选择。
* **自定义**：您可以创建任意带编号的/带字母的类型以及所选的前缀和后缀值。

1. 选择 **Forms** > **文档片段**.

1. 选择 **创建** > **列表**.

1. 为列表指定以下信息：

   * **标题（可选）：输入** 列表的标题。 标题不需要是唯一的，并且可以包含特殊字符和非英语字符。 列表由其标题（如果可用）引用，例如在缩略图和资产属性中。
   * **名称：** 列表的唯一名称。 任何状态下都不能存在具有相同名称的两个资源（文本、条件或列表）。 在“名称”字段中，只能输入英语字符、数字和连字符。 “名称”字段自动填充“标题”字段中的值。 在“标题”字段中输入的特殊字符、空格、数字和非英语字符将在“名称”字段中替换为连字符。 虽然“标题”字段中的值会自动复制到“名称”，但您可以编辑该值。
   * **描述（可选）**：键入资源的描述。
   * **数据字典（可选）**：（可选）选择要连接的数据字典。 只有使用与列表相同的数据字典的资产或未分配数据字典的资产可以添加到列表中。 将数据字典分配给列表使创建信件模板的人更容易找到相应的列表。
   * **标记（可选）**：选择要应用的标记。 您还可以键入新标记的名称并创建它。 (新标记将在您选择时创建 **保存**.)

1. 选择&#x200B;**下一步**。
1. 选择 **添加资源**.
1. 要将资源添加到列表，请在选择资源页面中选择它们，然后选择 **完成**.

   ![选择要添加到列表中的资源](assets/selectassets.png)

1. 资产将会添加到“列表项”页面。
要更改列表中资源的顺序，请选择并按住箭头图标( ![拖放](assets/dragndrop.png) )和拖放。 当用户在“创建通信”用户界面中打开信件模板时，内容将按照您在此处定义的顺序装配。

   ![在列表中重新排序和配置资源](assets/listitems.png)

1. 您可以选择以下选项来指定列表在CCR用户界面中的行为方式：

   * **库访问权限**：要启用库访问权限以添加资产，请选择库访问权限。 启用“库访问”后，声明调整器可以向列表中添加更多内容。 否则，索赔理算师仅限于您为列表定义的内容。
   * **锁定顺序**：要锁定列表中的资源顺序，以便理赔人无法更改顺序，请选择锁定顺序。 如果不选择此选项，则索赔理算员可以更改列表项的顺序。

   * **添加项目符号**：使用此选项可对模块应用项目符号或编号样式。 您可以使用预先设计的列表样式或自定义列表样式。 您还可以指定要在每个列表项之前和之后显示的文本。
   * **分页符**：选择此选项( ![break](assets/break.png))，以便在列表内容之间添加分页符。 未选中此选项时( ![nobreak](assets/nobreak.png))，如果列表内容溢出到下一页，则整个列表将移动到下一页，而不是在列表之间的页面中分隔。

   * **分配配置**：使用此选项可指定可以添加到列表的资源的最小和最大数量。

1. 您可以选择以下选项来指定列表中每个资源在运行时的工作方式：

   * **可编辑：** 选择此选项后，可以在“创建通信”用户界面中编辑内容。 （此选项不适用于“列表”和“图像”模块。）
   * **必需：** 选择此选项时，内容需要在“创建通信”用户界面中。
   * **已选定：** 选择此选项后，将在“创建通信”用户界面中预先选择内容。
   * **跳过样式：** 选择此选项后，内容将跳过创建通信用户界面中的项目符号和编号。 (此选项不适用于图像模块。 此外，在“跳过样式”、“复合”和“忽略列表样式”之间，只能将其中一个选项应用于模块。 当您为模块选择添加项目符号时，这些选项之一可用于模块。)
   * **缩进：** 您可以更改作为“列表”的一部分选择的每个模块/内容的缩进级别。 缩进是以“级别”（从0开始）来指定的，因此每个缩进级别都对应于36分的填充。
   * **复合：** 选定后，组合编号将应用为外部（父）列表样式及其自身样式的组合。 此嵌套列表上的复合编号基于此嵌套列表在外部“列表”中的显示顺序。
   * **忽略列表样式：** 如果取消选择“组合编号”选项，则启用“忽略列表样式”选项。 此选择将忽略嵌套列表自身的样式，并且从外部List继续编号。 因此，嵌套列表的模块被视为外部列表本身的一部分，而不考虑在嵌套列表中指定的任何样式。 如果取消选择嵌套列表的“忽略列表样式”选项，则属于该嵌套列表的模块将拥有自己的编号样式。
   * **与下一个保持一致：** 为列表中所包含的资源设置分页符。 如果将列表的一个资源的“与下一个相同”属性设置为 **开启**，则该资产和下一个资产将保留在同一个页面上。 这意味着选定资源和下一个资源的内容不会跨页面中断。

1. 选择&#x200B;**保存**。

### 最佳实践/提示和技巧 {#best-practices-tips-and-tricks}

* 使用一致的命名惯例以避免重复。
* 使用适当的数据字典绑定
* 使用列表编辑器更改列表时，以下规则适用：

   * 属性更新：允许
   * **更改数据字典：** 允许，直到没有使用数据字典的项目与其关联为止。 更新时无法更改数据字典。

## 条件 {#conditions}

条件允许您根据提供的数据定义在创建通信/信件时要包含的内容。 该条件用控制变量描述。 添加条件时，您可以选择根据控制变量所具有的值包含资产。

根据您选择的选项，要么只计算第一个被发现为true的表达式（基于当前条件变量），要么计算所有条件。 在创建信件(CCR)中填写信件时，条件行为类似于“白框”。 如果某个条件生成了列表，则会输出该列表的所有必选项目和预选项目。 如果其中的任何项目是条件或列表本身，则其生成的内容也将以自上而下的深度优先顺序输出为文本和图像内容的平面列表。 条件结果可以是任何类型（文本、列表、条件或图像）。

### 实施条件 {#implementing-conditions}

条件编辑器附带 [表达式生成器](/help/forms/using/expression-builder.md) 支持使用多个占位符和数据字典元素创建表达式的用户界面。 您可以在此类表达式中使用公共操作数和局部/全局函数。 每个表达式都可以与某些内容关联，并且如果所有表达式的计算结果均不为true，则还可以选择显示默认部分。 按照定义表达式的顺序计算所有表达式，并选择返回true的第一个表达式，该条件模块返回其关联内容。

例如，如果信件中的条款和条件文本因客户所处的状态而异，并且数据字典中包含一个名为“state”的元素，则可以添加条件，如下所示：
* state = NY，选择T&amp;C_NY文本段落
* 状态= NC，选择T&amp;C_NC文本段落

条件编辑器允许您指定默认条件。 如果控制变量的值不匹配任何条件，则使用与默认条件关联的内容。 在上一个示例之后，您可以添加此条件行：
* 默认，选择T&amp;C_Rest

### 创建条件 {#create-a-condition}

1. 选择 **Forms** > **文档片段**.
1. 选择 **创建>条件**.
1. 为列表指定以下信息：

   * **标题（可选）：** 输入条件的标题。 标题不需要是唯一的，并且可以包含特殊字符和非英语字符。 条件由其标题（如果可用）引用，例如在缩略图和资产属性中。
   * **名称：** 条件的唯一名称。 任何状态下都不能存在具有相同名称的两个资源（文本、条件或列表）。 在“名称”字段中，只能输入英语字符、数字和连字符。 根据“标题”字段自动填充“名称”字段。 在“标题”字段中输入的特殊字符、空格、数字和非英语字符将在“名称”字段中替换为连字符。 虽然“标题”字段中的值会自动复制到“名称”，但您可以编辑该值。
   * **描述（可选）** 键入条件的描述。
   * **数据字典（可选）**：（可选）选择要连接的数据字典。 只有使用与条件相同的数据字典的资产或未分配数据字典的资产才能添加到列表中。 将数据字典分配给列表使创建信件模板的人员更容易找到合适的条件。
   * **标记（可选）**：（可选）选择要应用的标记。 您还可以键入新标记的名称并创建它。 (新标记将在您选择时创建 **保存**.)

1. 选择&#x200B;**下一步**。
1. 选择 **添加资源**.
1. 要将资源添加到条件，请在选择资源页面中选择它，然后选择 **完成**. 资产将添加到“表达式”窗格。
1. 您可以选择以下选项来指定条件在运行时的工作方式：

   * **禁用多个结果评估\启用多个结果评估**：启用此选项（显示为“启用多个……”）后，将计算所有条件并且结果将是所有真实条件的总和。 如果禁用此选项（显示为“禁用多个……”），则只计算被发现为true的第一个条件，并成为该条件的输出。
   * **分页符**：选择此选项( ![break](assets/break.png))，以便在条件的模块之间添加分页符。 未选中此选项时( ![nobreak](assets/nobreak.png))，如果某个条件溢出到下一页，则整个条件将被移动到下一页，而不是在条件之间的页面中断开。

1. 要更改条件中资源的顺序，请选择并按住箭头图标( ![拖放](assets/dragndrop.png) )和拖放。 当用户在“创建通信”用户界面中打开信件模板时，内容将按照您在此处定义的顺序装配。
1. 选择 **删除** 以删除行。 如果为默认行选择删除，则仅清除资产信息。
1. 选择 **复制** 以复制行。
1. 选择 **编辑** 以更改资产或编辑表达式。

   另外：

   * 要更新资产，请在资产列下选择文件夹图标。
   * 要打开表达式生成器以插入表达式，请在“表达式”列下选择文件夹图标。 有关表达式生成器的详细信息，请参阅 [表达式生成器](/help/forms/using/expression-builder.md).

### 最佳实践/提示和技巧 {#best-practices-tips-and-tricks-1}

* 使用一致的命名惯例以方便搜索并避免重复。
* 条件的行为与case语句类似，因此条件的顺序很重要。 返回第一个匹配项。
* 使用适当的数据字典绑定
* 使用条件编辑器编辑条件时，以下规则适用：

   * **添加变量：** 允许
   * **删除变量：** 允许
   * **属性更新：** 允许
   * **更改数据字典：** 在未使用数据字典元素之前允许。

## 布局片段 {#layoutfragments}

布局片段基于在Designer中创建的XDP。 要创建布局片段，您需要创建XDP和 [将它们上传到AEM Forms](/help/forms/using/import-export-forms-templates.md).

一个或多个布局片段可以形成信件的各个部分，并定义这些部分的图形布局。 布局片段可以包含典型表单字段（如地址和参考编号）以及表示目标区域的空子表单。 此外，布局片段允许您创建表并以字母形式插入这些表。

一个常见用例是查找信件中可重用的布局模式并为它们创建布局片段。 例如，字母的问候语、地址和主题部分，以相同的顺序显示多个字母。 另一个示例可能是与多个字母中使用的行数和列数类似的表。

您可以基于现有XDP创建布局片段。 布局片段可以由字段和目标区域或一个或多个表组成。 布局中的表可以是静态或动态的。 XDP在Designer中创建，并且 [已上传至AEM Forms](/help/forms/using/import-export-forms-templates.md). XDP可以构成布局片段或信件的结构。 有关的更多信息 [布局设计](/help/forms/using/layout-design-details.md).

使用绑定到目标区域的片段允许在创作时更改字母。 可以创建不同维度的布局片段，并将相应的片段绑定到目标区域。 布局片段还允许您自定义某些表属性：

1. 您可以增加行和列数。
1. 可以为更多行和列指定页眉和页脚文本。
1. 您可以定义表列宽的比率。 在运行时，根据定义的比例和可用空间调整表列的大小。 宽度比的总和必须为100。 否则，则不适用。
1. 如果表格是占位符（仅包含单个空白单元格），则可以定义新列的类型（目标区域/字段）。
1. 您可以隐藏页眉和页脚行。

在执行此过程之前，请使用Designer创建一个XFA片段。 片段可以包含用于组织字段和目标区域的表。 Designer允许创建两种类型的表：静态表和动态表。 静态表包含固定数量的行。 静态表可以包含目标区域和字段。 这些目标区域和字段不能绑定到重复的DDE。 动态表也可以具有单行。 绑定到表单元格的数据决定了动态表的行数。 动态表只能包含字段。 DDE可以是重复或非重复。

设计表时，请考虑以下几点：

1. 可以在创建布局片段时自定义表。 但是，自定义选项仅在表的父子表单流动时启用。
1. 对于动态表的所有字段，可重复的行和表使用“使用名称”绑定使数据正确合并。
1. 对于动态表，所有绑定到表字段的重复DDE都是同一层次结构的一部分。 对于非重复DDE，没有此类限制。
1. 将布局片段合并到父目标区域表时，会根据可用空间调整大小，但仅当布局片段不包含任何目标区域或直接位于顶级子表单中的字段时，才会调整大小。 允许目标区域和表内的字段。
1. 可以创建占位符表。 占位符表只有一个空白单元格。

* 对于占位符表，您可以在创建片段时自定义以下属性。

   * 行计数
   * 列计数
   * 每列的页眉和页脚
   * 每列的类型（目标区域/字段）
   * 每列的宽度比率

* 对于非占位符表，可以自定义以下属性：

   * 行计数
   * 列计数
   * 其他列的页眉和页脚
   * 每列的宽度比率

您可以将片段嵌套在信件中。 这意味着您可以在片段中添加片段。 通信管理解决方案最多支持信件中的四个嵌套级别： **书信&#x200B;*>*片段&#x200B;*>*片段&#x200B;*>*片段&#x200B;*>*片段。**

有关在布局片段中使用静态表和动态表的详细示例，请参阅 [示例文件的示例：在信件中使用静态和动态表](#examplewithsamplefiles).

### 创建布局片段 {#creating-a-layout-fragment}

1. 选择 **创建** > **布局片段**.
1. 通信管理显示可用的XDP。 选择要作为布局片段基础的XDP，然后选择 **下一个**.
1. 为布局指定以下信息：

   * **标题（可选）：** 输入布局片段的标题。 标题不需要是唯一的，并且可以包含特殊字符和非英语字符。 布局片段由其标题（如果可用）引用，例如在缩略图和资产属性中。
   * **名称：** 布局片段的唯一名称。 任何状态下都不能存在具有相同名称的两个资源（文本、条件或列表）。 在“名称”字段中，只能输入英语字符、数字和连字符。 根据“标题”字段自动填充“名称”字段。 在“标题”字段中输入的特殊字符、空格、数字和非英语字符将在“名称”字段中替换为连字符。 虽然“标题”字段中的值会自动复制到“名称”，但您可以编辑该值。 此名称将显示在“管理资产”用户界面的列表中。
   * **描述（可选）**：管理Assets用户界面列表中显示的描述。
   * **标记（可选）**：（可选）选择要应用于条件的标记。 您还可以键入新标记的名称并创建它。

1. 选择 **表** 选项卡，并为布局指定以下信息：

   * **配置对象**：选择正在配置的表。作为表名的后缀，如果表是静态表，则下拉菜单中该表名为（静态）；如果表是动态表，则下拉菜单中该表名为（动态）。 静态表包含固定数量的行。 静态表可以包含目标区域和字段。 这些目标区域和字段不能绑定到重复的DDE。 绑定到表单元格的数据决定了动态表的行数。

   * **行**：选择布局的行数。 配置的行数必须大于或等于原始行数。
   * **列**：选择布局的列数。 配置的列数必须大于或等于原始列数。

   对于每一列，需要以下详细信息：

   * **页眉**：要为标题显示的文本
   * **页脚**：要为页脚显示的文本
   * **类型**：其他列的类型。 字段或目标区域。 已为静态占位符表启用类型。 类型可以在列级别定义，而不是在单元格级别定义。 扩展列中的所有单元格属于同一类型。 对于动态表，所有列的类型均为“字段”。 对于非占位符表，不能定义附加列的类型。 在这种情况下，扩展列中附加单元格的类型与该行中最后一列的类型相同；附加行中单元格的类型与该列中最后一列的类型相同。
   * **宽度比例：** 表列宽的比值。

   有关在布局片段中使用静态表和动态表的详细示例，请参阅 [示例文件的示例：在信件中使用静态和动态表](#examplewithsamplefiles).

1. 选择&#x200B;**保存**。

### 将XDP上传到通信管理 {#upload-an-xdp-to-correspondence-management}

有关将XDP上传/导入到通信管理的说明，请参阅 [将资源导入和导出到AEM Forms](/help/forms/using/import-export-forms-templates.md).

### 最佳实践/提示和技巧 {#best-practices-tips-and-tricks-2}

#### 设置默认子表单绑定 {#set-the-default-subform-binding}

在Designer中创建目标区域时，有助于将所有新子表单的默认绑定设置为“无”。

设置默认绑定：

1. 在设计器中，选择 **工具** > **选项** > **数据绑定** > **子表单绑定**.

1. 在新子表单的默认绑定列表中，选择 **无数据绑定**.

这可确保使用“插入”>“子表单”命令或从对象面板中拖放插入的子表单在默认情况下具有“无”绑定。 这意味着，默认情况下，任何新子表单都是目标区域，除非您向其中添加内容、更改其绑定设置或使用“_int”后缀命名子表单。

#### 第508节合规 {#section-compliance}

如果在创建通信用户界面中创建的已完成信件用于填写以后的工作流。 创建布局时，请遵循这些与Section 508相关的建议。 否则，将显示书信PDF，您可以忽略以下建议：

* 所有目标区域子表单和布局中的所有字段均具有制表符顺序。
* 默认情况下，带字幕的字段与508兼容。 该字段的/field/assist/speak@priority属性默认设置为“custom”，这意味着除非提供自定义屏幕阅读器文本，否则屏幕阅读器将读取字段的描述。
* 不带标题的字段指定工具提示，并指示屏幕阅读器通过设置来阅读工具提示

`/field/assist/speak@priority="toolTip"` 并在中指定工具提示文本 `/field/assist/toolTip`.

#### Designer和Asset Configuration Manager中的日期格式 {#date-formats-in-designer-and-asset-configuration-manager}

在Designer中设计布局时，请确保日期字段的格式与的数据显示格式中指定的日期格式匹配 [通信管理配置属性](/help/forms/using/cm-configuration-properties.md). 有关详细信息，请参阅Designer帮助中的“设置字段值格式和使用模式”。

#### 捕获日期范围 {#capturing-date-ranges}

在处理日期组合（如startDate - endDate）时，请使用单个子表单以确保完成的字母正确对齐，并最大程度地减少字段数。

#### 设置表单级别绑定 {#setting-form-level-binding}

当布局包含映射到单个XML元素的多个字段和目标区域时，请使用表单级绑定并为每个元素创建单独的节点。 在通信管理中映射数据时，忽略在表单级别绑定的字段。

#### 请勿在母版页中使用子表单目标区域 {#do-not-use-subform-target-areas-in-a-master-page}

母版页中的子表单目标区域在“管理资产”用户界面中不可见，并且数据无法映射到这些区域。

#### 为目标区域选择适当的职位和类型 {#choosing-appropriate-positions-and-types-for-target-areas}

设计布局时，请注意选择子表单。 如果布局包含单个子表单，则它可以是流式类型。 在子表单中放置字段后，可以将它包装在另一个子表单中，以便包装的子表单也能流动，布局不会受到干扰。

#### 在母版页上放置字段 {#placing-fields-on-master-pages}

在母版页上放置字段时，请注意以下事项：

* 将母版页字段的绑定设置为使用全局数据
* 请勿将该字段直接置于母版页的根PageArea之下。
* 将字段包装在一个已命名的子表单中，并确保已命名的子表单的绑定设置为“使用名称”。

## 使用布局片段创建表 {#creating-tables-using-layout-fragments}

许多信件模板包含表格。 表格可以是静态的，例如术语和条件表，其中每一行表示一个条件，每一部分显示在单独的列中。 表格也可以是动态的，例如帐户信息，其中包含客户名称、帐户ID、交易编号和交易金额等信息。

* **静态表**：创建表时，有时会包含不同列数的行，例如条款和条件的表。 其中每一行表示一个条件，每个条件可以有不同的子部分。 每个部分都显示在单独的列中。
* **动态表**：布局片段提供将动态表的字段绑定到收集DDE的功能。 在生成信件时，表行是根据DDE集合的大小生成的。

DD有一个收集元素Nominied_details，它有一个复合元素，该复合元素具有三个原始元素：Nominied_name、Nominied_address和Nominied_gender。
动态XDP还具有相同的标头。 这样，您就可以将动态XDP字段映射到上述的DD字段。

### 示例文件的示例：在信件中使用静态和动态表 {#examplewithsamplefiles}

此示例说明如何创建动态表和静态表，将动态表绑定到DDE，然后创建包含这两个表的书信。 在处理此示例时，您可以从头开始创建文件，也可以使用步骤中给出的输入文件。

1. 创建要在示例中使用的数据字典(DD)，如图所示。

   然后选择DD并导出示例数据。 您获取的XML文件包含Employee数据和三个Nominee_details实例（默认情况下，将下载3个实例）。 您可以根据需要添加或删除)。 更新值，然后在DD中导入测试数据。 CMP文件是包，其中包含DD。 因此，将DD导入通信管理。

   有关使用数据字典和测试数据的更多信息，请参阅 [数据字典](/help/forms/using/data-dictionary.md#p-working-with-test-data-p).

   ![数据字典结构](assets/dd.jpeg)

[获取文件](assets/exportpackage_1431709897770.cmp.zip)

1. 在Designer中，创建两个XDP（布局片段）：动态表和静态表。 对于这两种布局：

   * 向表列添加子表单。 确保将表父子表单的布局更改为流式，并删除表中子表单的绑定。
   * 向表单元格添加子表单。 确保将表父子表单的布局更改为流式，并删除表中子表单的绑定。

   或者，使用与此步骤一起附加的静态和动态XDP。

   有关使用布局片段的更多信息，请参阅 [布局片段](#layoutfragments).
有关设计版面的详细信息，请参阅 [Designer帮助](https://help.adobe.com/en_US/AEMForms/6.1/DesignerHelp/).

[获取文件](assets/static.xdp.zip)

[获取文件](assets/dynamic.xdp.zip)

1. 将XDP上传到AEM Forms。
1. 基于动态XDP创建布局片段。 属性的“表”选项卡显示表是动态的（“配置对象”字段）。 行数(1)和列数(3)派生自XDP/布局片段。

   此布局的字段稍后绑定到导入的DD，在信件中，行数根据测试数据文件（附带DD的XML数据文件）中的记录数动态创建。

   ![创建布局片段屏幕](assets/dynamictableproperties.png)

   单击以打开全尺寸图像

1. 基于静态XDP创建布局片段。 属性的“表”选项卡显示表是静态的（“配置对象”字段）。 行数(1)和列数(3)派生自XDP/布局片段。

   您可以在此处更改列数和行数。 根据您在此屏幕中选择的内容，静态表的行数和列数在使用此布局创建的信件中保持固定。
   [![创建布局片段屏幕](assets/statictableproperties.png)](assets/statictableproperties-1.png)

1. 使用其中的布局片段创建书信。 在信件中插入动态XDP时，请将其字段的绑定设置为数据字典的收集元素。

   有关创建信件和信件模板的更多信息，请参阅 [创建书信](/help/forms/using/create-letter.md).

1. 保存信件并预览。 预览信件时，数据字典中的值显示在信件中。 对于动态表，共有三行。 这是因为测试数据包含这些行的三条记录。

   对于静态表，其行和列数与您在创建布局片段时指定的行数和列数相同。

   ![书信中的静态表](assets/statictableletter.png)

   对于动态表，根据测试数据文件中的记录数显示三行。 之所以会出现这种情况，是因为在将布局添加到信件时，您在动态表的字段和数据字典的收集元素之间创建了绑定。 “姓名”、“地址”和“性别”值会从您使用的测试数据文件中填充。

   ![信件中的动态表](assets/dynamictableletter.png)

## 创建文档片段的副本 {#create-a-copy-of-a-document-fragment}

要快速创建具有与现有文档片段类似的属性和内容的文档片段，您可以复制并粘贴它。

1. 从文档片段列表中，选择一个或多个文档片段。 UI会显示复制图标。
1. 选择复制。 UI将显示“粘贴”图标。 您也可以选择在粘贴之前进入文件夹。 不同的文件夹可以包含具有相同名称的资源。 有关文件夹的详细信息，请参阅 [文件夹和组织资源](/help/forms/using/import-export-forms-templates.md#folders-and-organizing-assets).
1. 选择“粘贴”。 将显示“粘贴”对话框。 如果您在同一位置复制和粘贴文档片段，系统会自动为信函的新副本指定名称和标题，但您可以编辑信函的标题和名称。
1. 如有必要，请编辑保存文档片段副本的标题和名称。
1. 选择“粘贴”。 将创建文档片段的副本。
