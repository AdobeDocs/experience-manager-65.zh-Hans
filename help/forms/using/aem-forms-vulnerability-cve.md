---
title: 缓解Experience Manager Forms的Log4j2漏洞
description: 缓解Experience Manager Forms的Log4j2漏洞
content-type: reference
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: Security
geptopics: SG_AEMFORMS/categories/jee
role: Admin
solution: Experience Manager, Experience Manager Forms
feature: Adaptive Forms
source-git-commit: c9d9a4d83a00587ee7b223e328abdef1bdd7438b
workflow-type: tm+mt
source-wordcount: '720'
ht-degree: 2%

---

# 缓解Experience Manager Forms的Log4j2漏洞

## 问题

已报告Apache Log4j2（基于Java的应用程序的常用日志库）存在严重安全漏洞。 已分析以下漏洞：

<table border="1">
  <tr>
    <th>漏洞</th>
    <th>受影响的内容</th>
    <th>哪些内容未受影响？</th>
    <th>状态</th>
  </tr>
  <tr>
    <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44228">CVE-2021-44228</a></td>
    <td rowspan="2">
      <ul>
        <li>JEE上的Experience Manager 6.5 Forms（从6.5 GA到6.5.11的所有版本）</li>
        <li>JEE上的Experience Manager 6.4 Forms（从6.4 GA到6.4.8的所有版本）</li>
        <li>JEE上的Experience Manager 6.3 Forms（从6.3 GA到6.3.3的所有版本）</li>
        <li>Experience Manager 6.5 Forms Designer</li>
        <li>Experience Manager 6.4 Forms Designer</li>
        <li>自动化表单转换服务</li>
      </ul>
    </td>
    <td rowspan="2">
      <ul>
        <li>Experience Manager Forms Workbench（所有版本）</li>
        <li>OSGi上的Experience Manager Forms（所有版本）</li>
      </ul>
    </td>
    <td rowspan="2">
      这些已被修复。 有关修复和缓解步骤，请参阅<strong>解决办法</strong>部分。
    </td>
  </tr>
  <tr>
    <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-45046">CVE-2021-45046</a></td>
  </tr>
  <tr>
    <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105">CVE-2021-45105</a></td>
    <td rowspan="9" colspan="2">
      对于开箱即用的日志记录配置，任何Experience Manager Forms版本都不会受到影响。 如果您有任何其他记录配置，请检查这些配置是否存在这些漏洞。
    </td>
  </tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44832">CVE-2021-44832</a></td><td></td></tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-4104">CVE-2021-4104</a></td><td></td></tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22963">CVE-2022-22963</a></td><td></td></tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965">CVE-2022-22965</a></td><td></td></tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9488">CVE-2020-9488</a></td><td></td></tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23302">CVE-2022-23307</a></td><td></td></tr>
</table>

>[!NOTE]
> 
> AEM 6.5.13.0 Forms及更早版本包含这两个Log4j库（1.x和2.17.1）。 AEM 6.5.13.0 Forms及更早版本中的AEM Forms Log4j 1.x库不在报告的漏洞之列，也未在由Adobe执行的AEM Forms代码扫描中标注为易受攻击。 但是，所有Log4j 1.x库都将在6.5.14版本中删除。 有关安装AEM 6.5.14.0或更高版本的说明，请参阅[发行说明](https://experienceleague.adobe.com/zh-hans/docs/experience-manager-65/content/release-notes/release-notes)。

## 解决方法

您可以使用以下方法之一来降低此漏洞的风险：

* 安装最新的服务包
* 采用手动缓解步骤

**安装最新的Service Pack**

>[!CAUTION]
> 
> 如果您已在Experience Manager Forms Service Pack 6.3.3.8或Experience Manager Forms Service Pack 6.4.8.4环境中应用修补程序，则不要安装包含漏洞修补程序的服务包（如下所示）。 安装这些Service Pack可能会覆盖修补程序。 在这种情况下，Adobe建议使用&#x200B;**手动缓解步骤**。

<table border="1" cellpadding="8" cellspacing="0">
  <thead>
    <tr>
      <th>发行版本</th>
      <th>版本号</th>
      <th>下载链接/用户操作</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>JEE上的Experience Manager 6.5 Forms</td>
      <td>AEMForms-6.5.0-0038 (log4jv2.16)</td>
      <td rowspan="5">从<a href="https://auth.services.adobe.com/en_US/index.html?callback=https%3A%2F%2Fims-na1.adobelogin.com%2Fims%2Fadobeid%2Fexc_app%2FAdobeID%2Ftoken%3Fredirect_uri%3Dhttps%253A%252F%252Fexperience.adobe.com%252F%2523old_hash%253Dold_hash%253D%252523%25252Fdownloads%2526from_ims%253Dtrue%253Fclient_id%253Dexc_app%2526api%253Dauthorize%2526scope%253Dab.manage%252Caccount_cluster.read%252Cadditional_info%252Cadditional_info.job_function%252Cadditional_info.projectedProductContext%252Cadditional_info.roles%252CAdobeID%252Cadobeio.appregistry.read%252Cadobeio_api%252Caudiencemanager_api%252Ccreative_cloud%252Cmps%252Copenid%252Corg.read%252Cpps.read%252Cread_organizations%252Cread_pc%252Cread_pc.acp%252Cread_pc.dma_tartan%252Csession%26state%3D%257B%2522jslibver%2522%253A%2522v2-v0.31.0-2-g1e8a8a8%2522%252C%2522nonce%2522%253A%25223811059492261787%2522%257D%26code_challenge_method%3Dplain%26use_ms_for_expiry%3Dtrue&amp;client_id=exc_app&amp;scope=ab.manage%2Caccount_cluster.read%2Cadditional_info%2Cadditional_info.job_function%2Cadditional_info.projectedProductContext%2Cadditional_info.roles%2CAdobeID%2Cadobeio.appregistry.read%2Cadobeio_api%2Caudiencemanager_api%2Ccreative_cloud%2Cmps%2Copenid%2Corg.read%2Cpps.read%2Cread_organizations%2Cread_pc%2Cread_pc.acp%2Cread_pc.dma_tartan%2Csession&amp;state=%7B%22jslibver%22%3A%22v2-v0.31.0-2-g1e8a8a8%22%2C%22nonce%22%3A%223811059492261787%22%7D&amp;relay=2cf36844-ac87-4b40-a6fe-9a06cd0a01b8&amp;locale=en_US&amp;flow_type=token&amp;dctx_id=v%3A2%2Cs%2Cf%2Cb8e64530-b013-11ee-a6c1-e721bdec0171&amp;idp_flow_type=login&amp;response_type=token&amp;profile_filter=%7B%22findFirst%22%3Atrue%2C+%22fallbackToAA%22%3Atrue%2C+%22preferForwardProfile%22%3Atrue%2C+%22searchEntireCluster%22%3Afalse%7D%3B+hasPC%28%22dma_tartan%22%29&amp;code_challenge_method=plain&amp;redirect_uri=https%3A%2F%2Fexperience.adobe.com%2F%23old_hash%3Dold_hash%3D%2523%252Fdownloads%26from_ims%3Dtrue%3Fclient_id%3Dexc_app%26api%3Dauthorize%26scope%3Dab.manage%2Caccount_cluster.read%2Cadditional_info%2Cadditional_info.job_function%2Cadditional_info.projectedProductContext%2Cadditional_info.roles%2CAdobeID%2Cadobeio.appregistry.read%2Cadobeio_api%2Caudiencemanager_api%2Ccreative_cloud%2Cmps%2Copenid%2Corg.read%2Cpps.read%2Cread_organizations%2Cread_pc%2Cread_pc.acp%2Cread_pc.dma_tartan%2Csession&amp;use_ms_for_expiry=true#/">软件分发</a>下载。</td>
    </tr>
    <tr>
      <td>JEE上的Experience Manager 6.4 Forms</td>
      <td>AEMForms-6.4.0-0027</td>
    </tr>
    <tr>
      <td>JEE上的Experience Manager 6.3 Forms</td>
      <td>AEMForms-6.3.0-0047</td>
    </tr>
    <tr>
      <td>Experience Manager 6.5 Forms Designer</td>
      <td>AEM Forms Designer v650.019</td>
    </tr>
    <tr>
      <td>Experience Manager 6.4 Forms Designer</td>
      <td>AEM Forms Designer v640.012</td>
    </tr>
    <tr>
      <td>自动化表单转换服务</td>
      <td>确定了缓解步骤并修补了服务。</td>
      <td>没有用户操作。</td>
    </tr>
  </tbody>
</table>

## 采用手动缓解步骤

要针对Experience Manager 6.5 Forms（log4j-core版本2.10及更高版本）、Experience Manager 6.4 Forms（低于2.10的log4j-core版本）和Experience Manager 6.3 Forms（低于2.10的log4j-core版本）缓解此问题，请执行以下步骤：

1. 关闭所有服务器实例和定位器。

1. 从位于以下位置的易受攻击的`log4j-core-2.xx.jar`中删除`org/apache/logging/log4j/core/lookup/JndiLookup.class`：

   * **可部署的EAR：**

   ```javascript
   <FORMS_INSTALLATION_DIRECTORY>/configurationManager/export/adobe-livecycle-[jboss|weblogic|websphere].ear
   ```

   * **GemFire或Geode定位器：**

   ```javascript
   <FORMS_INSTALLATION_DIRECTORY>/lib/caching/lib
   ```

   要更新可部署的EAR，请根据您的操作系统，使用以下方法之一从易受攻击的`log4j-core-2.xx.jar`中删除`JndiLookup.class`：

   * (具有Oracle WebLogic或Redhat JBoss的Linux)：运行以下命令。 更新`version`和应用程序服务器信息，然后运行以下命令：

   ```javascript
   unzip adobe-livecycle-<weblogic|jboss>.ear lib/log4j-core-<version>.jar
   ```

   ```javascript
   zip -d lib/log4j-core-xxx.jar org/apache/logging/log4j/core/lookup/JndiLookup.  class
   ```

   ```javascript
   zip -ru adobe-livecycle-jboss.ear lib/log4j-core-<version>.jar
   ```

   * (具有IBM WebSphere的Linux)：运行以下命令。 更新`version`和应用程序服务器信息，然后运行以下命令：

   ```javascript
   unzip adobe-livecycle-websphere.ear log4j-core-<version>.jar
   ```

   ```javascript
   zip -d log4j-core-xxx.jar org/apache/logging/log4j/core/lookup/JndiLookup.class
   ```

   * (Microsoft Windows)：使用[7-Zip](https://www.7-zip.org/)等GUI工具删除类文件。
1. 对每个应用程序服务器实例（节点）和所有定位器（如果有多个）重复步骤2。

1. 更新jar后，重新部署修改过的EAR并重新启动所有定位器进程和服务器实例。

>[!NOTE]
> 
> * 将log4j-core-2.xx jar的原始副本替换为更新后的副本。 无需进行其他更改。
> * 再次运行配置管理器时，可以覆盖`<FORMS_INSTALLATION_DIRECTORY/configurationManager/export`的内容。   要避免每次发生此情况时都重新执行上述更改，请在`<FORMS_INSTALLATION_DIRECTORY>/deploy/adobe-core-[jboss|weblogic|websphere].ear`中更新jar。 这可确保配置管理器生成的`adobe-livecycle-[jboss|weblogic|websphere].ear`已具有更新的`log4j-core-2.xx jar`。
> * 修补/升级时，可能会覆盖对可部署工件所做的手动修改。 如果发生这种情况，请重新执行该过程。

## 引用

[https://logging.apache.org/log4j/2.x/security.html](https://logging.apache.org/security.html)

**如果在执行缓解步骤时遇到其他问题或问题，我应该联系谁？**

您可以联系[Adobe支持](https://experienceleague.adobe.com/zh-hans?lang=zh-hans&amp;support-solution=Experience+Manager#support)或提出[支持票证](https://experienceleague.adobe.com/zh-hans/docs/customer-one/using/home#submit-ticket)。

**如果在执行缓解步骤时遇到其他问题或问题，我应该联系谁？**
[法律声明](https://helpx.adobe.com/cn/legal/legal-notices.html)    |    [联机隐私策略](https://www.adobe.com/cn/privacy.html)