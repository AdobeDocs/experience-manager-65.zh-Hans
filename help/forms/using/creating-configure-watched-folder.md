---
title: 创建或配置监视文件夹
seo-title: 创建或配置监视文件夹
description: 了解如何创建或删除监视文件夹，或修改现有监视文件夹的属性。
seo-description: 了解如何创建或删除监视文件夹，或修改现有监视文件夹的属性。
uuid: 659d4d8c-99b8-40dd-b884-bfee4d476fe1
content-type: reference
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: publish
discoiquuid: 0ce7b338-6686-49b3-b58b-e7ab6b670708
translation-type: tm+mt
source-git-commit: 726163106ddb80600eaa7cc09b1a2e9b035a223e

---


# 创建或配置监视文件夹 {#create-or-configure-a-watched-folder}

管理员可以配置网络文件夹(称为监 *视文件夹*)，这样，当用户将文件（如PDF文件）放置到监视文件夹时，将启动预配置的操作并处理该文件。 执行指定的操作后，操作会将修改后的文件保存到指定的输出文件夹中。 有关管理监视文件夹的详细信息，请参阅管 [理帮助](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md)。

您可以使用监视文件夹用户界面执行以下操作：

* 创建监视文件夹
* 修改现有监视文件夹的属性
* 删除监视文件夹

## 创建监视文件夹 {#create-a-watched-folder}

在配置监视文件夹之前，请确保：

* 监视文件夹是AEM表单的高级功能。 它需要AEM forms Add-on包才能正常工作。 确保安装和配置了相应的AEM Forms加载项包。
* 您可以在共享或本地存储中创建监视的文件夹。 确保配置为运行监视文件夹的AEM表单用户对监视文件夹具有读写权限。
* 您可以使用服务、工作流或脚本自动执行监视文件夹的操作。 确保创建了相应的服务、工作流或脚本并准备运行。 有关创建服务、工作流和脚本的信息，请参 [阅各种文件处理方法](/help/forms/using/watched-folder-in-aem-forms.md#various-methods-for-processing-files)。
* 监视的文件夹具有各种属性，请参阅 [监视的文件夹属性](watched-folder-in-aem-forms.md#watchedfolderproperties)。

执行以下步骤以创建监视文件夹：

1. 点 **按屏幕左上角的Adobe Experience Manager** 图标。
1. 点按 **工具** >表 **单** >配 **置监视文件夹。** 将显示已配置监视文件夹的列表。
1. 点按 **新建**。 此时将显示创建监视文件夹所需的一列表字段：

   * **名称**:标识已监视的文件夹。 名称仅使用字母数字字符。
   * **路径**:指定监视的文件夹位置。 在群集环境中，此设置必须指向一个共享网络文件夹，该文件夹可供在群集的不同节点上运行AEM的每个用户访问。
   * **处理文件时使用**:要开始的进程类型。 您可以指定工作流、脚本或服务。
   * **服务名称／脚本路径／工作流路径**:字段的行为基于为“使用进程文件”字段指 **定的值** 。 您可以指定以下值：

      * 对于“工作流”，指定要执行的工作流模型。 例如，/etc/workflow/models/&lt;workflow_name>/jcr:content/model
      * 对于“脚本”，指定要执行的脚本的JCR路径。 例如，/etc/watchfolder/test/testScript.ecma
      * 对于“服务”，指定用于查找OSGi服务的过滤器。 该服务将注册为com.adobe.aemfd.watchfolder.service.api.ContentProcessor Interface的实现。 例如，以下代码是具有自定义(foo=bar)属性的ContentProcessor接口的自定义实现。
   >[!NOTE]
   >
   >如果已为“ **Process** Files **Using** ”（进程文件使用）字段选择“Service”（服务），则“Service Name”(inputProcessorType)字段的值必须括在括号中。 例如，(foo=bar)。

   ```java
   @Component(metatype = true, immediate = true, label = "WF Test Service", description = "WF Test Service")
   @Service(value = {OutputWriter.class, ContentProcessor.class})
   @Property(name = "foo", value = "bar")
   public class OutputWriter implements ContentProcessor {
   ```

   * **输出文件模式**:指定分号(;)分隔的模式列表，监视的文件夹使用这些分号来确定输出文件和文件夹的名称和位置。 有关文件模式的详细信息，请参 [阅关于文件模式](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)。


1. 点按 **高级**。 高级选项卡包含更多字段。 这些字段中的大多数都包含默认值。

   * **有效负荷映射器过滤器：** 在创建监视的文件夹时，它会在被监视的文件夹中创建一个文件夹结构。 文件夹结构具有舞台、结果、保留、输入和失败文件夹。 文件夹结构可用作工作流的输入有效负荷并接受来自工作流的输出。 它还可以列表故障点（如果有）。 有效负荷的结构与监视文件夹的结构不同。 您可以编写自定义脚本，将监视文件夹的结构映射到有效负荷。 这种脚本称为负载映射器过滤器。 提供两种现成的有效负荷映射器实现。 如果您没有自 [定义实施](/help/forms/using/watched-folder-in-aem-forms.md#creating-a-custom-payload-mapper-filter)，请使用现成的实施之一：

      * **默认映射器：** 使用默认的有效负荷映射器，可将已监视文件夹的输入和输出内容保留在有效负荷中单独的输入和输出文件夹中。
      * **简单的基于文件的负载映射器：** 使用基于简单文件的有效负荷映射器将输入和输出内容直接保留在有效负荷文件夹中。 它不会创建任何额外的层次结构，如默认映射器。
   * **运行模式**:为工作流执行指定允许的运行模式以逗号分隔的列表。
   * **超时暂存文件**:指定等待的秒数，然后输入文件／文件夹（已被选取以进行处理）被视为超时并标记为失败。 仅当此属性的值为正数时，停时机制才会激活。
   * **在限制时删除超时暂存文件**:如果启用，则仅 **在为已监视的文件夹打开限制时，才会激活“超时暂存文件** ”机制。
   * **扫描输入文件夹的间隔：** 指定扫描监视的文件夹以获取输入的时间间隔（以秒为单位）。 除非启用“限制”设置，否则轮询间隔应长于处理平均作业的时间；否则，系统可能会过载。 间隔的值必须大于或等于1。
   * **排除文件模式**:指定分号(;)分隔的列表，以指示被监视的文件夹用来确定要扫描和拾取的文件和文件夹的模式。 不扫描具有指定模式的任何文件或文件夹进行处理。 有关文件模式的详细信息，请参 [阅关于文件模式](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)。
   * **包括文件模式**:指定分号(;)分隔的模式列表，监视的文件夹使用这些模式确定要扫描和拾取的文件夹和文件。 例如，如果“包括文件模式”为input&amp;ast;，则所有与input&amp;ast匹配的文件和文件夹；都被抓了。 默认值为&amp;ast;并指示所有文件和文件夹。 有关文件模式的详细信息，请参 [阅关于文件模式](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)。
   * **等待时间：** 指定在创建文件夹或文件后扫描文件之前等待的时间（以毫秒为单位）。 例如，如果等待时间为3,600,000毫秒（1小时），且文件是在一分钟前创建的，则此文件将在59分钟或更长时间后被选取。 默认值为 0。

      此设置有助于确保将文件或文件夹的所有内容复制到输入文件夹。 例如，如果要处理一个大文件，而该文件需要10分钟才能下载，请将等待时间设置为10&amp;ast;60 &amp;ast;1000毫秒。 如果文件未保存10分钟，此间隔将阻止监视的文件夹扫描文件。

   * **删除早于以下时间的结果：** 指定在删除早于指定值的文件和文件夹之前等待的时间（以天为单位）。 此设置有助于确保结果文件夹未变为完整。 值为-1天表示从不删除结果文件夹。 默认值是-1。
   * **结果文件夹名称：** 指定用于存储结果的文件夹的名称。 如果结果未显示在此文件夹中，请检查失败文件夹。 只读文件不会被处理，并保存在失败文件夹中。 可以将绝对路径或相对路径与以下文件模式一起使用：

      * %F =文件名前缀
      * %E =文件扩展名
      * %Y =年（已满）
      * %y =年（最后两位）
      * %M =月
      * %D =月日
      * %d =年
      * %H =小时（24小时制）
      * %h =小时（12小时制）
      * %m =分钟
      * %s =秒
      * %l =毫秒
      * %R =随机数（0到9之间）
      * %P =进程或作业ID
      * 例如，如果2009年7月17日下午8点，并且指定C:/Test/WF0/failure/%Y/%M/%D/%H/，则结果文件夹为C:/Test/WF0/failure/2009/07/17/20。
      * 如果路径不是绝对的，而是相对的，则会在监视的文件夹中创建该文件夹。 默认值是result/%Y/%M/%D/，它是监视文件夹内的Result文件夹。 有关文件模式的详细信息，请参 [阅关于文件模式](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)。
   * **失败文件夹名称：** 指定保存失败文件的文件夹。 此位置始终与监视的文件夹相关。 您可以使用文件模式，如“结果文件夹”中所述。
   * **保留文件夹名称：** 指定成功扫描和拾取文件后存储文件的文件夹。 路径可以是绝对目录、相对目录或null目录。 您可以使用文件模式，如“结果文件夹”中所述。 默认值为preserve/%Y/%M/%D/。
   * **批大小：** 指定每次扫描要选取的文件或文件夹数。 它防止了系统过载；一次扫描过多文件可能会导致崩溃。 默认值为 2。

      如果扫描间隔较小，则线程会经常扫描输入文件夹。 如果文件经常被放入监视的文件夹中，那么您应该保持较小的扫描间隔。 如果文件不常被删除，请使用更大的扫描间隔，以便其他服务可以使用线程。

   * **油门开启：** 启用此选项后，它将限制AEM表单在任何给定时间处理的已监视文件夹作业的数量。 “批量大小”值确定最大作业数。 有关详细信息，请参阅 [限制](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-throttling)
   * **使用类似名称覆盖现有文件**:设置为“True”时，结果文件夹和保留文件夹中的文件将被覆盖。 设置为“False”时，名称将使用带有数字索引后缀的文件和文件夹。 默认值为False。
   * **失败时保留文件：** 设置为True时，在失败时保留输入文件。 默认值为true。
   * **包含模式文件：** 指定分号(;)分隔的模式列表，监视的文件夹使用这些模式确定要扫描和拾取的文件夹和文件。 例如，如果输入“包括文件模式”，则会选取所有与输入匹配的文件和文件夹。 有关详细信息，请参阅管 [理帮助](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md)
   * **异步调用监视文件夹：** 将调用类型标识为异步或同步。 默认值为异步。 建议对于长寿命进程使用异步，而对于瞬态或短寿命进程，建议使用同步。
   * **启用监视文件夹：** 启用此选项后，将启用监视文件夹。 默认值为True。



## 修改现有监视文件夹的属性 {#modify-properties-of-an-existing-watched-folder}

除了更改已监视文件夹的名称外，您还可以修改现有已监视文件夹的所有属性。 请执行以下步骤以修改现有监视文件夹的属性：

1. 点按 **屏幕左上角的Adobe Experience Manager** 图标。
1. 点按 **工具** >表 **单** >配 **置监视文件夹。** 将显示已配置监视文件夹的列表。
1. 在“监视文件夹”屏幕的左侧，选择监视文件夹，然后点按编 **辑。** 此时将显示创建监视文件夹所需的一列表字段。 “基本”选项卡中列 **出的字段** 是必填字段。 高级选项卡包含更多字段。 这些字段中的大多数都包含默认值。 您可以根据自己的要求修改这些属性。
1. 修改属性后，点按更 **新**。 将保存修改的属性。

