---
title: 配置电子邮件端点
description: 了解如何配置电子邮件端点。 电子邮件端点使您能够通过向指定的电子邮件帐户发送一个或多个文档来调用服务。
contentOwner: admin
content-type: reference
geptopics: SG_AEMFORMS/categories/managing_endpoints
products: SG_EXPERIENCEMANAGER/6.5/FORMS
exl-id: 33583a12-4f20-4146-baa4-c9854e454bbf
solution: Experience Manager, Experience Manager Forms
source-git-commit: 76fffb11c56dbf7ebee9f6805ae0799cd32985fe
workflow-type: tm+mt
source-wordcount: '3796'
ht-degree: 0%

---

# 配置电子邮件端点 {#configuring-email-endpoints}

电子邮件端点使用户能够通过向指定的电子邮件帐户发送一个或多个文档（作为电子邮件附件）来调用服务。 电子邮件收件箱充当附件的收集点。 该服务将监视收件箱并处理附件。 转换结果将转发到端点中定义的用户。

对于电子邮件端点，授权用户可以通过通过电子邮件将文件发送到相应的帐户来调用进程。 结果将返回给提交用户（默认情况下）或端点设置中定义的用户。

在配置电子邮件端点之前，请创建供该端点使用的POP3或IMAP电子邮件帐户。 为每种类型的转换设置单独的帐户。 例如，一个帐户可以配置为从传入文件附件生成标准PDF文档，而另一个帐户可以配置为生成安全PDF文档。

>[!NOTE]
>
>每个电子邮件地址必须仅映射到一个电子邮件端点。 您不能将多个电子邮件端点配置为单个电子邮件地址，即使其他电子邮件端点已禁用。

所有电子邮件端点都配置了电子邮件收件箱的授权用户名和密码，在调用服务时需要这些用户名和密码。 电子邮件帐户受其配置的邮件服务器系统的保护。

如果用户发送的文件和转换路径名中包含西欧语言字符的文档，则必须使用支持所需编码类型(Latin1)的电子邮件应用程序 [ISO-8859-1]，西欧 [Windows]，或UTF-8)。 欲了解更多信息，请参见 *安装和部署AEM Forms* 应用程序服务器的文档。

在配置电子邮件端点之前，请配置电子邮件服务。 (请参阅 [配置默认电子邮件端点设置](configuring-email-endpoints.md#configure-default-email-endpoint-settings).) 电子邮件服务的配置参数有两个用途：

* 配置所有电子邮件端点的通用属性
* 为所有电子邮件端点提供默认值

## 为电子邮件端点配置SSL {#configure-ssl-for-an-email-endpoint}

您可以将POP3、IMAP或SMTP配置为对电子邮件端点使用安全套接字层(SSL)。

1. 在电子邮件服务器上，根据制造商的文档为POP3、IMAP或SMTP启用SSL。
1. 从电子邮件服务器导出客户端证书。
1. 使用keytool程序将客户端证书文件导入到应用程序服务器的Java虚拟机(JVM)证书存储中。 此步骤的过程将取决于JVM和客户端的安装路径。

   例如，如果在Microsoft Windows Server® 2003上使用带有JDK 1.5.0的默认OracleWebLogic Server安装，请在命令提示符下键入以下文本：

   `keytool -import -file client_certificate -alias myalias -keystore BEA_HOME\jdk150_04\jre\security\cacerts`

1. 出现提示时，输入密码(对于Java，默认密码为 `changeit`)。 您将收到一条消息，说明证书已成功导入。
1. 使用管理控制台将电子邮件端点添加到服务。
1. 在管理控制台中创建电子邮件端点。 配置端点设置时，为传入消息选择POP3/IMAP SSL已启用，为传出消息选择SMTP SSL已启用，并相应地更改端口属性。

>[!NOTE]
>
>提示：如果在使用SSL时遇到问题，请使用电子邮件客户端(如Microsoft Outlook)检查它是否可以使用SSL访问电子邮件服务器。 如果电子邮件客户端无法访问电子邮件服务器，则问题与证书或电子邮件服务器的配置有关。

## 配置默认电子邮件端点设置 {#configure-default-email-endpoint-settings}

使用“服务管理”页可以配置所有电子邮件端点的通用属性，并为所有电子邮件端点提供默认值。

要使表单工作流接收和处理来自用户的传入电子邮件，您需要为“完成任务”服务创建电子邮件端点。 此电子邮件端点需要其他设置，如中所述 [为完成任务服务创建电子邮件端点](configuring-email-endpoints.md#create-an-email-endpoint-for-the-complete-task-service).

### 更改电子邮件端点的默认值 {#change-the-default-values-for-email-endpoints}

1. 在管理控制台中，单击服务>应用程序和服务>服务管理。
1. 在“服务管理”页面上，单击电子邮件：1.0（组件ID为com.adobe.idp.dsc.provider.service.email.Email）。
1. 在配置选项卡上，指定默认的电子邮件端点设置，然后单击保存。

### 默认电子邮件端点设置 {#default-email-endpoint-settings}

**Cron表达式：** Quartz用来安排轮询输入目录的cron表达式。

**重复间隔：** 重复目录轮询的次数。 如果未在端点配置中指定此值，则默认重复间隔为秒。 默认值为 10。此值不能小于10。

**重复计数：** 轮询输入目录的次数。 如果未在终结点配置中指定此值，则使用默认重复计数。 值为–1表示无限扫描目录。 默认值为 -1。

**作业开始时的延迟：** 作业开始扫描端点之前的延迟的默认值（以秒为单位）。 默认值为 0。

**批次大小：** 每次扫描接收者为获得最佳性能而处理的电子邮件数量。 值为–1表示所有电子邮件。 默认值为 2。

**异步：** 将调用类型标识为异步或同步。 瞬态和同步进程只能同步调用。 默认值为asynchronous。

**域模式：** 用于过滤传入电子邮件的域名模式。 例如，如果使用adobe.com，则只处理来自adobe.com的电子邮件；忽略来自其他域的电子邮件。

**文件模式：** 提供程序接受的传入文件附件模式。 这包括具有特定扩展名(&amp;ast；.dat、&amp;ast；.xml)、特定名称（数据）以及名称和扩展名()中的复合表达式的文件。[分日][aA]&#39;端口&#39;)。 默认值为&amp;ast；。&amp;ast；。

**成功的作业的收件人：** 一个或多个电子邮件地址，用于发送电子邮件以指示成功的作业。 默认情况下，成功的作业消息始终发送给初始作业的发送者。 最多支持100个收件人。 要关闭此设置，请将此字段留空。

**失败的作业的收件人：** 一个或多个电子邮件地址，用于发送电子邮件以指示失败的作业。 默认情况下，失败作业消息始终发送给发送初始作业的发件人。 最多支持100个收件人。 要关闭此设置，请将此字段留空。

**收件箱主机：** 要扫描的电子邮件提供程序的收件箱主机名或IP地址。

**收件箱端口：** 要扫描的电子邮件提供商的收件箱端口号。 如果该值为0，则使用默认的IMAP或POP3端口。

**收件箱协议：** 用于扫描收件箱的电子邮件端点的电子邮件协议。 选项为IMAP或POP3。 收件箱主机邮件服务器必须支持这些协议。

**收件箱超时：** 指定在尝试连接到收件箱时，终结点在取消之前等待的时间。 如果在达到超时值之前未获得连接，将不会轮询收件箱。

**收件箱用户：** 登录电子邮件帐户所需的用户名。 根据电子邮件服务器和配置，此名称可能只是电子邮件的用户名部分，也可能是完整的电子邮件地址。

**收件箱密码：** 收件箱用户的密码。

**已启用POP3/IMAP SSL：** 选中后，将启用SSL。

**SMTP主机：** 电子邮件提供商用于发送结果和错误消息的邮件服务器的主机名。 例如，mail.example.com。

**SMTP端口：** 用于连接到邮件服务器的端口。 默认值为 25。

**SMTP用户：** 电子邮件提供商在发送有关结果和错误的电子邮件时使用的用户帐户。

**SMTP密码：** SMTP帐户的密码。 某些邮件服务器不需要SMTP密码。

**发送自：** 用于发送结果和错误的电子邮件通知的电子邮件地址(例如，user@company.com)。 如果未指定“发送自”值，则电子邮件服务器会尝试通过将“SMTP用户”设置中指定的值与在电子邮件服务器上配置的默认域组合来确定电子邮件地址。 如果您的电子邮件服务器没有默认域，并且您没有为“发送自”指定值，则可能会发生错误。 为确保电子邮件的发件人地址正确，请为“发件人”设置指定一个值。

**已启用SMTP SSL：** 选中后，将启用SSL over SMTP。

**将原始电子邮件正文作为附件包含：** 默认情况下，向Forms服务器发送电子邮件时，邮件正文中将包含邮件原始文本。 要改为将文本作为附件包含，请选择此选项。

**对结果电子邮件使用原始主题行：** 默认情况下，发送结果电子邮件时，Forms Server使用成功电子邮件主题和错误电子邮件主题设置中指定的值作为主题行。 要改用与发送到服务器的原始电子邮件相同的主题行，请选择此选项。

**成功电子邮件主题：** 向电子邮件端点发送电子邮件以启动或继续某个流程后，您将从AEM Forms服务器收到一封返回电子邮件。 如果电子邮件成功，您将收到一封成功电子邮件。 如果电子邮件失败，您将收到一封失败电子邮件，告知其失败原因。 通过此设置，可指定为此端点发送的成功电子邮件的主题行。

**成功电子邮件正文：** 允许您指定为此端点发送的成功电子邮件的正文文本。

**错误电子邮件主题前缀：** 允许您指定在此端点发送的失败电子邮件主题行开头使用的文本。

**错误电子邮件主题：** 使您可指定为此端点发送的失败电子邮件的主题行。 此文本显示在错误电子邮件主题前缀之后。

**错误电子邮件正文：** 允许您指定为此端点发送的失败电子邮件正文中的第一行。

**电子邮件摘要信息：** 每条成功或失败消息都包含一个部分，其中包含您发送到Forms服务器的原始电子邮件文本。 此设置指定该部分上方显示的文本。

**在创建/更新此端点之前验证收件箱：** 如果选择该选项，Forms服务器将在创建端点之前检查您的SMTP/POP3设置是否正确。 单击“添加”后，将显示一条消息，说明收件箱帐户是否有效。 如果未选中此选项，则AEM Forms服务器将在不验证收件箱的情况下创建端点。

**字符集编码：** 用于电子邮件的编码格式。 默认值为UTF-8，日本以外的多数用户都将使用该格式。 日本环境中的用户可以选择ISO2022-JP。

**失败的电子邮件发送文件夹：** 指定在SMTP邮件服务器不工作时，用于存储结果的目录。

## 电子邮件端点设置 {#email-endpoint-settings}

使用以下设置配置电子邮件端点。

**名称：** 标识端点的强制设置。 不要包含&lt;字符，因为它会截短工作区中显示的名称。 如果您输入URL作为端点的名称，请确保它符合RFC1738中指定的语法规则。

**描述：** 端点的描述。 不要包含&lt;字符，因为它会截断Workspace中显示的说明。

**Cron表达式：** 如果电子邮件必须使用cron表达式进行计划，请输入cron表达式。

**重复计数：** 电子邮件端点扫描文件夹或目录的次数。 值–1表示无限扫描。 默认值为 -1。

**重复间隔：** 接收者用于检查传入邮件的扫描速率。

**作业开始时的延迟：** 计划程序启动后等待扫描的时间。

**批次大小：** 每次扫描接收者为获得最佳性能而处理的电子邮件数量。 值为–1表示所有电子邮件。 默认值为 2。

**用户名：** 强制设置，从电子邮件调用目标服务时使用的用户名。 默认值为SuperAdmin。

**域名：** 强制设置，即用户的域。 默认值为DefaultDom。

**域模式：** 指定提供程序接受的传入电子邮件的域模式。 例如，如果使用adobe.com，则仅处理来自adobe.com的电子邮件；忽略来自其他域的电子邮件。

**文件模式：** 指定提供程序接受的传入文件附件模式。 这包括具有特定扩展名(&amp;ast；.dat、&amp;ast；.xml)、特定名称（数据）或名称和扩展名(&amp;ast；中的复合表达式的文件。[分日][aA]&#39;端口&#39;)。

**成功的作业的收件人：** 发送消息以指示作业成功的电子邮件地址。 默认情况下，成功的工作消息将始终发送给发件人。 如果键入sender ，则会向发件人发送电子邮件结果。 最多支持100个收件人。 使用用逗号(，)分隔的电子邮件地址指定其他收件人。

要关闭此设置，请将该设置留空。 在某些情况下，您要触发一个进程，并且不希望收到关于结果的电子邮件通知。

**失败的作业的收件人：** 发送消息以指示失败的作业的电子邮件地址。 默认情况下，始终将失败的作业消息发送给发件人。 如果键入sender ，则会向发件人发送电子邮件结果。 最多支持100个收件人。 使用用逗号(，)分隔的电子邮件地址指定其他收件人。

要关闭此设置，请将该设置留空。 在某些情况下，您要触发一个进程，并且不希望收到关于结果的电子邮件通知。

**收件箱主机：** 要扫描的电子邮件提供程序的收件箱主机名或IP地址。

**收件箱端口：** 电子邮件服务器使用的端口。 POP3的默认值为110，IMAP的默认值为143。 如果启用了SSL，则POP3的默认值为995，而IMAP的默认值为993。

**收件箱协议：** 用于扫描收件箱的电子邮件端点的电子邮件协议。 值为IMAP或POP3。 收件箱主机邮件服务器必须支持这些协议。

**收件箱超时：** 电子邮件提供商等待收件箱响应的超时（以秒为单位）。

**收件箱用户：** 登录电子邮件帐户所需的用户名。 根据电子邮件服务器和配置，此值可能只是电子邮件的用户名部分，也可能是完整的电子邮件地址。

**收件箱密码：** 收件箱用户的密码。

**已启用POP3/IMAP SSL：** 选择此设置可强制电子邮件提供商使用SSL扫描收件箱。 确保邮件服务器支持SSL。

**SMTP主机：** 电子邮件提供商用于发送结果和错误消息的邮件服务器的主机名。

**SMTP端口：** SMTP端口的缺省值为25。

**SMTP用户：** 电子邮件提供商在发送结果和错误的电子邮件通知时使用的用户帐户。

**SMTP密码：** SMTP帐户的密码。 某些邮件服务器不需要SMTP密码。

**发送自：** 用于发送结果和错误的电子邮件通知的电子邮件地址(例如，user@company.com)。 如果未指定“发送自”值，则电子邮件服务器会尝试通过将“SMTP用户”设置中指定的值与在电子邮件服务器上配置的默认域组合来确定电子邮件地址。 如果您的电子邮件服务器没有默认域，并且您没有为“发送自”指定值，则可能会发生错误。 为确保电子邮件的发件人地址正确，请为“发件人”设置指定一个值。

**已启用SMTP SSL：** 选择此设置可强制电子邮件提供商使用SSL扫描收件箱。 确保邮件服务器支持SSL。

**失败的电子邮件发送文件夹：** 指定在SMTP邮件服务器不工作时，用于存储结果的目录。

**异步：** 当设置为synchronous时，将处理所有输入文档并返回单个响应。 当设置为异步时，将为处理的每个文档发送响应。

例如，为接受单个Word文档并将该文档作为PDF文件返回的服务创建电子邮件端点。 可以将电子邮件发送到包含多(3)个Word文档的端点收件箱。 处理完所有三个文档后，如果端点配置为同步，则会发送一封包含所有三个文档的响应电子邮件。 如果端点为异步端点，则在每个Word文档转换为PDF后都会发送一封响应电子邮件。 结果是发送三封电子邮件，每封都包含一个PDF附件。

默认值为asynchronous。

**将原始电子邮件正文作为附件包含：** 默认情况下，向Forms服务器发送电子邮件时，邮件正文中将包含邮件原始文本。 要改为将文本作为附件包含，请选择此选项。

**对结果电子邮件使用原始主题行：** 默认情况下，发送结果电子邮件时，Forms Server使用成功电子邮件主题和错误电子邮件主题设置中指定的值作为主题行。 要改用与发送到服务器的原始电子邮件相同的主题行，请选择此选项。

**成功电子邮件主题：** 向电子邮件端点发送电子邮件以启动或继续某个流程后，您将从AEM Forms服务器收到一封返回电子邮件。 如果电子邮件成功，您将收到一封成功电子邮件。 如果电子邮件失败，您将收到一封失败电子邮件，告知其失败原因。 通过此设置，可指定为此端点发送的成功电子邮件的主题行。

**成功电子邮件正文：** 允许您指定为此端点发送的成功电子邮件的正文文本。

**错误电子邮件主题前缀：** 允许您指定在此端点发送的失败电子邮件主题行开头使用的文本。

**错误电子邮件主题：** 使您可指定为此端点发送的失败电子邮件的主题行。 此文本显示在错误电子邮件主题前缀之后。

**错误电子邮件正文：** 允许您指定为此端点发送的失败电子邮件正文中的第一行。

**电子邮件摘要信息：** 每条成功或失败消息都包含一个部分，其中包含您发送到Forms服务器的原始电子邮件文本。 此设置指定该部分上方显示的文本。

**在创建/更新此端点之前验证收件箱：** 如果选择该选项，Forms服务器将在创建端点之前检查您的SMTP/POP3设置是否正确。 单击“添加”后，将显示一条消息，说明收件箱帐户是否有效。 如果未选中此选项，则AEM Forms服务器将在不验证收件箱的情况下创建端点。

**操作名称：** 此设置是必需的。 可分配给电子邮件端点的操作列表。 您在此处选择的操作决定在“输入参数映射”和“输出参数映射”部分中显示哪些字段。

**输入参数映射：** 用于配置处理服务和操作所需的输入。 两种类型的输入是文本输入和变量输入：

**文本：** 电子邮件使用在显示的字段中输入的值。

**变量：** 您可以从电子邮件主题、正文、标题或发件人的电子邮件地址映射字符串。 为此，请使用以下关键字之一： %SUBJECT%、%BODY%、%HEADER%或%SENDER%。 例如，如果您使用%SUBJECT%，则将使用电子邮件主题内容作为输入参数。 要选取附件，请输入电子邮件端点可用于选择附加文档的文件模式。 例如，输入&amp;ast；.pdf将选择任何具有.pdf文件扩展名的附加文档。 输入&amp;ast；选择任何附加文档。 输入example.pdf将选择任何名为example.pdf的附加文档。

**输出参数映射：** 用于配置服务和操作的输出。 输出参数映射值中的以下字符在附件文件名中展开：

**%F** 表示源文件的文件名（不包括扩展名）。

**%E** 表示源文件的扩展名。

反斜杠(\)的任何匹配项将替换为%%。

***注意&#x200B;**：如果服务请求消息包含多个文件附件，则无法为端点的输出参数映射属性使用%F和%E参数。 如果服务响应返回多个文件附件，则无法为多个附件指定相同的文件名。 如果不遵循这些建议，则调用的服务将为返回的文件创建名称，并且这些名称是不可预测的。*

可以使用以下值：

**单个对象：** 电子邮件提供程序没有源文件夹目标；结果将作为附件返回。 模式为Result/%F.ps并返回Result%%sourcefilename.ps作为文件名附件。

**列表：** 模式为Result/%F/，并返回Result%%sourcefilename%%file1作为文件名附件。

**映射：** 模式为Result/%F/，源目标为Result%%sourcefilename%%file1和Result%%sourcefilename%%file2。 如果映射包含多个对象并且模式为Result/%F.ps，则响应文件附件为Result%%sourcefilename1.ps （输出1）和Result%%sourcefilename2.ps （输出2）。

## 为完成任务服务创建电子邮件端点 {#create-an-email-endpoint-for-the-complete-task-service}

要使表单工作流接收和处理来自用户的传入电子邮件，您需要为“完成任务”服务创建电子邮件端点。

1. 在管理控制台中，单击服务>应用程序和服务>服务管理。
1. 在“服务管理”页上，单击完成任务服务。
1. 在端点选项卡上，从下拉列表中选择电子邮件，然后单击添加。
1. 在收件箱主机框中，键入邮件服务器的主机名或IP地址。
1. 在“收件箱用户”框中，键入登录到您创建的用于处理表单提交的电子邮件帐户所需的用户名。 根据电子邮件服务器和配置，此名称可能只是电子邮件的用户名部分，也可能是完整的电子邮件地址。
1. 在“收件箱密码”框中，键入收件箱用户的密码。
1. 在“SMTP主机”框中，键入电子邮件提供商从中发送结果和错误消息的邮件服务器的主机名或IP地址。
1. 在“SMTP用户”框中，键入电子邮件提供商在发送结果和错误电子邮件时使用的用户帐户。 此用户帐户可以是您用于收件箱用户的相同值。
1. 在“SMTP密码”框中，键入SMTP帐户的密码。
1. 在“操作名称”列表中，选择“调用”。
1. 在attachmentMap列表中，选择变量并键入 `*.*` 在旁边的框中。 这会将入站邮件中的所有附件发送到“完成任务”流程的映射变量。
1. 在mailBody列表中，选择变量并键入 `%BODY%` 在旁边的框中。
1. 在mailFrom列表中，选择Variable并键入 `%SENDER%` 在旁边的框中。 这会将发件人地址映射到“完成任务”流程数据。
1. 在结果框中，键入 `results`. 这会导致“完成任务”或“启动进程”返回结果字符串。
1. 单击“添加”。
