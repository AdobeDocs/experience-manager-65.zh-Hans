---
title: 配置表单缓存
seo-title: 配置表单缓存
description: 了解如何配置缓存设置以及如何为缓存设置群集注意事项。
seo-description: 了解如何配置缓存设置以及如何为缓存设置群集注意事项。
uuid: 70f36191-4163-410b-991a-e1481488aea0
contentOwner: admin
content-type: reference
geptopics: SG_AEMFORMS/categories/configuring_forms
products: SG_EXPERIENCEMANAGER/6.5/FORMS
discoiquuid: 8a07dddf-1281-45ac-a55e-4333b860a261
translation-type: tm+mt
source-git-commit: a3c303d4e3a85e1b2e794bec2006c335056309fb

---


# 配置表单缓存{#configuring-caching-for-forms}

Forms服务采用在Designer中创建的表单设计，并以各种格式呈现它们。

管理控制台中的“表单”页面包含用于控制Forms服务缓存项目的方式的设置。 您可以调整这些设置以优化Forms服务的性能。

Forms服务缓存以下项目：

* **** 表单设计：Forms服务缓存从存储库或HTTP源检索的表单设计。 此缓存提高了性能，因为对于后续的渲染请求，Forms服务从缓存中而不是从存储库中检索表单设计。
* **** 片段和图像：Forms服务可以缓存表单设计中使用的片段和图像。 当Forms服务缓存这些对象时，它会提高性能，因为片段和图像只在第一个请求时从存储库读取。
* **** 表单：Forms服务缓存其呈现的表单。 这种类型的缓存提高了性能，因为Forms服务无需在后续请求中解析和呈现相同的表单。

表单将缓存存储在两个位置：

* **** 内存中：项目存储在内存中以便快速访问。 内存中的缓存大小有限，重新启动服务器时将删除该缓存。
* **** 磁盘上：项目存储在服务器的文件系统中。 磁盘缓存的容量大于内存中缓存的容量，在重新启动服务器时将保留该容量。 磁盘缓存的位置取决于应用程序服务器。 有关更改磁盘缓存位置的信息，请参 [阅配置表单位置](/help/forms/using/admin-help/configuring-locations-forms.md#configuring-locations-for-forms)。

## 指定缓存模式 {#specifying-the-cache-mode}

表单支持两种缓存模式：

* 无条件
* 使用缓存检查点

如果在缓存模式之间切换，请重新启动Forms服务，以使更改生效。 要重新启动此服务，请使用Workbench，或参阅启 [动或停止与AEM表单模块关联的服务](/help/forms/using/admin-help/starting-stopping-services.md#start-or-stop-the-services-associated-with-aem-forms-modules) ，以获取说明。

在模式之间切换时，缓存检查点时间会自动重置。

### 使用无条件缓存 {#using-unconditional-caching}

在此模式下，当Forms服务收到请求时，它将验证所需的资源（表单设计以及任何相关资源，如片段和图像）。 Forms服务将存储库中资源的时间戳与缓存中资源的时间戳进行比较。 如果缓存中的资源较旧，Forms服务会更新它。

此缓存模式可确保使用最新资源。 但是，由于Forms服务使用每个请求验证针对存储库的缓存项目，因此性能会受到影响。 此缓存模式适用于资源频繁更新且性能不是主要问题的开发和升级环境。

**指定无条件缓存**

1. 在管理控制台中，单击“服务”>“表单”。
1. 在“表单缓存控制设置”下，选择“无条件”，然后单击“保存”。

### 使用缓存检查点 {#use-the-cache-check-point}

在此模式中，当缓存资源的时间戳早于缓存检查点时间时，Forms服务只检查存储库中是否有较新版本的资源。 上次缓存检查点时间显示在管理控制台的“表单”页面上。

在高性能生产环境中使用此缓存模式，因为性能是一个关键问题，并且对资源的更改很少。 在要部署对存储库资源所做的任何更改时，可以重置缓存检查点时间。

**指定缓存检查点的使用**

1. 在管理控制台中，单击“服务”>“表单”。
1. 在“表单缓存控制设置”下，仅当在缓存检查点时间之前完成了上次验证时选择，然后单击“保存”。

**重置缓存检查点**

1. 在管理控制台中，单击“服务”>“表单”。
1. 在“表单缓存控制设置”下，单击“缓存检查点”。

**重置缓存内容**

您可以随时清除缓存的内容。 缓存重置后，每个表单的第一个请求会更慢，因为Forms服务执行完整渲染并创建新的缓存内容。

1. 在管理控制台中，单击“服务”>“表单”。
1. 在“表单缓存控制设置”下，单击“重置缓存”。

## 配置缓存设置 {#configuring-cache-settings}

您可以指定表单用于缓存的设置，这可以优化AEM表单环境的性能。

要访问这些设置，请在管理控制台中，单击“服务”>“表单”。

>[!NOTE]
>
>缓存的磁盘要求应与存储库相等。

### 指定全局缓存设置 {#specifying-global-cache-settings}

“全局缓存设 **置”区域中的设置** ，会影响所有类型的缓存。 如果您更改了其中任一设置，请重新启动Forms服务，以使更改生效。 要重新启动此服务，请使用Workbench，或参阅启 [动或停止与AEM表单模块关联的服务](/help/forms/using/admin-help/starting-stopping-services.md#start-or-stop-the-services-associated-with-aem-forms-modules) ，以获取说明。

**** 最大缓存文档大小(KB):表单设计或其他资源的最大大小（以千字节为单位），可存储在任何内存中的缓存中。 这是一个全局设置，适用于所有内存中的缓存。 如果某个资源大于此值，则不会在内存中缓存该资源。 默认值为1024 KB。 此设置不影响磁盘缓存。

**** 表单渲染缓存已启用：默认情况下，此选项处于选中状态，这意味着渲染的表单会被缓存以用于后续检索。 此设置提高了性能，因为Forms服务只需渲染特定表单一次，然后就使用缓存的版本。 此选项适用于表单设计的缓存属性。 有关在表单设计中配置此值的信息，请参阅设计人员帮助。

### 缓存表单设计 {#caching-form-designs}

当Forms服务收到渲染请求时，它从存储库检索表单设计并缓存它。 此缓存提高了性能，因为对于后续的渲染请求，Forms服务从缓存中而不是从存储库中检索表单设计。

表单服务始终在磁盘上缓存表单设计。 如果表单设计存储在服务器上，则这些文件将被视为磁盘缓存。 Forms服务还根据“内存模板缓存”区中的设置将表单设计缓 **存到内存中** 。 如果更改了其中的任何设置，请重新启动Forms服务，以使更改生效。 要重新启动此服务，请使用Workbench，或参阅启 [动或停止与AEM表单模块关联的服务](/help/forms/using/admin-help/starting-stopping-services.md#start-or-stop-the-services-associated-with-aem-forms-modules) ，以获取说明。

**** 模板配置缓存大小：要保留在内存中的模板配置对象的最大数量。 默认值为 100。建议您将此值设置为大于或等于“模板缓存大小”值。 此设置不影响磁盘缓存。

**** 模板缓存大小：要保留在内存中的模板内容对象的最大数量。 默认值为 100。此设置不影响磁盘缓存。

**** 已启用：默认情况下，此复选框处于选中状态，这意味着表单模板将缓存在内存中。 如果未选择此选项，则表单模板仅在磁盘上缓存。

### 缓存呈现的表单 {#caching-rendered-forms}

Forms服务缓存呈现的表单，以便它无需在后续请求中解析和呈现相同的表单。 呈现的表单同时缓存在磁盘和内存中。

这些设置位于“内存表 **单渲染缓存”区域** 。 如果您更改了其中任一设置，请重新启动Forms服务，以使更改生效。 要重新启动此服务，请使用Workbench，或参阅启 [动或停止与AEM表单模块关联的服务](/help/forms/using/admin-help/starting-stopping-services.md#start-or-stop-the-services-associated-with-aem-forms-modules) ，以获取说明。

**** 缓存大小：指定可驻留在内存中缓存的渲染表单的最大数量。 默认值为 100。此设置不影响磁盘缓存。

**** 已启用：默认情况下，此选项处于选中状态，这意味着渲染的表单会缓存在内存中。 如果未选择此选项，则渲染的表单仅在磁盘上缓存。

### 缓存片段和图像 {#caching-fragments-and-images}

Forms服务在磁盘上缓存表单设计中使用的片段和图像。 这提高了性能，因为片段和图像只在第一个请求时从存储库读取。 然后，在随后的请求中，Forms服务会从磁盘缓存中读取片段和图像。 片段和图像仅缓存在磁盘上，而不缓存在内存中。

您可以使用以下设置来控制片段和图像的磁盘上缓存。 这些设置位于“模板资源缓 **存设置”区域** :

**资源缓存** 从列表中选择以下选项之一：

**** 为片段和图像启用：Forms服务缓存片段和图像。 这是默认选项。

**** 为片段启用：Forms服务缓存片段，但不缓存图像。

**** 禁用：Forms服务不缓存片段或图像。

**** 清除间隔（秒）:指定Forms服务删除旧的无效缓存文件的频率。 Forms服务不会删除有效的缓存文件。 如果更改了清除间隔，请重新启动Forms服务，以使更改生效。 要重新启动此服务，请使用Workbench，或参阅启动或停止与AEM表单模块关联的服务以获取说明。 默认值是600秒。

## 缓存的群集注意事项 {#clustering-considerations-for-caches}

在群集环境中，每个节点都维护其自己的内存和磁盘缓存。 每个节点上的缓存内容取决于在该节点上渲染的表单。

缓存在群集的每个节点上的位置必须相同（磁盘和路径相同）。 请勿将缓存放在共享存储上。

如果使用管理控制台中的“表单”页更改特定节点的缓存设置，则当请求转到该节点时，其他节点上的缓存设置会更新。 此行为也适用于“重置缓存”按钮。 如果单击某个节点的“重置缓存”按钮，则会立即从该节点删除缓存。 当请求转到该节点时，其他节点上的缓存将被清除。
