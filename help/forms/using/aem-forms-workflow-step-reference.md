---
title: OSGi上以表单为中心的工作流程——步骤参考
seo-title: OSGi上以表单为中心的工作流程——步骤参考
description: 通过OSGi步骤上以表单为中心的工作流程，您可以快速构建基于自适应表单的工作流程。
seo-description: 通过OSGi步骤上以表单为中心的工作流程，您可以快速构建基于自适应表单的工作流程。
uuid: 6f791c45-0e35-4c55-9106-5340caab94b7
contentOwner: null
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: publish
discoiquuid: f0a5588d-f210-4f04-bc35-b62834f90ab1
docset: aem65
translation-type: tm+mt
source-git-commit: 489ff793e05e01c59faba63d60cc362e4f26f703

---


# OSGi上以表单为中心的工作流程——步骤参考{#forms-centric-workflow-on-osgi-step-reference}

## 表单工作流步骤 {#forms-workflow-steps}

表单工作流程步骤在AEM工作流程中执行特定于AEM表单的操作。 这些步骤允许您在OSGi上快速构建基于表单的自适应工作流。 这些工作流可用于开发基本的审阅和批准工作流、内部和跨防火墙的业务流程。 您还可以使用表单工作流步骤启动文档服务、与Adobe Sign签名工作流程集成以及执行其他AEM表单操作。 您需要 [AEM Forms Add-on](https://www.adobe.com/go/learn_aemforms_documentation_63) ，才能在工作流中使用这些步骤。

## Assign task step {#assign-task-step}

分配任务步骤将创建一个任务并将其分配给用户或用户组。 除了指定任务，组件还为任务指定自适应表单或非交互式PDF。 自适应表单必须接受用户的输入，非交互式PDF或只读自适应表单用于仅审阅工作流。

您还可以使用组件控制任务的行为。 例如，创建自动记录文档，将任务分配给特定用户或用户组，指定提交数据的路径，指定要预填充的数据路径，以及指定默认操作。 分配任务步骤具有以下属性：

* **** 标题：任务的标题。 标题将显示在AEM收件箱中。
* **** 说明：任务中执行的操作的说明。 当您在共享开发环境中工作时，此信息对于其他流程开发人员很有用。

* **** 缩略图路径：任务缩略图的路径。 如果未指定路径，则显示自适应表单默认缩略图，而记录文档则显示默认图标。
* **** 工作流阶段：一个工作流可以具有多个阶段。 这些阶段显示在AEM收件箱中。 您可以在模型的属性（Sidekick >页面>页面属性>阶段）中定义这些阶段。
* **** 优先级：选定的优先级会显示在AEM收件箱中。 可用选项有“高”、“中”和“低”。 默认值为“中”。
* **** 到期日：指定任务标记为过期的天数或小时数。 如果选择“关 **闭**”，则任务从未标记为过期。 您还可以指定超时处理程序以在任务过期后执行特定任务。

* **** 天数：任务完成前的天数。 在将任务分配给用户后计数天数。 如果任务未完成且超出“天数”字段中指定的天数，则如果选中此选项，将在到期日期后触发超时处理程序。
* **** 小时：任务完成前的小时数。 在将任务分配给用户后，将计算小时数。 如果任务未完成，并且超出“小时”字段中指定的小时数，则如果选中此选项，则会在到期小时数后触发超时处理程序。
* **** 到期日后超时：选择此选项可启用“超时处理程序”选择字段。
* **** 超时处理程序：选择在分配任务步骤跨越到期日期时要执行的脚本。 放置在CRX-repository中 [apps]/fd/dashboard/scripts/timeoutHandler的脚本可供选择。 crx-repository中不存在指定的路径。 管理员在使用路径之前创建该路径。
* **** 在任务详细信息中突出显示最后一个任务中的操作和注释：选择此选项可显示在任务的任务详细信息部分执行的最后一个操作和收到的注释。
* **** 类型：选择启动工作流时要填写的文档类型。 您可以选择自适应表单、只读自适应表单、非交互式PDF文档、交互式通信代理UI或交互式通信Web渠道文档。
* **** 使用自适应表单：指定查找输入自适应表单的方法。 如果从类型下拉列表中选择自适应表单或只读自适应表单，则此选项可用。 您可以使用提交到工作流的自适应表单，该表单位于绝对路径中，或位于变量中的路径中。 可以使用String类型的变量指定路径。\
   您可以将多个自适应表单与工作流相关联。 因此，您可以使用可用的输入方法在运行时指定自适应表单。

* **** 使用交互式通信：指定定位输入交互式通信的方法。 您可以使用提交到工作流的交互式通信，该通信位于绝对路径中，或位于变量中的路径中。 可以使用String类型的变量指定路径。 如果从“类型”下拉列表中选择“交互式通信代理UI”或“交互式通信Web渠道文档”，则此选项可用。\
   **** 注意：您必须具有cm-agent用户和workflow-users用户组分配才能在AEM收件箱中访问Interactive Communications Agent UI。

* **自适应表单或交互式通信路径**:指定自适应表单或交互式通信的路径。 您可以使用提交到工作流的自适应表单或交互式通信（在绝对路径上可用），或从字符串数据类型变量中存储的路径检索自适应表单。
* **** 使用以下方式选择输入PDF:指定非交互式PDF文档的路径。 当您在“类型”字段中选择非交互式PDF文档时，该字段可用。 您可以使用相对于有效负荷的路径选择输入PDF，该路径保存在绝对路径中，或使用文档数据类型的变量。 例如， [Payload_Directory]/Workflow/PDF/credit-card.pdf。 crx-repository中不存在该路径。 管理员在使用路径之前创建该路径。 要使用“PDF路径”选项，您需要启用“记录文档”选项或基于表单模板的自适应表单。
* **对于完成的任务，将自适应表单渲染为**:当任务被标记为完成时，您可以将自适应表单渲染为只读自适应表单或PDF文档。 您需要启用“记录文档”选项或基于表单模板的自适应表单才能将自适应表单渲染为“记录文档”。
* **** 预填充：以下列出的字段用作任务的输入：

   * **** 使用以下方式选择输入数据文件：输入数据文件的路径(.json,. xml、.doc或表单数据模型)。 您可以使用相对于有效负荷的路径检索输入数据文件，或检索存储在文档、XML或JSON数据类型变量中的文件。 例如，该文件包含通过AEM收件箱应用程序为表单提交的数据。 示例路径是 [Payload_Directory]/workflow/data。
   * **** 使用以下方式选择输入附件：该位置的可用附件将附加到与任务关联的表单。 路径始终相对于有效负荷。 示例路径是 [Payload_Directory]/attachments/
   * **** 选择输入JSON:使用相对于有效负荷的路径或存储在文档、JSON或表单数据模型数据类型的变量中的路径选择输入JSON文件。 如果从“类型”下拉列表中选择“交互式通信代理UI”或“交互式通信Web渠道文档”，则此选项可用。
   * **** 选择自定义预填服务：选择预填服务以检索数据并预填交互式通信Web渠道文档或代理UI。

   * **** 使用上面所选交互式通信的预填服务：使用此选项可使用在“使用交互式通信”下拉列表中定义的交互式通信的预填服务。
   * **** 请求属性映射：使用“请求属性映射”部分可定 [义请求属性的名称和值](../../forms/using/work-with-form-data-model.md#bindargument)。 根据请求中指定的属性名称和值从数据源检索详细信息。 您可以使用字面值或字符串数据类型的变量定义请求属性值。\
      仅当从“类型”下拉列表中选择“交互通信代理UI”或“交互通信Web通道文档”时，预填服务和请求属性映射选项才可用。

* **** 提交的信息：以下列出的字段用作任务的输出位置：

   * **** 使用以下方式保存输出数据文件：保存数据文件(.json,. xml、.doc或表单数据模型)。 数据文件包含通过关联表单提交的信息。 您可以使用相对于有效负荷的路径保存输出数据文件，或将其存储在文档、XML或JSON数据类型的变量中。 例如， [Payload_Directory]/Workflow/data，其中数据是文件。
   * **** 保存附件：保存任务中提供的表单附件。 您可以使用相对于有效负荷的路径保存附件，或将其存储在“文档”数据类型数组的变量中。
   * **** 保存记录文档：保存记录文档文件的路径。 例如， [Payload_Directory]/DocumentofRecord/credit-card.pdf。 您可以使用相对于有效负荷的路径保存记录文档，或将其存储在文档数据类型的变量中。 如果选择“相 **对于有效负荷** ”选项，则路径字段留空时不会生成记录文档。 仅当从类型下拉列表中选择自适应表单时，此选项才可用。

   * **** 使用以下方式保存Web渠道数据：使用相对于有效负荷的路径保存Web渠道数据文件，或将其存储在文档、JSON或表单数据模型数据类型的变量中。 仅当从“类型”下拉列表中选择“交互式通信代理UI”时，此选项才可用。
   * **** 使用以下方式保存PDF文档：使用相对于有效负荷的路径保存PDF文档，或将其存储在“文档”数据类型的变量中。 仅当从“类型”下拉列表中选择“交互式通信代理UI”时，此选项才可用。
   * **** 使用以下方式保存布局模板：使用相对于有效负荷的路径保存布局模板，或将其存储在文档数据类型的变量中。 布局 [模板引用](../../forms/using/layout-design-details.md) Forms Designer创建的XDP文件。 仅当从“类型”下拉列表中选择“交互式通信代理UI”时，此选项才可用。

* **** “被分派人”>“分配”选项：指定将任务分配给用户的方法。 您可以使用参加者选择器脚本将任务动态分配给用户或用户组，或将任务分配给特定AEM用户或用户组。
* **** 参加者选择器：当在“分配选项”字段 **中选择“动态地分配给用户或用户组** ”选项时，此选项可用。 可以使用ECMAScript或服务动态选择用户或用户组。 有关详细信息，请参 [阅将工作流动态分配给用户](https://helpx.adobe.com/experience-manager/kb/HowToAssignAWorkflowDynamicallyToParticipants.html) , [以及创建自定义Adobe Experience Manager动态参与者步骤。](https://helpx.adobe.com/experience-manager/using/dynamic-steps.html)

* **** 参加者：在“参加者选择器”( **[!UICONTROL Participant Chooser]** )字段中选择 **com.adobe.granite.workflow.core.process.RandomParticipantChooser** 选项时，该字段可用。 该字段允许您为RandomParticipantChooser选项选择用户或用户组。

* **** 被分派人：在“参加者选择器”字 **[!UICONTROL 段中选择com.adobe.fd.workspace.step.service.VariableParticipantChooser]** ，该字段 **即可用** 。 该字段允许您选择字符串数据类型的变量来定义被分派人。

* **** 参数：当在“参加者选择器”字段中选择了RandomParticipantChoose脚本以外的脚本时，该字段可用。 该字段允许您为在“参加者选择器”字段中选择的脚本提供一个以逗号分隔的参数列表。

* **** 用户或用户组：任务将分配给选定的用户或用户组。 当在“分配选项”字 **段中选择“至特定用户或用户组** ”选项时， **此选项可用** 。 该字段列出工作流用户组的所有用户和用户组。\
   “用 **户”或“组** ”下拉菜单列出了登录用户有权访问的用户和组。 用户名显示取决于您是否对crx-repository中的 **用户节点** （该特定用户）具有访问权限。

* **** 通过电子邮件通知被分派人：选择此选项可向被分派人发送电子邮件通知。 这些通知在将任务分配给用户时发送。 在使用此选项之前，请从AEM Web Console启用通知。 有关分步说明，请参阅为分 [配任务步骤配置电子邮件通知](../../forms/using/aem-forms-workflow.md)

* **HTML电子邮件模板**:为通知电子邮件选择电子邮件模板。 要编辑模板，请修改crx-repository中位于/libs/fd/dashboard/templates/email/htmlEmailTemplate.txt的文件。
* **** 允许委派：AEM收件箱为已登录用户提供一个选项，以将分配的工作流委派给其他用户。 您可以在同一组内或委派给另一个组的工作流用户。 如果将任务分配给单个用户，并且选择了允许委派给被分派人组成员的选项 **** ，则无法将任务委派给其他用户或组。
* **** 共享设置：AEM收件箱提供了与其他用户共享收件箱中单个或所有任务的选项：
   * 选择“允 **许被分派人显式共享到收件箱** ”选项后，用户可以单击该任务，然后与其他AEM用户共享它。
   * 当选择“允 **许被分派人通过收件箱共享** ”选项并且用户共享其收件箱项目或允许其他用户访问其收件箱项目时，只有启用上述选项的任务才会与其他用户共享。

* **** “操作”>“默认操作”:现成的“提交”、“保存”和“重置”操作均可用。 默认情况下，所有默认操作都处于启用状态。
* **** 路由变量：路由变量的名称。 route变量捕获用户在AEM收件箱中选择的自定义操作。
* **** 路由：任务可以分支到不同的路由。 在AEM收件箱中选择该路由后，该路由将返回一个值，并根据所选路由分支工作流。 您可以将路由存储在String数据类型数组的变量中，或选择 **Literal** 以手动添加路由。

* **标题**:指定路由的标题。 它显示在AEM收件箱中。
* **珊瑚图标**:指定珊瑚图标的HTML属性。 Adobe CorelUI库提供大量触屏优先图标。 您可以选择并使用路由的图标。 它与标题一起显示在AEM收件箱中。 如果将路由存储在变量中，则路由将使用默认的“标记”珊瑚图标。
* **允许被分派人添加评论**:选择此选项可为任务启用注释。 被分派人可以在提交任务时从AEM收件箱中添加注释。
* **** 在变量中保存注释：将注释保存在字符串数据类型的变量中。 仅当您选中“允许被分派人添 **加注释”复选框时，才显示此选项** 。

* **允许被分派人向任务添加附件**:选择此选项可为任务启用附件。 被分派人可以在提交任务时从AEM收件箱中添加附件。
* **使用以下方式保存输出任务附件**:指定附件文件夹的位置。 您可以使用相对于有效负荷的路径或文档数据类型的数组变量来保存输出任务附件。 仅当您允许被分派人向任务中添加附件并从交互式表单中选择 **Adaptive Form** 、 **Read-Only或从交互式表单中****************** AdobeInteractive Form中Drop-downDropTab类型时，此选项才会显示。

>[!NOTE]
>
>在运行时使用代理UI中的“附件”选项卡将附件关联到交互式通信。 在“完成”状态中打开工作项后，关联的附件在Sidekick中显示为任务附件。

* **** 使用自定义元数据：选择此选项可启用自定义元数据字段。 自定义元数据用于电子邮件模板。
* **** 自定义元数据：为电子邮件模板选择自定义元数据。 自定义元数据位于apps/fd/dashboard/scripts/metadataScripts的crx-repository中。 crx-repository中不存在指定的路径。 管理员在使用路径之前创建该路径。 您还可以将服务用于自定义元数据。 您还可以扩展WorkitemUserMetadataService界面以提供自定义元数据。
* **显示前几步的数据**:选择此选项可启用受让人查看以前的受让人、已对任务执行的操作、已添加到任务的注释以及已完成任务的记录文档（如果有）。
* **** 显示后续步骤中的数据：选择此选项可让当前被分派人查看后续被分派人所执行的操作和添加到任务的注释。 它还允许当前被分派人查看已完成任务的记录文档（如果有）。
* **** 数据类型的可见性：默认情况下，被分派人可以查看记录文档、被分派人、所采取的操作以及之前和之后被分派人已添加的注释。 使用数据类型选项的可见性，以限制被分派人可见的数据类型。

## 发送电子邮件步骤 {#send-email-step}

使用电子邮件步骤发送电子邮件，例如，包含记录文档、自适应表单链接、交互式通信链接或附加的PDF文档的电子邮件。 “发送电子邮件”步骤支 [持HTML电子邮件](https://en.wikipedia.org/wiki/HTML_email)。 HTML电子邮件具有响应性，可根据收件人的电子邮件客户端和屏幕大小进行调整。 您可以使用HTML电子邮件模板来定义电子邮件的外观、颜色方案和行为。

电子邮件步骤使用Day CQ邮件服务发送电子邮件。 在使用电子邮件步骤之前，请确保已配 [置电子邮件](../../forms/using/aem-forms-workflow.md) 服务。 电子邮件步骤具有以下属性：

**** 标题：该步骤的标题有助于在工作流编辑器中识别该步骤。

**** 说明：当您在共享开发环境中工作时，说明对其他流程开发人员很有用。

**** 电子邮件主题：主题可以从工作流元数据中检索、手动指定或从存储在变量中的值中检索。 从以下选项中进行选择：

* **文字-** 手动指定主题。
* **从工作流元数据中检索** -从元数据属性中检索主题。
* **变量** -从字符串数据类型变量中存储的值检索主题。

**HTML电子邮件模板**:电子邮件的HTML模板。 您可以在电子邮件模板中指定变量。 电子邮件步骤会提取并显示模板中包含的所有变量以获取输入。

**** 电子邮件模板元数据：电子邮件模板变量的值可以是用户指定的值、作者或发布服务器上的资产路径、图像或工作流元数据属性。

* **** 文本：当您知道要指定的确切值时，请使用此选项。 例如， [example@example.com](mailto:example@example.com)。

* **** 工作流元数据：将要使用的值保存在工作流元数据属性中时，请使用此选项。 选择该选项后，在“工作流元数据”选项下方的空文本框中输入元数据属性名称。 例如，emailAddress。
* **** 资产URL:使用此选项可将交互式通信的网络链接嵌入到电子邮件。 选择选项后，浏览并选择要嵌入的交互式通信。 资产可以驻留在作者服务器或发布服务器上。
* **** 图像：使用此选项可在电子邮件中嵌入图像。 选择选项后，浏览并选择图像。 图像选项仅对电子邮件模板中提供的图像标记(&lt;img src=&quot;*&quot;/>)可用。

**** 发件人／收件人电子邮件地址：选择“文 **本** ”选项以手动指定电子邮件地址，或选择“从工作流中检索元数据 **** ”选项以从元数据属性中检索电子邮件地址。 您还可以为“从工作流中检索”元数据选项指定元数 **据属性数组列表** 。 选择“ **变量** ”选项，从字符串数据类型变量中存储的值中检索电子邮件地址。

**** 文件附件：位于指定位置的可用资产会附加到电子邮件中。 资产的路径可以是相对于有效负荷的路径或绝对路径的路径。 示例路径为 [Payload_Directory]/attachments/。

选择“ **变量** ”选项可检索存储在“文档”、“XML”或“JSON”数据类型变量中的文件附件。

**** 文件名：电子邮件附件文件的名称。 电子邮件步骤会将附件的原始文件名更改为指定的文件名。 可以手动指定名称，也可以从工作流元数据属性或变量中检索该名称。 如果知道 **要指定的确切值** ，请使用“文本”选项。 使用“ **变量** ”选项从字符串数据类型变量中存储的值中检索文件名。 当要使 **用的值保存在工作流元数据属性中时** ，请使用“从工作流元数据检索”选项。

## Generate Document of Record step {#generate-document-of-record-step}

填写或提交表单后，您可以以打印或文档格式保留表单的记录。 这称为记录文档(DoR)。 您可以使用“生成记录文档”步骤创建自适应表单的只读或交互式PDF版本。 PDF版本包含已填写到表单的信息以及自适应表单的布局。

记录文档步骤具有以下属性：

**使用自适应表单**:指定查找输入自适应表单的方法。 您可以使用提交到工作流的自适应表单，该表单位于绝对路径中，或位于变量中的路径中。 可以使用字符串数据类型的变量在“选择要解析的变量”字 **段中指定路径** 。\
您可以将多个自适应表单与工作流相关联。 因此，您可以使用可用的输入方法在运行时指定自适应表单。

**自适应表单路径**:指定自适应表单的路径。 当您从使用自适应表单字段 **中选择绝对路径选项** ，该字 **** 段就可用。

**** 选择输入数据：自适应表单的输入数据路径。 您可以将数据保留在相对于有效负荷的位置，指定数据的绝对路径，或检索存储在文档、JSON或XML数据类型变量中的数据。 输入数据与自适应表单合并以创建记录文档。

**** 使用以下方式选择输入附件路径：附件的路径。 这些附件包含在记录文档中。 您可以将附件保留在相对于有效负荷的位置，指定附件的绝对路径，或检索存储在文档数据类型数组变量中的附件。

如果指定文件夹（例如附件）的路径，则文件夹中直接可用的所有文件都将附加到记录文档。 如果指定的附件路径中直接可用的文件夹中有任何文件，则这些文件将作为附件包含在记录文档中。 如果直接可用的文件夹中存在任何文件夹，则跳过这些文件夹。

**** 使用以下选项保存生成的记录文档：指定保存记录文档的位置。 您可以选择覆盖有效负荷文件夹，将记录文档放在有效负荷目录内的某个位置，或将记录文档存储在文档数据类型的变量中。

**区域设置**:指定记录文档的语言。 选择 **文本** ，从下拉列表中选择区域设置，或选择变量 **** ，从字符串数据类型变量中存储的值检索区域设置。 在变量中存储区域设置的值时，必须定义区域设置代码。 例如，指定 **en_US表示英语** ，指定 **fr_FR表示法语** 。

## Invoke Form Data Model Service step {#invoke-form-data-model-service-step}

您可以使用 [AEM Forms Data Integration](../../forms/using/data-integration.md) （AEM表单数据集成）配置和连接到不同的数据源。 这些数据源可以是数据库、Web服务、REST服务、OData服务和CRM解决方案。 AEM Forms Data Integration允许您创建包含各种服务的表单数据模型，以对已配置的数据库执行数据检索、添加和更新操作。 您可以使用调 **用数据模型服务步骤来选择表单数据模型** (FDM)，并使用FDM的服务来检索、更新数据或将数据添加到不同的数据源。

要说明步骤字段的输入，请以下数据库表和JSON文件为例：

**示例CustomerDetails表**

<table>
 <tbody> 
  <tr> 
   <td>属性</td> 
   <td>值<br /> </td> 
  </tr> 
  <tr> 
   <td>名字<br /> </td> 
   <td>Sarah<br /> </td> 
  </tr> 
  <tr> 
   <td>姓氏</td> 
   <td>玫瑰</td> 
  </tr> 
  <tr> 
   <td>客户ID</td> 
   <td>1</td> 
  </tr> 
  <tr> 
   <td>电子邮件地址<br /> </td> 
   <td>srose@we.info</td> 
  </tr> 
 </tbody> 
</table>

**示例JSON文件**

```
{ 
  customer: { 
   firstName: "Sarah", 
   lastName:"Rose", 
   customerId: "1", 
   emailAddress:"srose@we.info" 
 }, 
  insurance: {
   customerId: "1", 
  policyType: "Premium,
  policyNumber: "Premium-521499",
  customerDetails: { 
   firstName: "Sarah",
   lastName: "Rose",
   customerId: "1",
   emailAddress: "srose@we.info" 
  }
 }
}
```

“调用表单数据模型服务”步骤包含以下列出的字段，以便于表单数据模型操作：

* **** 标题：步骤的标题。 它有助于在工作流编辑器中识别该步骤。
* **** 说明：当您在共享开发环境中工作时，对其他流程开发人员有用的说明。

* **表单数据模型路径**:浏览并选择服务器上存在的表单数据模型。

* **服务**:所选表单数据模型提供的服务列表。
* **“服务输入”>“使用文本、变量或工作流元数据以及JSON文件提供输入数据”**:一个服务可以有多个参数。 选择此选项，以从工作流元数据属性、JSON对象、变量中获取服务参数的值，或直接在提供的文本框中输入值：

   * **** 文本：当您知道要指定的确切值时，请使用此选项。 例如，srose@we.info。
   * **** 变量：使用此选项可检索变量中存储的值。
   * **** 从工作流元数据中检索：将要使用的值保存在工作流元数据属性中时，请使用此选项。 例如，emailAddress。
   * **** JSON点表示法：当要使用的值在JSON文件中时，请使用此选项。 例如，insurance.customerDetails.emailAddress。 “JSON点表示法”选项仅在选择“映射输入JSON的输入字段”选项时可用。
   * **** 映射输入JSON中的输入字段：指定JSON文件的路径，以从JSON文件获取某些服务参数的输入值。 JSON文件的路径可以是相对于有效负荷、绝对路径的路径，也可以使用JSON或表单数据模型类型的变量选择输入JSON文档。

* **** 服务输入>使用变量或JSON文件提供输入数据：选择此选项，从保存在绝对路径、相对于有效负荷的路径或变量中的JSON文件中获取所有参数的值。
* **使用以下方式选择“输入JSON文档**”:包含所有服务参数的值的JSON文件。 JSON文件的路径可以是相 **对于有效负荷的** ，也可以是 **绝对路径。** 您还可以使用JSON或表单数据模型数据类型的变量检索输入JSON文档。

* **** JSON点表示法：将该字段留空可将指定JSON文件的所有对象用作服务参数的输入。 要从指定的JSON文件中读取特定JSON对象作为服务参数的输入，请为JSON对象指定点记号，例如，如果您的JSON与章节开头列出的JSON类似，请指定insurance.customerDetails以提供客户的所有详细信息作为服务的输入。
* **** “服务输出”>“将输出值映射并写入变量或元数据：选择此选项，将输出值另存为crx-repository中工作流实例元数据节点的属性。 指定元数据属性的名称并选择要与元数据属性映射的相应服务输出属性，例如，将输出服务返回的phone_number与工作流元数据的phone_number属性进行映射。 同样，您可以将输出存储在长数据类型的变量中。
* **** 服务输出>将输出保存到变量或JSON文件：选择此选项，将输出值保存在JSON文件中的绝对路径、相对于有效负荷的路径或变量中。
* **** 使用以下选项保存输出JSON文档：保存输出JSON文件。 输出JSON文件的路径可以是相对于有效负荷的路径，也可以是绝对路径。 您还可以使用JSON或表单数据模型数据类型的变量保存输出JSON文件。

## 签署文档步骤 {#sign-document-step}

通过“签名文档”步骤，您可以使用Adobe sign对文档进行签名。 “签名文档”步骤具有以下属性：

* **** 协议名称：指定协议的标题。 协议名称将成为发送给签署方的电子邮件的主题和正文文本的一部分。 您可以将名称存储在String数据类型的变量中，或选择 **Literal** ，手动添加该名称。

* **** 区域设置：指定电子邮件和验证选项的语言。 您可以将区域设置存储在String数据类型的变量中，或选择 **Literal** ，从可用选项列表中选择区域设置。 在变量中存储区域设置的值时，必须定义区域设置代码。 例如，指定 **en_US表示英语** ，指定 **fr_FR表示法语** 。

* **Adobe Sign云配置**:选择Adobe Sign云配置。 如果尚未为AEM Forms配置Adobe Sign，请参阅将Adobe Sign [与AEM Forms集成](../../forms/using/adobe-sign-integration-adaptive-forms.md)。

* **** 使用以下方式选择要签名的文档：您可以从相对于有效负荷的位置选择文档，使用有效负荷作为文档，指定文档的绝对路径，或检索存储在文档数据类型变量中的文档。
* **** 截止日期前的天数：在“截止日期前的天数”字段中指定的天数内，任务上没有任何活动，此时文档将被标记为到期( **已过期** )。 在将记录的天数分配给用户进行签名后计数。
* **** 提醒电子邮件频率：您可以按每日或每周间隔发送提醒电子邮件。 从将记录的日期分配给用户进行签名之日起算该周。
* **** 签名过程：您可以选择按顺序或并行顺序对文档进行签名。 按顺序，一个签署方一次接收文档进行签名。 在第一个签署方完成对文档的签名后，文档将发送给第二个签署方，依此类推。 同时，多个签名者可以一次对文档进行签名。
* **** 重定向URL:指定重定向URL。 在文档签名后，您可以将被分派人重定向到URL。 通常，此URL包含感谢信或进一步说明。
* **** 工作流阶段：一个工作流可以具有多个阶段。 这些阶段显示在AEM收件箱中。 您可以在模型的属性（Sidekick >页面>页面属性>阶段）中定义这些阶段。
* **** 选择签名者：指定为文档选择签名者的方法。 您可以将工作流动态分配给用户或用户组，或手动添加签名者的详细信息。
* **** 用于选择签名者的脚本或服务：仅当在“选择签名者”字段中选择“动态”选项时，此选项才可用。 可以指定ECMAScript或服务来为文档选择签名者和验证选项。
* **** 签署方详细信息：仅当在“选择签名者”字段中选择“手动”选项时，此选项才可用。 指定电子邮件地址并选择可选的验证机制。 在选择两步验证机制之前，请确保为已配置的Adobe sign帐户启用相应的验证选项。 您可以使用字符串数据类型的变量来定义“电子邮 **[!UICONTROL 件]**”、“国 **[!UICONTROL 家代码]**”和“ **[!UICONTROL 电话号码]** ”字段的值。 仅当 **[!UICONTROL 您从]** 2步验证下拉列表中选择“电话验证 **[!UICONTROL ”时，才会显示“国家／地区代码”]********** 和“电话号码”字段。
* **** 状态变量：启用Adobe sign的文档将文档的签名状态存储在字符串数据类型的变量中。 指定状态变量的名称(adobeSignStatus)。 在CRXDE中，实例的状态变量位于/etc/workflow/instances/&lt;server>/&lt;date-time>/&lt;工作流模型实例>/workItems/&lt;node>/metaData包含变量的状态。
* **** 使用以下选项保存已签名文档：指定保留已签名文档的位置。 您可以选择覆盖有效负荷文件，将已签名文档放在有效负荷目录中的某个位置，或将已签名文档存储在文档类型的变量中。

## 文档服务步骤 {#document-services-steps}

AEM文档服务是用于创建、组合和保护PDF文档的一组服务。 AEM Forms为每个文档服务提供单独的AEM工作流步骤。

与其他AEM Forms工作流步骤（如分配任务、发送电子邮件和签署文档）类似，您可以在所有AEM Document服务步骤中使用变量。 有关创建和管理变量的详细信息，请参阅AEM工 [作流中的变量](../../forms/using/variable-in-aem-workflows.md)。

### Apply Document Time Stamp step {#apply-document-time-stamp-step}

为文档添加时间戳。 您提供文档详细信息，如输入文档路径、输入文档名称、存储导出数据的位置。 您可以选择覆盖现有的有效负荷文件，选择其他文件名以将数据存储在有效负荷文件夹下的其他文件中，提供数据的绝对路径，或将数据存储在文档数据类型的变量中。

### 转换为图像步骤 {#convert-to-image-step}

将PDF文档转换为图像列表。 支持的图像格式为JPEG、JPEG2000、PNG和TIFF。 以下信息适用于TIFF图像的转换：

* 将生成多页TIFF文件。
* TIFF图像中不包含某些注释。 不包括需要Acrobat生成外观的注释。

### Convert to PDF/A step {#convert-to-pdf-a-step}

使用提供的选项将PDF文档转换为PDF/A格式。 PDF/A版本的可移植文档格式(PDF)专门用于文档的存档和长期保存。

### 转换为PS步骤 {#convert-to-ps-step}

将PDF文档转换为PostScript。 转换为PostScript时，可以使用转换操作指定源文档以及是转换为PostScript级别2还是3。 转换为PostScript文件的PDF文档必须是非交互式的。

### Create PDF from specified type step {#create-pdf-from-specified-type-step}

从输入文件生成PDF文档。 输入文档可以是相对于有效负荷的，具有绝对路径，可以是有效负荷本身，或者存储在文档数据类型的变量中。

### Create PDF from URL/HTML/ZIP step {#create-pdf-from-url-html-zip-step}

从提供的URL、HTML和ZIP文件生成PDF文档。

### 导出数据步骤 {#export-data-step}

从PDF表单或XDP文件导出数据。 它要求您输入“输入文档”的文件路径和“导出数据格式”。 “导出数据格式”的选项有“自动”、“XDP”和“XmlData”。

### Export PDF to specified type step {#export-pdf-to-specified-type-step}

将PDF文档转换为选定格式。

### 生成非交互式PDF步骤 {#generatenoninteractive}

生成非交互式PDF。 它提供各种自定义选项。

>[!NOTE]
>
>您可以使用变量为输入文档指定模板文件。 将模板文件的路径存储在字符串数据类型的变量中。

### 导入数据步骤 {#import-data-step}

将表单数据合并到PDF表单中。 可以将表单数据导入PDF表单。

### 调用DDX步骤 {#invokeddx}

在指定的输入文档映射上执行DDX文件，并返回处理过的PDF文档。

>[!NOTE]
>
>您可以使用变量为输入文档指定DDX文件。 将DDX文件存储在Document或XML数据类型的变量中。

### 优化PDF步骤 {#optimize-pdf-step}

通过减小PDF文件的大小来优化PDF文件。 此转换的结果是可能小于其原始版本的PDF文件。 此操作还会将PDF文档转换为优化参数中指定的PDF版本。

优化设置指定如何优化文件。 以下是示例设置：

* 目标PDF版本
* 放弃JavaScript动作和嵌入的页面缩略图等对象
* 放弃用户数据，如注释和文件附件
* 放弃无效或未使用的设置
* 压缩未压缩的数据或使用更高效的压缩算法
* 删除嵌入的字体
* 设置透明度值

### 渲染PDF表单步骤 {#renderpdf}

将在表单设计器(XDP)中创建的表单渲染为PDF表单。

>[!NOTE]
>
>您可以使用变量为输入文档指定模板文件。 将模板文件的路径存储在字符串数据类型的变量中。

### 保护文档步骤 {#secure-document-step}

加密、签署和验证文档。 AEM Forms支持基于口令的加密和基于证书的加密。 您还可以选择对文档进行签名的各种算法。 例如，SHA-256和SH-512。 您还可以使用工作流步骤来阅读器扩展PDF文档。 工作流步骤提供了启用条形码解码、数字签名、PDF数据导入和导出等选项的选项。

### 发送到打印机步骤 {#send-to-printer-step}

将文档直接发送到打印机。 它支持以下打印访问机制：

* **可直接访问的打印机**:安装在同一台计算机上的打印机称为可直接访问的打印机，该计算机名为打印机主机。 此类型的打印机可以是直接连接到计算机的本地打印机。
* **间接可访问的打印机**:打印服务器上安装的打印机可从其他计算机访问。 通用的UNIX®打印系统(CUPS)和线路打印机守护程序(LPD)协议等技术可用于连接到网络打印机。 要访问间接可访问的打印机，请指定打印服务器的IP或主机名。 使用此机制，当网络运行LPD时，可以将文档发送到LPD URI。 该机制允许您将文档路由到任何连接到运行LPD的网络的打印机。

