---
title: ' [!DNL Adobe Experience Manager] 6.5 发行说明'
description: 查找  [!DNL Adobe Experience Manager] 6.5 的版本信息、新增功能、安装操作方法和详细更改列表。
mini-toc-levels: 4
solution: Experience Manager
feature: Release Information
role: User,Admin,Developer
exl-id: a52311b9-ed7a-432e-8f35-d045c0d8ea4c
source-git-commit: c77849740fab51377ce60aff5f611e0408dca728
workflow-type: tm+mt
source-wordcount: '4554'
ht-degree: 100%

---

# [!DNL Adobe Experience Manager] 6.5.21.0 {#aem-service-pack-release-notes}

<!-- For an itemized list of all issues found in this release information, see the following spreadsheet: https://adobe-my.sharepoint.com/:x:/r/personal/anujkapo_adobe_com/_layouts/15/Doc.aspx?sourcedoc=%7B3ea81ae4-e605-4153-b132-f2698c86f84e%7D&action=edit&wdinitialsession=d8c7b903-87fc-4f2d-9ef2-542a82169570&wdrldsc=3&wdrldc=1&wdrldr=SessionMemoryQuotaExceededDuringSession -->

<!-- DO NOT DELETE THIS HIDDEN NOTE      DO NOT DELETE THIS HIDDEN NOTE
>[!NOTE]
>
>Fixes in [!DNL Experience Manager] Forms are delivered through a separate add-on package one week after the scheduled [!DNL Experience Manager] Service Pack release date. In this case, the add-on packages release Thursday, November 30, 2023. In addition, a list of Forms fixes and enhancements is added to this section. -->

## 发行版信息 {#release-information}

| 产品 | [!DNL Adobe Experience Manager] 6.5 |
| -------- | ---------------------------- |
| 版本 | 6.5.21.0 <!-- UPDATE FOR EACH NEW RELEASE --> |
| 类型 | 服务包发行 |
| 日期 | 2024 年 6 月 6 日星期四 <!-- UPDATE FOR EACH NEW RELEASE --> |
| 下载 URL | [软件分发](https://experience.adobe.com/#/downloads/content/software-distribution/en/aem.html?package=/content/software-distribution/en/details.html/content/dam/aem/public/adobe/packages/cq650/servicepack/aem-service-pkg-6.5.21.0.zip) <!-- UPDATE FOR EACH NEW RELEASE --> |

## [!DNL Experience Manager] 6.5.21.0 的内容 {#what-is-included-in-aem-6521}

[!DNL Experience Manager] 6.5.21.0 包含新功能、客户重点要求的增强功能以及错误修复。还包括自 2019 年 4 月 6.5 首次发布以来推出的在性能、稳定性和安全性方面的改进。[在 [!DNL Experience Manager] 6.5 上安装此服务包](#install)。

<!-- UPDATE FOR EACH NEW RELEASE -->

## 主要功能和增强功能

<!-- * _6.5.21.0 REVIEWERS: WHAT ARE THE KEY FEATURES AND ENHANCEMENTS THAT YOU WANT TO HIGHLIGHT IN THIS RELEASE?_ -->

### [!DNL Forms]

本次版本中的部分主要功能和增强功能包括：

* **支持 Oauth 凭据**：提供一种全新且更易用的凭据，用于服务器间身份验证，以取代现有的服务帐户（JWT）凭据。（NPR-41994）
* [AEM Forms 中的规则编辑器增强功能](/help/forms/using/rule-editor-core-components.md)：
   * 支持使用 `When-then-else` 功能实施嵌套条件。
   * 验证或重置面板和表单（包括字段）。
   * 在自定义函数中支持现代 JavaScript 特性，如 let 和箭头函数（支持 ES10）。
* [适用于 PDF 辅助功能的 AutoTag API](/help/forms/using/aem-document-services-programmatically.md#doc-utility-services-doc-utility-services)：OSGi 上的 AEM Forms 现已支持新的 AutoTag API，可通过添加段落和列表等标记来增强 PDF 的无障碍标准。此功能可让使用辅助技术的用户更方便地访问 PDF。
* **16 位 PNG 支持**：PDF Generator 的 ImageToPdf 服务现已支持将具有 16 位色深的 PNG 转化为 PDF。
* **将工件应用于 XDP 中的单个文本块**：Forms Designer 现在允许用户在 XDP 文件中的单个文本块上配置设置。通过此功能，您可以控制在生成的 PDF 中哪些元素会被视为工件。这些元素（如页眉和页脚）可供辅助技术访问，从而提升无障碍性。主要功能包括：可将文本块标记为工件，并将这些设置嵌入到 XDP 元数据中。表单输出服务会在生成 PDF 时应用这些设置，以确保正确的 PDF/UA 标记。
* **AEM Forms Designer 已通过 `GB18030:2022` 标准认证**：凭借 `GB18030:2022` 认证，Forms Designer 现已支持中文 Unicode 字符集，允许您在所有可编辑字段和对话框中输入中文字符。
* [在 JEE 服务器中支持 WebToPDF 路由](/help/forms/using/admin-help/configure-service-settings.md#generate-pdf-service-settings-generate-pdf-service-settings)：PDF Generator 服务现已支持 WebToPDF 路由，可在 JEE 上将 HTML 文件转化为 PDF 文档，除此之外还支持现有的 Webkit 和 WebCapture（仅限 Windows）路由。此前 WebToPDF 路由已在 OSGi 上提供，并扩展到 JEE。现在，在 JEE 和 OSGi 平台上，PDF Generator 服务均支持以下跨不同操作系统的路由：
   * **Windows**：Webkit、WebCapture、WebToPDF
   * **Linux®**：Webkit、WebToPDF

### [!DNL Assets]

#### 增强功能

本次版本中包含的增强功能如下：

* IPTC 选项卡现已支持[!UICONTROL 替代文本]和[!UICONTROL 扩展描述]文本字段。（ASSETS-34918）

#### 辅助功能修复

以下是本次版本中包含的辅助功能修复列表：

* 如果资产的处理状态为“失败”或“元数据失败”，则字幕和音轨界面无法正常工作。（ASSETS-37281）
* 当您保存资产元数据并尝试编辑时，语言名称不会显示。（ASSETS-37281）

<!-- ### [!DNL Forms]
* A -->

<!-- UPDATE BELOW FOR EACH NEW RELEASE -->

## 服务包 21 中已修复的问题 {#fixed-issues}

### [!DNL Sites]{#sites-6521}

#### 辅助功能 {#sites-accessibility-6521}

* **[!UICONTROL 已保存的搜索]**&#x200B;标签不会持久显示。文本字段仅使用占位符作为唯一的可见标签。（SITES-3050）

#### 管理用户界面{#sites-adminui-6521}

* 当您点击 **[!UICONTROL Sites]** > **[!UICONTROL 核心组件]** > **[!UICONTROL 属性]** > **[!UICONTROL 权限]**&#x200B;选项卡 > **[!UICONTROL 生效权限]**，**生效权限**&#x200B;对话框无法打开。（SITES-17378）

<!-- #### Classic UI{#sites-classicui-6521} 

* A -->

#### [!DNL Content Fragments]{#sites-contentfragments-6521}

* 修复了表单元素被重复包含的问题。（SITES-21109）
* 在创建内容片段时，“关闭”按钮有时无响应，导致整个页面冻结，必须刷新页面才能关闭内容片段。关于版本创建问题，系统会为内容片段创建一个新版本。即使用户没有进行任何更改，仅仅是与 RTE 或文本字段交互，也会出现此问题。（SITES-21187）

#### [!DNL Content Fragments] - GraphQL API {#sites-graphql-api-6521}

* 在将 Adobe Experience Manager 从 6.5.19.0 升级到 6.5.20.0 时，路径 `/libs/cq/graphql/sites/graphiql` 会删除。（SITES-20098）

<!-- #### [!DNL Content Fragments] - GraphQL Query Editor{#sites-graphql-query-editor-6521}

* W -->

<!-- #### [!DNL Content Fragments] - REST API{#sites-restapi-6521}

* W -->

<!-- #### Core Backend{#sites-core-backend-6521}

* W -->

<!-- #### Core Components{#sites-core-components-6521}

* I -->

<!-- #### Campaign integration{#sites-campaign-integration-6521}

* A -->

#### 体验片段{#sites-experiencefragments-6521}

* 从 `masters/language` 向 `country/language` 转出体验片段时，交叉引用未被更新。（SITES-21172）
* 在创建新体验片段时，不仅会显示在 `cq:allowedTemplates` 中指定的模板，还会显示在模板级别配置了 `allowedPaths` 的模板。（SITES-20855）

<!-- #### Foundation Components (Legacy){#sites-foundation-components-legacy-6521}

* T -->

<!-- #### Launches{#sites-launches-6521} -->


<!-- ### [!DNL Forms]-->

<!-- DELETED MAY 22, 2024 FROM TOTAL RELEASE CANDIDATE ISSUES * The `sourceRootResource` configured in the Launch configuration within CRXDE Lite points to content that no longer exists, leading to a malfunction when attempts are made to delete launches. Delete launches even if the page is deleted or if the path is not the same. (SITES-20750) -->


#### MSM - Live Copy {#sites-msm-live-copies-6521}

* 通过覆盖页面组件在页面属性中添加选项卡。其中一个选项卡是页面配置，包含用于添加体验片段 URL 的属性。在页面属性中为体验片段配置的链接不会随为该页面创建的任何语言副本而变化。配置的链接应随语言副本的 URL 一同更新。（SITES-19580）

#### 页面编辑器{#sites-pageeditor-6521}

* 编辑模式下灰色背景的应用不一致，未能符合 WCAG（Web 内容无障碍指南）的颜色对比度标准。（SITES-20060）

### [!DNL Assets]{#assets-6521}

* 如果将资产发布到 Brand Portal，发布状态会保持不一致。（ASSETS-36807）
* 当您使用 API 调用从实例中删除资产时，这些资产并未被删除。（ASSETS-35131）
* 当您尝试导入元数据时，除英语以外的任何语言字符都会被替换为 `question mark (?)`。（ASSETS-35091）
* 在安装服务包 6.5.19 后，当 `dc:title` 属性与数据类型字符串一起使用时，资产内容树无法正常工作。（ASSETS-34684）
* 如果资产名称中包含特殊字符，则会显示错误。（ASSETS-33248）

#### [!DNL Dynamic Media]{#assets-dm-6521}

* 在 AEM 6.5.18 中，编辑热点时不会显示已添加到资产的所有热点。但是，在已发布的资产中所有热点均可正常工作，但之后若需要则无法再次编辑这些热点。（ASSETS-33609）
* 最新上传的 EPS 文件在重新处理后未生成缩略图。（ASSETS-32617）
* 在“工具 > 资产 > Dynamic Media 发布设置 > 请求属性”选项卡中，输入项 `Width(px)` 和 `Height(px)` 在西班牙语、意大利语和葡萄牙语界面下显示不同。在这些语言环境中，它们彼此未对齐。（ASSETS-31896）
* 自 2024 年 5 月 1 日起，Adobe Dynamic Media 停止对以下功能提供支持：
   * SSL（安全套接字层）2.0
   * SSL 3.0
   * TLS（传输层安全性）1.0 和 1.1
   * TLS 1.2 中的以下弱密码：
      * `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384`
      * `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA`
      * `TLS_RSA_WITH_AES_256_GCM_SHA384`
      * `TLS_RSA_WITH_AES_256_CBC_SHA256`
      * `TLS_RSA_WITH_AES_256_CBC_SHA`
      * `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256`
      * `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA`
      * `TLS_RSA_WITH_AES_128_GCM_SHA256`
      * `TLS_RSA_WITH_AES_128_CBC_SHA256`
      * `TLS_RSA_WITH_AES_128_CBC_SHA`
      * `TLS_RSA_WITH_CAMELLIA_256_CBC_SHA`
      * `TLS_RSA_WITH_CAMELLIA_128_CBC_SHA`
      * `TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA`
      * `TLS_RSA_WITH_SDES_EDE_CBC_SHA`

### [!DNL Forms]{#forms-6521}

#### [!DNL Adaptive Forms] {#forms-6520}

* 当从 Adobe Experience Manager 发布实例将自适应表单提交到 Adobe Experience Manager 工作流时，该工作流无法保存附件。（FORMS-14209）
* 在 OSGi 上的 AEM Forms 服务包 15（6.5.15.0）中，当用户点击&#x200B;**打印为 PDF**&#x200B;时，客户端验证失败，开发者工具控制台窗口中会显示错误消息。（FORMS-14029）
* 在 AEM 6.5 Forms 服务包 17（6.5.17.0）、服务包 18（6.5.18.0）或服务包 19（6.5.19.0）中，当用户提交表单时，“感谢”消息的翻译无法正常工作。但是，这些消息在字典中已被正确翻译。（FORMS-13846）
* 当用户预览包含日期选择器组件的表单时，日期选择器字段与其他表单字段未对齐。（FORMS-13763）
* 在 AEM Forms 服务包 19（6.5.19.0）环境中，当用户通过调用 API 来格式化数字时，格式化后的数字未与相应的区域设置对齐。因此，货币符号无法正确显示。无论区域设置参数设置为 &quot;de_DE&quot; 还是 &quot;en_US&quot;，此问题都会持续存在。（FORMS-13759）
* 在 AEM Forms 服务包 19（6.5.19.0）环境中，用户使用 Img2Pdf PDFG 服务将 16 位 PNG 转化为 PDF 时失败，且无法“使用 Acrobat 图像转化”服务。（FORMS-13754）
* 在 AEM Forms 服务包 19（6.5.19.1）中，当用户在 AEM Forms JEE 的 adminui 界面的 Services / PDF Generator / Adobe PDF Settings 部分上传现有的 JobOptions 文件时，上传失败。它还会显示以下错误消息（FORMS-13597）：
  `"An error has occurred while processing your request. Please use the breadcrumb links to navigate to another page."`
* 当用户从 AEM Forms 服务包 15（6.5.15.0）迁移到 AEM Forms 服务包（6.5.17.0）或 AEM Forms 服务包（6.5.19.0）时，FD 键会出现重复，导致表单无法正确翻译。（FORMS-13461）
* 当用户在 AMS 部署拓扑支持的作者节点前放置 Dispatcher 时，分配任务的提交流程会卡住或失败。（FORMS-8010）
* 与辅助功能相关的修复：
   * “formsanddocuments” 页面上的图标现已符合 ANDI 标准的无障碍要求。（FORMS-13094）
   * 用户现在可以通过键盘访问工具栏，以在编辑页面上保存或编辑内容，工具栏已根据 ANDI 标准进行增强。（FORMS-13102）
   * “必填”表单字段现已符合 ANDI 标准的无障碍要求。（FORMS-13097）

* 当用户在页面加载时尝试查看表单时，表单无法渲染。（FORMS-13594）
* 在 Microsoft Edge 的 Internet Explorer 兼容模式下，日期输入字段组件无法正常工作。（FORMS-13170）
* 当在服务器上对[使用带附件电子邮件的附加步骤](https://experienceleague.adobe.com/zh-hans/docs/experience-manager-65/content/forms/troubleshooting/additional-steps-to-use-email-with-attachments)进行修复时，包含附件的电子邮件通知会停滞并无法发送。（FORMS-14227）
* 在服务包 18（6.5.18.0）的 AEM Forms 工作区中，当用户对任意已上传文档发表评论时，会导致该文档文件损坏。（FORMS-13735）
* 在 AEM Forms 服务包 18（6.5.18.0）、服务包 19（6.5.19.0）或服务包 20（6.5.20.0）中，当用户尝试从侧边面板搜索自适应表单时，搜索会失败。（FORMS-14117）
* 当用户编辑一份用德语创建并翻译为英语的表单时，会导致“预览”和“编辑”模式之间的语言显示不一致。在“编辑”模式下，单选按钮和复选框组件会显示为英文，而在“预览”模式下则正确显示为德文。（FORMS-13910）
* 流程清理工具执行失败，并报错 `NoClassDefFoundError: org/omg/CORBA/UserException`。（FORMS-13751）
* 当用户使用嵌入容器将自适应表单（AF）嵌入到网页（无论是外部网页还是 AEM Sites 页面）时，自适应表单引导容器会引入一个 ARIA 标签。该标签为嵌入表单设置了 role=&quot;main&quot;。根据 ARIA 指南，每个页面只能有一个 role=&quot;main&quot;。因此，当用户为页面的主要内容添加另一个 role=&quot;main&quot; 时，就会被标记为辅助功能问题。（FORMS-13538）
* 在 AEM Forms 服务包 19（6.5.19.0）中，当在自适应表单中使用下拉列表时，带有占位符文本的下拉列表会保留 `id="emptyValue"` 的值。因此，如果一个表单包含多个下拉组件，每个组件都会具有 `id="emptyValue"`，这不符合 ARIA 指南的要求。（FORMS-13370）
* 当用户在通过 XML 提交数据后重新加载交互式通信时，生成的 PDF 内的文本块之间会出现空白。（FORMS-13481）
* 在运行 ConfigurationManager 时，“准备 DSC 部署步骤”界面缺少 IPH。（FORMS-10699）
* 当用户在已有字典的基础上添加新字典以翻译表单时，旧的翻译会失效。出现以下问题：（FORMS-13576）
   * 部分字段未能填充翻译后的数据。
   * 部分字段未被翻译为新语言，尽管数据已成功保存到字典中。

#### [!DNL Forms Designer] {#forms-desgner-6521}

* 当用户在 AEM Forms 服务包 19（6.5.19.0）环境中使用 AEM Forms Designer 向现有表单添加新表格时，系统会崩溃。（LC-3921978）
* 当用户在 Linux® 环境中渲染自适应表单时，字段组件之间会出现额外空白。（LC-3921957）
* 当用户使用输出服务将 XTG 文件转化为 PostScript 格式时，操作失败并出现以下错误：           `(AEM_OUT_001_003:Unexpected Exception: PAExecute Failure: XFA_RENDER_FAILURE)`。（LC-3921720）

  解决此问题的方法：
请检查数据中是否包含特殊字符，如零宽空格（0x200b）。如果存在，请在 XCI 文件中添加以下标记以启用该标志：`<behaviorOverride>patch-LC3921720:1</behaviorOverride>`。示例可参考 [custom_xfa.xci](/help/forms/using/assets/custom_xfa.xci) 文件。

* 在 Linux® 环境中使用 AEM Forms 服务包 18（6.5.18.0）时，如果 AMD® 处理器的 CPU 不支持 AVX / AVX2 指令，XMLFM 会发生崩溃。（LC-3921718）
* 当用户使用表单输出服务从 XDP 生成 PDF 时，无法在 XDP 中针对“单个文本块”配置“设置”，以控制哪些内容被标记为“工件”。（LC-3921954）

<!--
Fixes in [!DNL Experience Manager] Forms are delivered through a separate add-on package one week after the scheduled [!DNL Experience Manager] Service Pack release date. In this case, the AEM 6.5.21.0 Forms add-on package release is scheduled for Thursday, June 13, 2024. A list of Forms fixes and enhancements is added to this section post the release.

-->


<!-- #### [!DNL Adaptive Forms]

* THIS BUG WAS ALREADY REPORTED IN THE 6.5.20.0 RELEASE NOTES. IS IT NEEDED AGAIN IN THE 6.5.21.0 RELEASE NOTES? (AEM Forms on JEE Only) The PDF Generator service fails to enumerate the fonts available on the server. Consequently, the font selection panel on the Adobe PDF Settings page in the PDFG Admin UI remains empty, effectively preventing (un)embedding of chosen fonts. (FORMS-12095) -->


<!-- #### [!DNL Forms Designer] {#forms-designer-6521}

* W -->

### 基础 {#foundation-6521}

#### Apache Felix {#foundation-apachefelix-6521}


* 在 AEM 6.5 服务包 19（SP19）中出现升级问题：安装 SP19 后，对 Apache Felix 的未授权请求缺少应用程序服务器 context-root 路径。更新至 Apache Felix Web Management Console 4.9.8。（NPR-41933）

#### 营销活动{#foundation-campaign-6521}

* AEM 6.5 服务包 15 会持续生成包含大量条目的错误日志。报告的问题如下：
   * 在路径 `/libs/granite/ui/content/shell/start.html` 处缺少资源，导致出现 404 INFO 错误
   * 错误日志中记录了一条未捕获的 SlingException，原因是 `CampaignsDataSourceServlet.java:147` 处发生 `NullPointerException`

  错误日志不应充斥频繁且大量的错误条目；AEM 实例应能正常运行，不应出现与资源缺失或异常相关的问题。（CQ-4357064）

#### 云服务{#foundation-cloudservices-6521}

* 从 AEM 云服务中移除 Google Guava。（CQ-4356436）

<!-- #### Communities {#foundation-communities-6521}

* U -->


<!-- #### Content distribution{#foundation-content-distribution-6521}

* T -->

#### Granite{#foundation-granite-6521}

* 在配置浏览器中，如果没有&#x200B;**浏览**&#x200B;权限，则无法选择&#x200B;**删除**&#x200B;或&#x200B;**修改**。（GRANITE-51002）

#### 集成{#foundation-integrations-6521}

* 关于 `cq-target-integration`，需要移除 Google Guava 在非测试场景下的使用。（CQ-4357101）
* 将服务帐号（JSON Web Token 或 JWT）凭据替换为 OAuth2 服务器到服务器凭据（也称为 Service Principals）。（NPR-41994）
* 在 IMS（Identity Management System）配置下，创建受众请求失败。（NPR-41888）
* 当客户尝试查看负载页面时，由于 URL 格式错误，内容无法正确显示，并出现 404 错误。出现该错误的原因是 URL 中在查询参数前缺少问号符号。受该问题影响，用户必须插入问号符号，才能正确查看负载页面。（NPR-41957）
* 对于从 AEM 6.5 中移除 Adobe Search&amp;Promote 的代码和依赖项，该功能已于 [2022 年 9 月终止服务（参见通知 ](https://experienceleague.adobe.com/zh-hans/docs/discontinued/using/search-promote)）。（NPR-41855）

#### 本地化{#foundation-localization-6521}

* 在模板编辑器中，文本字符串 *`No video available.`* 未经过本地化。（SITES-13190）
* 在&#x200B;**工具** > **安全** > **用户** > *any_user_name* > **激活** > **确定**，以及选择 *any_user_name* > **停用** > **确定**&#x200B;的流程中，激活或停用用户后的字符串未经过本地化。（NPR-41737）

#### Oak {#foundation-oak-6521}

* 性能回退修复 —— 避免在 like 条件中使用范围查询。（OAK-9481）
* 新的 Oak 版本是 1.22.20。

#### 平台{#foundation-platform-6521}

* 在 `com.day.cq.mailer.impl.DefaultMailService` 中出现 `Unclosed resource resolver` 错误。开箱即用的 `MessageGatewayService` 类在使用时没有关联资源解析器。在任何包含使用该类发送电子邮件的表单提交按钮的页面上，都会出现该问题。（NPR-41853）
* 在&#x200B;**关于 Adobe Experience Manager**&#x200B;对话框中，版权年份仍显示为 2023 年。（CQ-4356349）


<!-- #### Sling{#foundation-sling-6521}

* T -->

#### 翻译{#foundation-translation-6521}

* AEM 6.5.19 开箱即用的翻译状态在发布项中未按预期更新的问题。在将翻译后的文件导入与 AEM 发布项关联的翻译作业后，状态本应显示为 `Approved`。然而，状态却变成了 `Ready for Review`，这并非预期的行为。（NPR-41756）
* 在创建多个配置并进入翻译云服务配置时，UI 中并未显示所有元素。每个文件夹仅显示前 40 个元素；虽然触发了延迟加载，但未加载更多内容。（NPR-41829）
* 如果 Touch 用户界面的“权限”页面中包含日文，则会出现乱码问题。（NPR-41794）
* AEM 6.5.14 和 6.5.9 不会发送表情符号以进行翻译。（CQ-4357000）

#### 用户界面{#foundation-ui-6521}

* 在“工具” > “安全性” > “用户” > “&lt;user_name>” > “轮廓”的&#x200B;**编辑用户设置**&#x200B;对话框中，单击“取消”无法退出对话框。（NPR-41793）
* Granite `pathfield` 组件（路径：`/libs/granite/ui/components/coral/foundation/form/pathfield`）在选择资产时无法启用&#x200B;**[!UICONTROL 选择]**&#x200B;按钮。当路径字段弹出后，用户选择资产复选框时，**[!UICONTROL 选择]**&#x200B;按钮不会被启用，仍然保持灰色，而不会变为蓝色。（NPR-41970）
* AEM 中的内容片段模型（CFM）引用字段存在问题。即使该内容片段模型引用字段被设置为必填项，在某些情况下系统仍允许用户点击“保存”，并将包含非内容片段模型值的内容保存下来。此时“保存”按钮本应处于灰显状态（不可用）。（NPR-41894）
* 使用 `successresponse` 操作的标准 Coral 用户界面对话框在执行操作后，必须触发成功响应（Success Response）。但在 AEM 6.5 服务包 19 中，未调用重新加载操作，也未显示任何消息。（NPR-41797）
* AEM 通知链接在 AEM 6.5 服务包 18 中无法正常工作。升级到服务包 18 后，通过通知按钮选择消息时，AEM 通知链接无法打开。（NPR-41792）

<!-- #### WCM{#foundation-wcm-6521}

* T -->

#### 工作流{#foundation-workflow-6521}

* 在 AEM 6.5.18 中，清理过程中从用户元数据缓存中移除条目时会反复报错。（NPR-41762）

## 安装 [!DNL Experience Manager] 6.5.21.0{#install}

<!-- Remaining content from here to bottom stays the same except for version updating as needed as per update team feedback. -->

* [!DNL Experience Manager] 6.5.21.0 需要依赖 [!DNL Experience Manager] 6.5。详细说明请参阅[升级文档](/help/sites-deploying/upgrade.md)。<!-- UPDATE FOR EACH NEW RELEASE -->
* 服务包可通过 Adobe [软件分发](https://experience.adobe.com/#/downloads/content/software-distribution/en/aem.html?package=/content/software-distribution/en/details.html/content/dam/aem/public/adobe/packages/cq650/servicepack/aem-service-pkg-6.5.21.0.zip)下载。
* 在使用 MongoDB 且包含多个实例的部署中，请在其中一个作者实例上使用包管理器安装 [!DNL Experience Manager] 6.5.21.0。<!-- UPDATE FOR EACH NEW RELEASE -->

>[!IMPORTANT]
>
> Adobe 不建议移除或卸载 [!DNL Experience Manager] 6.5.21.0 包。因此，在安装该包之前，您应创建 `crx-repository` 的备份，以便在需要时进行回滚。<!-- UPDATE FOR EACH NEW RELEASE -->
<!-- For instructions to install Service Pack for Experience Manager Forms, see [Experience Manager Forms Service Pack installation instructions](/help/release-notes/aem-forms-current-service-pack-installation-instructions.md). -->


### 在 [!DNL Experience Manager] 6.5 上安装服务包{#install-service-pack}

1. 如果实例处于更新模式（即由早期版本升级而来），请在安装前先重启该实例。如果实例已长时间运行，Adobe 建议先重启。

1. 在安装之前，请为您的 [!DNL Experience Manager] 实例创建快照或执行一次全新的备份。

1. 从[软件分发](https://experience.adobe.com/#/downloads/content/software-distribution/en/aem.html?package=/content/software-distribution/en/details.html/content/dam/aem/public/adobe/packages/cq650/servicepack/aem-service-pkg-6.5.21.0.zip)下载服务包。<!-- UPDATE FOR EACH NEW RELEASE -->

1. 打开包管理器，然后选择&#x200B;**[!UICONTROL 上传包]**&#x200B;以上传该包。如需了解更多信息，请参阅[包管理器](/help/sites-administering/package-manager.md)。

1. 选择该包，然后选择&#x200B;**[!UICONTROL 安装]**。

1. 要更新 S3 连接器，请在安装服务包后停止实例，用安装文件夹中提供的新二进制文件替换现有连接器，然后重新启动实例。请参阅 [Amazon S3 数据存储](/help/sites-deploying/data-store-config.md#upgrading-to-a-new-version-of-the-s-connector)。

>[!NOTE]
>
>在安装服务包过程中，包管理器 UI 中的对话框有时会意外退出。Adobe 建议您在访问部署之前，先等待错误日志趋于稳定。在确认安装成功之前，请先等待与卸载更新捆绑包相关的特定日志出现。通常，该问题会在 [!DNL Safari] 浏览器中出现，但也可能会在其他浏览器中间歇出现。

**自动安装**

您可以使用以下两种方法来安装 [!DNL Experience Manager] 6.5.21.0。<!-- UPDATE FOR EACH NEW RELEASE -->

* 当服务器在线时，将包放入 `../crx-quickstart/install` 文件夹中。该包会自动安装。
* 使用[包管理器的 HTTP API](/help/sites-administering/package-manager.md#package-share)。请使用 `cmd=install&recursive=true` 以便安装嵌套的包。

>[!NOTE]
>
>Experience Manager 6.5.21.0 不支持 Bootstrap 安装。<!-- UPDATE FOR EACH NEW RELEASE -->

**验证安装**

要了解与此版本兼容的已经过认证的平台，请参阅[技术要求](/help/sites-deploying/technical-requirements.md)。

1. 在[!UICONTROL 已安装的产品]下，产品信息页面（`/system/console/productinfo`）会显示更新后的版本字符串 `Adobe Experience Manager (6.5.21.0)`。<!-- UPDATE FOR EACH NEW RELEASE -->

1. 在 OSGi 控制台中，所有 OSGi 捆绑包均应处于&#x200B;**[!UICONTROL 活跃]**&#x200B;或&#x200B;**[!UICONTROL 片段]**&#x200B;状态（使用网页控制台：`/system/console/bundles`）。

1. OSGi 捆绑包 `org.apache.jackrabbit.oak-core` 的版本应为 1.22.20 或更高版本（使用网页控制台：`/system/console/bundles`）。<!-- OAK Oak oak VERSION -MAY- NEED TO BE UPDATED FOR EACH NEW RELEASE -->

### 安装 [!DNL Experience Manager] Forms 的服务包{#install-aem-forms-add-on-package}

如需了解在 Experience Manager Forms 上安装服务包的操作说明，请参阅 [Experience Manager Forms 服务包安装说明](/help/release-notes/aem-forms-current-service-pack-installation-instructions.md)。

>[!NOTE]
>
>在 [AEM 6.5 快速入门](https://experienceleague.adobe.com/zh-hans/docs/experience-manager-65/content/implementing/deploying/deploying/deploy)中谈及的自适应表单功能旨在仅作探索和评估用途。由于自适应表单功能需要适当的许可，因此必须获得 AEM Forms 的有效许可证才能作生产用途。

### 为 Experience Manager 内容片段安装 GraphQL 索引包{#install-aem-graphql-index-add-on-package}

使用 GraphQL 的客户必须安装[带有 GraphQL 索引包 1.1.1 的 Experience Manager 内容片段](https://experience.adobe.com/#/downloads/content/software-distribution/en/aem.html?package=/content/software-distribution/en/details.html/content/dam/aem/public/adobe/packages/cq650/featurepack/cfm-graphql-index-def-1.1.1.zip)。

这样做可根据实际使用的功能添加所需的索引定义。

如果未安装该包，可能会导致 GraphQL 查询变慢或失败。

>[!NOTE]
>
>每个实例只需安装一次该包；无需在每次安装服务包时重新安装。

### UberJar{#uber-jar}

适用于 [!DNL Experience Manager] 6.5.21.0 的 UberJar 可在 [Maven Central 存储库](https://repo.maven.apache.org/maven2/com/adobe/aem/uber-jar/6.5.21/)获取。<!-- CHECK FOR UPDATE EACH NEW RELEASE -->

要在 Maven 项目中使用 UberJar，请参阅[如何使用 UberJar](/help/sites-developing/ht-projects-maven.md)，并在项目 POM 中包含以下依赖项：<!-- CHECK FOR UPDATE EACH NEW RELEASE -->

```shell
  <dependency>
  <groupId>com.adobe.aem</groupId>
  <artifactId>uber-jar</artifactId>
  <version>6.5.21</version>
  <scope>provided</scope>          
  </dependency>
```

>[!NOTE]
>
>UberJar 和其他相关工件现已发布在 Maven Central 存储库，而非 Adobe 公共 Maven 存储库（`repo.adobe.com`）。主 UberJar 文件已重命名为 `uber-jar-<version>.jar`。因此，在 `dependency` 标记中不再包含以 `apis` 为值的 `classifier`。


## 已弃用和已移除的功能{#removed-deprecated-features}

请参阅[已弃用和已移除的功能](/help/release-notes/deprecated-removed-features.md)。

## 已知问题{#known-issues}

<!-- THESE KNOWN ISSUES CARRY OVER EACH RELEASE. THE "PRODUCT UPDATES TEAM" IS SUPPOSED TO VERIFY EACH ISSUE AND LET YOU KNOW IF ANYTHING NEEDS TO BE ADDED, DELETED, OR CHANGED IN THIS LIST.-->

<!-- * **Page publishing not working in Page Editor after upgrading to Service Pack 18 (6.5.18.0)** -->

<!-- https://jira.corp.adobe.com/browse/SITES-15856 REMOVE FOR 6.5.19.0 -->
<!-- After you upgrade an instance of AEM 6.5.0.0&mdash;6.5.17.0 to AEM 6.5.19.0, when you click **Publish Page** inside the Page Editor, you are redirected to a URL that does not exist.

  To work around this issue, do one of the following:

  * Remove the following "path" property.

       `/libs/wcm/core/content/editor/jcr:content/content/items/content/header/items/headerbar/items/pageinfopopover/items/list/items/publish/granite:data`

  * Paste the correct URL directly into the browser.

       `http://localhost:4504/editor.html/libs/wcm/core/content/sites/publishpagewizard.html?item=/content/we-retail/language-masters/en/about-us.html` -->


* **AEM 6.5.21-6.5.23 和 AEM 6.5 LTS GA 中的 JSP 脚本包问题**
AEM 6.5.21、6.5.22、6.5.23 和 AEM 6.5 LTS GA 随附的 `org.apache.sling.scripting.jsp:2.6.0` 捆绑包存在已知问题。此问题经常在 AEM 实例处理许多并发请求而导致高负载的情况下发生。

  当出现此问题时，错误日志中可能会出现以下异常之一，并会引用 `org.apache.sling.scripting.jsp:2.6.0`：

   * `java.io.IOException: classFile.delete() failed`
   * `java.io.IOException: tmpFile.renameTo(classFile) failed`
   * `java.lang.ArrayIndexOutOfBoundsException: Index 0 out of bounds for length 0`
   * `java.io.FileNotFoundException`

  出现该错误后，唯一的恢复方法是重启 AEM 实例。

  请联系 Adobe 客户支持，并引用本发行说明以获取解决方案。

* **与 Oak 相关**
自服务包 13 起及更高版本中，开始出现以下错误日志，从而影响持久化缓存：

  ```shell
  org.h2.mvstore.MVStoreException: The write format 1 is smaller than the supported format 2 [2.0.202/5]
  at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:1004)
      at org.h2.mvstore.MVStore.getUnsupportedWriteFormatException(MVStore.java:1059)
      at org.h2.mvstore.MVStore.readStoreHeader(MVStore.java:878)
      at org.h2.mvstore.MVStore.<init>(MVStore.java:455)
      at org.h2.mvstore.MVStore$Builder.open(MVStore.java:4052)
      at org.h2.mvstore.db.Store.<init>(Store.java:129)
  ```

  或者

  ```shell
  org.h2.mvstore.MVStoreException: The write format 1 is smaller than the supported format 2 [2.1.214/5].
  ```

  要解决此异常，请执行以下操作：

   1. 从 `crx-quickstart/repository/` 中删除以下两个文件夹

      * `cache`
      * `diff-cache`

   1. 安装服务包，或重新启动 Experience Manager as a Cloud Service。
新的 `cache` 和 `diff-cache` 文件夹会自动创建，并且不会再在 `error.log` 中遇到与 `mvstore` 相关的异常。

* 请将可能使用了自定义 API 名称的 GraphQL 查询更新为使用内容模型的默认名称。

* GraphQL 查询可能会使用 `damAssetLucene` 索引，而不是 `fragments` 索引。此操作可能导致 GraphQL 查询失败或运行时间过长。

  要解决该问题，必须在 `/indexRules/dam:Asset/properties` 下配置 `damAssetLucene`，以添加以下两个属性：

   * `contentFragment`
      * `jcr:primaryType="nt:unstructured"`
      * `name="jcr:content/contentFragment"`
      * `propertyIndex="{Boolean}true"`
      * `type="Boolean"`
   * `model`
      * `jcr:primaryType="nt:unstructured"`
      * `name="jcr:content/data/cq:model"`
      * `ordered="{Boolean}true"`
      * `propertyIndex="{Boolean}true"`
      * `type="String"`

  在修改索引定义后，需要重新索引（`reindex` = `true`）。

  完成以上步骤后，GraphQL 查询的性能应会提升。

* 在尝试移动、删除或发布内容片段、网站或页面时，获取内容片段引用时会出现问题。后台查询失败。也就是说，该功能无法正常工作。
为确保该功能正常运行，必须将以下属性添加到索引定义节点 `/oak:index/damAssetLucene`（无需重新索引）：

  ```xml
  "tags": [
      "visualSimilaritySearch"
    ]
  "refresh": true
  ```

* 如果您在 Java™ 11 上将 [!DNL Experience Manager] 实例从 6.5.0 – 6.5.4 升级到最新的服务包，可能会在 `error.log` 文件中看到 `RRD4JReporter` 异常。要停止这些异常，请重新启动 [!DNL Experience Manager] 实例。<!-- THIS BULLET POINT WAS UPDATED AS PER CQDOC-20021, JANUARY 23, 2023 -->

* 用户可以在 [!DNL Assets] 的层级中重命名文件夹，并将嵌套文件夹发布到 [!DNL Brand Portal]。但是，在 [!DNL Brand Portal] 中，文件夹标题不会更新，直到重新发布根文件夹。

* 在安装 [!DNL Experience Manager] 6.5.x.x 期间，可能会显示以下错误和警告消息：
   * 当在 [!DNL Experience Manager] 中使用 Target Standard API（IMS 身份验证）配置 Adobe Target 集成时，将体验片段导出到 Target 会导致创建错误的产品建议类型。在 Target 中，系统不会创建类型为“Experience Fragment”/来源为“Adobe Experience Manager”的产品建议，而是会创建多个类型为“HTML”/来源为“Adobe Target Classic”的产品建议。
   * `com.adobe.granite.maintenance.impl.TaskScheduler`：未在 `granite/operations/maintenance` 找到维护窗口。
   * 当在自适应表单中使用 SUM、MAX 和 MIN 等聚合函数时，服务器端验证失败（CQ-4274424）。
   * `com.adobe.granite.maintenance.impl.TaskScheduler`：未在 `granite/operations/maintenance` 找到维护窗口。
   * 通过 Shoppable Banner 查看器预览资产时，Dynamic Media 交互式图像中的热点不可见。
   * `com.adobe.cq.social.cq-social-jcr-provider bundle com.adobe.cq.social.cq-social-jcr-provider:1.3.5 (395)[com.adobe.cq.social.provider.jcr.impl.SpiSocialJcrResourceProviderImpl(2302)]`：等待完成取消注册的注册变更时超时。

* 从 AEM 6.5.15 开始，由 ```org.apache.servicemix.bundles.rhino``` 捆绑包提供的 Rhino JavaScript 引擎引入了新的提升行为。使用严格模式（```use strict;```）的脚本必须声明正确的变量。否则脚本将无法运行，并会抛出运行时错误。

* 通过官方更新包安装与标记相关的开箱即用内容时，`/content/cq:tags` 节点的语言属性会被重置为默认值。此操作适用于服务包、安全服务包、扩展功能包、累积功能包、补丁等。因此，在安装之前必须从属性中手动添加该项。

### AEM Sites 已知问题 {#known-issues-aem-sites-6521}

* SITES-17934 - 内容片段：由于对大型树状片段启用 DoS 防护，预览失败。请参阅[关于默认 GraphQL 查询执行器配置选项的知识库文章](https://experienceleague.adobe.com/zh-hans/docs/experience-cloud-kcs/kbarticles/ka-23945)

<!--

### Known issues for AEM Forms {#known-issues-aem-forms-6521}
-->

### AEM Forms 已知问题 {#known-issues-aem-forms-6521}


* 在安装 AEM Forms JEE 服务包 21（6.5.21.0）后，如果您在 `<AEM_Forms_Installation>/lib/caching/lib` 文件夹下发现 Geode jar 的重复条目 `(geode-*-1.15.1.jar and geode-*-1.15.1.2.jar)`（FORMS-14926），请执行以下步骤以解决该问题：

   1. 如果定位器正在运行，请先停止定位器。
   1. 停止 AEM 服务器。
   1. 进入 `<AEM_Forms_Installation>/lib/caching/lib`。
   1. 移除所有 Geode 补丁文件，仅保留 `geode-*-1.15.1.2.jar`。确认仅存在 `version 1.15.1.2` 的 Geode jar。
   1. 以管理员模式打开命令提示符。
   1. 使用 `geode-*-1.15.1.2.jar` 文件安装 Geode 补丁。

* 如果用户尝试使用已保存的 XML 数据预览草稿信件，某些特定信件会卡在 `Loading` 状态。要下载并安装热修复补丁，请参阅 [Adobe Experience Manager Forms 热修复补丁](/help/release-notes/aem-forms-hotfix.md#hotfix-for-adaptive-forms)文章。（FORMS-14521）

* 在升级到 AEM Forms 服务包 6.5.21.0 后，`PaperCapture` 服务无法对 PDF 执行 OCR（光学字符识别）操作。该服务不会生成 PDF 输出文件或日志文件。要下载并安装热修复补丁，请参阅 [Adobe Experience Manager Forms 热修复补丁](/help/release-notes/aem-forms-hotfix.md#hotfix-for-adaptive-forms)文章。（CQDOC-21680）

* 当用户从 AEM 6.5 Forms 服务包 18（6.5.18.0）或 AEM 6.5 Forms 服务包 19（6.5.19.0）升级到 AEM 6.5 Forms 服务包 20（6.5.20.0）或 AEM 6.5 Forms 服务包 21（6.5.21.0）时，会遇到 JSP 编译错误。该错误会阻止用户打开或创建自适应表单，并导致其他 AEM 界面（如页面编辑器、AEM Forms UI、AEM 工作流编辑器和 AEM 系统概览 UI）出现错误。（FORMS-15256）

  如果遇到此类问题，请执行以下步骤进行解决：
   1. 进入 CRXDE 中的目录 `/libs/fd/aemforms/install/`。
   1. 删除名为 `com.adobe.granite.ui.commons-5.10.26.jar` 的捆绑包。
   1. 重新启动 AEM 服务器。

* 当用户更新至安装了 Forms 附加组件的 AEM Forms 服务包 20（6.5.20.0）时，使用基于用户凭据身份验证的 Adobe Analytics 旧版云服务的配置将无法正常工作，导致分析规则执行失败。要下载并安装热修复补丁，请参阅 [Adobe Experience Manager Forms 热修复补丁](/help/release-notes/aem-forms-hotfix.md#hotfix-for-adaptive-forms)文章。（FORMS-15428）

* 当用户在 JEE 服务器上更新至 AEM Forms 服务包 20（6.5.20.0），并使用输出服务生成 PDF 时，生成的 PDF 会出现可访问性问题。要下载并安装热修复补丁，请参阅 [Adobe Experience Manager Forms 热修复补丁](/help/release-notes/aem-forms-hotfix.md#hotfix-for-adaptive-forms)文章。（LC-3922112）
* 当用户在 JEE 上使用输出服务生成带标记的 PDF 时，会显示“结构不当警告”。要下载并安装热修复补丁，请参阅 [Adobe Experience Manager Forms 热修复补丁](/help/release-notes/aem-forms-hotfix.md#hotfix-for-adaptive-forms)文章。（LC-3922038）
* 当在 AEM Forms JEE 上提交表单时，数据中的重复 XML 元素实例会被移除。要下载并安装热修复补丁，请参阅 [Adobe Experience Manager Forms 热修复补丁](/help/release-notes/aem-forms-hotfix.md#hotfix-for-adaptive-forms)文章。（LC-3922017）
* 当用户在 Linux® 环境中以 HTML 形式渲染自适应表单（运行于 JEE）时，表单无法正常渲染。要下载并安装热修复补丁，请参阅 [Adobe Experience Manager Forms 热修复补丁](/help/release-notes/aem-forms-hotfix.md#hotfix-for-adaptive-forms)文章。（LC-3921957）
* 当用户在 AEM Forms JEE 上使用输出服务将 XTG 文件转化为 PostScript 格式时，转化失败并出现以下错误：`AEM_OUT_001_003: Unexpected Exception: PAExecute Failure: XFA_RENDER_FAILURE`。要下载并安装热修复补丁，请参阅 [Adobe Experience Manager Forms 热修复补丁](/help/release-notes/aem-forms-hotfix.md#hotfix-for-adaptive-forms)文章。（LC-3921720）
* 在 JEE 服务器上升级到 AEM Forms 服务包 18（6.5.18.0）后，当用户提交表单时，无法渲染 HTML5 或 PDF Forms，并且 XMLFM 会崩溃。要下载并安装热修复补丁，请参阅 [Adobe Experience Manager Forms 热修复补丁](/help/release-notes/aem-forms-hotfix.md#hotfix-for-adaptive-forms)文章。（LC-3921718）
* 在交互式通信代理 UI 的打印预览中，货币符号（如美元符号 $）在各字段值中的显示不一致。对于不超过 999 的数值会显示符号，但对于 1000 及以上的数值则缺少符号。（FORMS-16557）
* 在交互式通信中，对嵌套布局片段的 XDP 所做的任何修改都不会反映在 IC 编辑器中。（FORMS-16575）
* 在交互式通信代理 UI 的打印预览中，部分计算值未正确显示。（FORMS-16603）
* 在打印预览中查看信件时，内容会发生变化。部分空格会消失，某些字母会被替换为 “x”。（FORMS-15681）

## 包含的 OSGi 捆绑包和内容包{#osgi-bundles-and-content-packages-included}

以下文本文档列出了此 [!DNL Experience Manager] 6.5 服务包版本中包含的 OSGi 捆绑包和内容包：

* [Experience Manager 6.5.21.0](/help/release-notes/assets/65210-bundles.txt) 中包含的 OSGi 捆绑包列表 <!-- UPDATE FOR EACH NEW RELEASE -->
* [Experience Manager 6.5.21.0](/help/release-notes/assets/65210-packages.txt) 中包含的内容包列表 <!-- UPDATE FOR EACH NEW RELEASE -->

## 受限网站{#restricted-sites}

这些网站仅向客户开放。如果您已是客户并需要访问权限，请联系您的 Adobe 客户经理。

* [在 licensing.adobe.com 下载产品](https://licensing.adobe.com/)
* [联系 Adobe 客户支持部门](https://experienceleague.adobe.com/zh-hans/docs/customer-one/using/home)。

>[!MORELIKETHIS]
>
>* [[!DNL Experience Manager] 产品页面](https://business.adobe.com/products/experience-manager/adobe-experience-manager.html)
>* [[!DNL Experience Manager] 6.5 文档](https://experienceleague.adobe.com/zh-hans/docs/experience-manager-65)
>* [订阅 Adobe 产品更新早知道](https://www.adobe.com/cn/subscription/priority-product-update.html)
